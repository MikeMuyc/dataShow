(function(e){function t(t){for(var r,i,s=t[0],l=t[1],c=t[2],u=0,h=[];u<s.length;u++)i=s[u],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&h.push(o[i][0]),o[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);d&&d(t);while(h.length)h.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==o[s]&&(r=!1)}r&&(a.splice(t--,1),e=l(l.s=n[0]))}return e}var r={},i={app:0},o={app:0},a=[];function s(e){return l.p+"js/"+({echarts:"echarts"}[e]||e)+"."+{"chunk-734bdb52":"87771e5d","chunk-427cbb9e":"a940fdc8","chunk-9b9461b2":"aa6c26ff","chunk-673d1dfb":"d13f785b","chunk-2d0b924f":"cb6098e3","chunk-0517fa9b":"dea483e4","chunk-3aa72fdf":"295af18e","chunk-10a64a58":"9ada0307","chunk-2de0a28a":"f6af67ea","chunk-3378d534":"ea1ade01","chunk-e4c2d952":"9b08c2e4","chunk-8d391c9c":"0231e6a9","chunk-001f3007":"e0e16233","chunk-63fe99a2":"79efb1b4","chunk-720fe7aa":"71f87bd3","chunk-c7634e9e":"6ab92a24","chunk-350c38c2":"a3e68575","chunk-d503db16":"feac7340","chunk-f9309eb2":"87c9f396","chunk-60dbb3da":"91d97d1d",echarts:"9a474437"}[e]+".js"}function l(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.e=function(e){var t=[],n={"chunk-427cbb9e":1,"chunk-673d1dfb":1,"chunk-0517fa9b":1,"chunk-3aa72fdf":1,"chunk-10a64a58":1,"chunk-2de0a28a":1,"chunk-3378d534":1,"chunk-e4c2d952":1,"chunk-8d391c9c":1,"chunk-001f3007":1,"chunk-63fe99a2":1,"chunk-c7634e9e":1,"chunk-350c38c2":1,"chunk-d503db16":1,"chunk-f9309eb2":1,"chunk-60dbb3da":1};i[e]?t.push(i[e]):0!==i[e]&&n[e]&&t.push(i[e]=new Promise((function(t,n){for(var r="css/"+({echarts:"echarts"}[e]||e)+"."+{"chunk-734bdb52":"31d6cfe0","chunk-427cbb9e":"bb142968","chunk-9b9461b2":"31d6cfe0","chunk-673d1dfb":"beafcc99","chunk-2d0b924f":"31d6cfe0","chunk-0517fa9b":"8a371259","chunk-3aa72fdf":"66270fe5","chunk-10a64a58":"8073c1d3","chunk-2de0a28a":"7d299f5d","chunk-3378d534":"d9cb75ac","chunk-e4c2d952":"d073ab71","chunk-8d391c9c":"ba9ae76f","chunk-001f3007":"5f3a27d1","chunk-63fe99a2":"faade404","chunk-720fe7aa":"31d6cfe0","chunk-c7634e9e":"d29f992f","chunk-350c38c2":"bb16172f","chunk-d503db16":"af419d73","chunk-f9309eb2":"89e2869a","chunk-60dbb3da":"5b70b2c6",echarts:"31d6cfe0"}[e]+".css",o=l.p+r,a=document.getElementsByTagName("link"),s=0;s<a.length;s++){var c=a[s],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===r||u===o))return t()}var h=document.getElementsByTagName("style");for(s=0;s<h.length;s++){c=h[s],u=c.getAttribute("data-href");if(u===r||u===o)return t()}var d=document.createElement("link");d.rel="stylesheet",d.type="text/css",d.onload=t,d.onerror=function(t){var r=t&&t.target&&t.target.src||o,a=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=r,delete i[e],d.parentNode.removeChild(d),n(a)},d.href=o;var f=document.getElementsByTagName("head")[0];f.appendChild(d)})).then((function(){i[e]=0})));var r=o[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise((function(t,n){r=o[e]=[t,n]}));t.push(r[2]=a);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=s(e);var h=new Error;c=function(t){u.onerror=u.onload=null,clearTimeout(d);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;h.message="Loading chunk "+e+" failed.\n("+r+": "+i+")",h.name="ChunkLoadError",h.type=r,h.request=i,n[1](h)}o[e]=void 0}};var d=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},l.m=e,l.c=r,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)l.d(n,r,function(t){return e[t]}.bind(null,r));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var h=0;h<c.length;h++)t(c[h]);var d=u;a.push([0,"dll","chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"11d1":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAA7ElEQVQ4T2NkoDJgpLJ5DKMGQkL0voCAwE9ejvVM//4Wqj19fQE5nG9Jixr8Y2LuZ//8I1Dxw4cP6HGANQxvyEocYGRksGdg+P+B8e8/R5ihIMP+MzPtZ2BgFPj/n+GgxuMXDkQZCNV4gIGBkR9mKEgjzDAGhv8fGf/+c0B3PUgNzlhGNxTiEkYBfIbhNRAkiWoo2I04XQbzOt50iBxmEA2oYYotUxDyMjgCQC6DehkeptjCD6eXUV0G8SY0UlAiiuhIQUo2KGGGHKYkJRtowt7A9O9vAY6EPYH9848AohM2JSXQaGlDSehB9AIATs+OFVtUYhIAAAAASUVORK5CYII="},4736:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAtUlEQVQoU8XRMWoCURDG8d/0VqlNLiCk0S4E7IRU23sJK8HOxsYreIEE0gXSWKVOBPEM1iJiY/VkZReWZTet07z5Zt6f+d68UIvEAJ1K+SdIpY48SeTnC7oYY1Nc6OMDe/wF5xJ4Qw+/9YmFfsU2+CqBR7xj3QIMkQXHG1DYWgbTxBNOFc/HxK2X15qAJb4LYB4M7w8sKo+fBNm/lpq21Aas8IlLAzQKZvUtPeC55R92wSHvXQGCCj8NTxyoAAAAAABJRU5ErkJggg=="},"482f":function(e,t,n){},5670:function(e,t,n){},"65df":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"echarts"})},i=[],o=(n("96cf"),n("3b8d")),a=(n("7f7f"),n("b047")),s=n.n(a),l=n("406e"),c=["legendselectchanged","legendselected","legendunselected","legendunscroll","datazoom","datarangeselected","timelinechanged","timelineplaychanged","restore","dataviewchanged","magictypechanged","geoselectchanged","geoselected","geounselected","pieselectchanged","pieselected","pieunselected","mapselectchanged","mapselected","mapunselected","axisareaselected","focusnodeadjacency","unfocusnodeadjacency","brush","brushselected","rendered","finished","click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"],u={props:{options:Object,theme:[String,Object],initOptions:Object,group:String,autoResize:Boolean,watchShallow:Boolean,manualUpdate:Boolean},data:function(){return{lastArea:0}},watch:{group:function(e){this.chart.group=e}},methods:{mergeOptions:function(e,t,n){this.manualUpdate&&(this.manualOptions=e),this.chart?this.delegateMethod("setOption",e,t,n):this.init()},appendData:function(e){this.delegateMethod("appendData",e)},resize:function(e){this.delegateMethod("resize",e)},dispatchAction:function(e){this.delegateMethod("dispatchAction",e)},convertToPixel:function(e,t){return this.delegateMethod("convertToPixel",e,t)},convertFromPixel:function(e,t){return this.delegateMethod("convertFromPixel",e,t)},containPixel:function(e,t){return this.delegateMethod("containPixel",e,t)},showLoading:function(e,t){this.delegateMethod("showLoading",e,t)},hideLoading:function(){this.delegateMethod("hideLoading")},getDataURL:function(e){return this.delegateMethod("getDataURL",e)},getConnectedDataURL:function(e){return this.delegateMethod("getConnectedDataURL",e)},clear:function(){this.delegateMethod("clear")},dispose:function(){this.delegateMethod("dispose")},delegateMethod:function(e){var t;this.chart||this.init();for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.chart)[e].apply(t,r)},delegateGet:function(e,t){return this.chart||this.init(),this.chart[t]()},getArea:function(){return this.$el.offsetWidth*this.$el.offsetHeight},echarts:function(){var e=this;return new Promise((function(t,r){e.chart?t(e.chart):n.e("echarts").then(n.t.bind(null,"313e",7)).then((function(n){t(n.init(e.$el,e.theme,e.initOptions))})).catch((function(e){r(e)}))}))},init:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.chart){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.echarts();case 4:t=e.sent,this.group&&(t.group=this.group),t.setOption(this.manualOptions||this.options||{},!0),c.forEach((function(e){t.on(e,(function(t){n.$emit(e,t)}))})),this.autoResize&&(this.lastArea=this.getArea(),this.__resizeHandler=s()((function(){0===n.lastArea?(n.mergeOptions({},!0),n.resize(),n.mergeOptions(n.options||n.manualOptions||{},!0)):n.resize(),n.lastArea=n.getArea()}),100,{leading:!0}),Object(l["a"])(this.$el,this.__resizeHandler)),Object.defineProperties(this,{width:{configurable:!0,get:function(){return n.delegateGet("width","getWidth")}},height:{configurable:!0,get:function(){return n.delegateGet("height","getHeight")}},isDisposed:{configurable:!0,get:function(){return!!n.delegateGet("isDisposed","isDisposed")}},computedOptions:{configurable:!0,get:function(){return n.delegateGet("computedOptions","getOption")}}}),this.chart=t;case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),destroy:function(){this.autoResize&&Object(l["b"])(this.$el,this.__resizeHandler),this.dispose(),this.chart=null},refresh:function(){this.chart&&(this.destroy(),this.init())}},created:function(){var e=this;this.manualUpdate||this.$watch("options",(function(t,n){!e.chart&&t?e.init():e.chart.setOption(t,t!==n)}),{deep:!this.watchShallow});var t=["theme","initOptions","autoResize","manualUpdate","watchShallow"];t.forEach((function(t){e.$watch(t,(function(){e.refresh()}),{deep:!0})}))},mounted:function(){this.options&&this.init()},activated:function(){this.autoResize&&this.chart&&this.chart.resize()},beforeDestroy:function(){this.chart&&this.destroy()}},h=u,d=(n("e8d5"),n("2877")),f=Object(d["a"])(h,r,i,!1,null,null,null);t["a"]=f.exports},"83e5":function(e,t,n){},a4e1:function(module,__webpack_exports__,__webpack_require__){"use strict";var E_workspace_nextWork_node_modules_babel_runtime_corejs2_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("d225"),E_workspace_nextWork_node_modules_babel_runtime_corejs2_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("b0b4"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("7f7f"),core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_function_name__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("ac6a"),core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_web_dom_iterable__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("c5f6"),core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_number_constructor__WEBPACK_IMPORTED_MODULE_4__),E_workspace_nextWork_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("7618"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_6___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_6__),_datashow_components_ECharts_vue__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("65df"),element_ui__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("5c96"),element_ui__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(element_ui__WEBPACK_IMPORTED_MODULE_8__),utils={dateFormat:function(e,t){if(e){var n=new Date;n.setTime(e);var r=n.getFullYear(),i=n.getMonth()+1;i=i<10?"0"+i:i;var o=n.getDate();if(o=o<10?"0"+o:o,"date"===t)return r+"-"+i+"-"+o;if("time"===t){var a=n.getHours();a=a<10?"0"+a:a;var s=n.getMinutes(),l=n.getSeconds();return s=s<10?"0"+s:s,l=l<10?"0"+l:l,r+"-"+i+"-"+o+" "+a+":"+s+":"+l}return"-"}return"-"},dateToTimestamp:function(e){if(!e)return null;if(e.length>0){var t=e.substring(0,19);return t.replace(/-/g,"/"),t.replace(/./g,"/"),new Date(t).getTime()}},changeSize:function(e){var t=parseInt(e);if(t)return t>1024?t/1024>1024?t/1048576>1024?(t/1073741824).toFixed(2)+"GB":(t/1048576).toFixed(2)+"MB":(t/1024).toFixed(2)+"KB":t.toFixed(2)+"B"},getBlobUrl:function(e){var t=null;return window.URL&&(t=window.URL.createObjectURL(e)),t},deepCopy:function(e){return JSON.parse(JSON.stringify(e))},isntNull:function isntNull(data,name){if(Array.isArray(data)){for(var flag=!1,i=0;i<data.length;i++)if(!content(data[i],name[i]))break;return flag}if("object"===Object(E_workspace_nextWork_node_modules_babel_runtime_corejs2_helpers_esm_typeof__WEBPACK_IMPORTED_MODULE_5__["a"])(data)){var _flag=!0;for(var key in name)if(void 0!==eval("data.".concat(key))&&!content(eval("data.".concat(key)),name[key])){_flag=!1;break}return _flag}if("string"===typeof data)return content(data,name);function content(e,t){return""!==e&&null!==e&&void 0!==e||(Object(element_ui__WEBPACK_IMPORTED_MODULE_8__["Message"])({showClose:!0,message:"请填写".concat(t,"！"),type:"warning"}),!1)}},phoneLimit:function(e){var t=/^1(3[0-9]|4[5,7]|5[0,1,2,3,5,6,7,8,9]|6[2,5,6,7]|7[0,1,7,8]|8[0-9]|9[1,8,9])\d{8}$/;return t.test(e)},idCardLimit:function(e){var t=/^[1-9]\d{5}(18|19|([23]\d))\d{2}((0[1-9])|(10|11|12))(([0-2][1-9])|10|20|30|31)\d{3}[0-9Xx]$/;return t.test(e)},intLimit:function(e,t){return Math.floor(e)>=0&&Math.floor(e)},floatLimit:function(e,t){return Number(e)>=0&&Number(e)},getEchartData:function(e){var t=[];return e.forEach((function(e){t.push({name:e.name,value:e.count})})),t},getEchartxAxis:function(e){var t=[];return e.forEach((function(e){t.push(e.name)})),t},numberGrow:function(e,t,n){var r=1e3,i=50,o=Math.floor(n/(r/i)+1),a=setInterval((function(){e[t]<n-o?e[t]+=o:(clearInterval(a),e[t]=n)}),i)}},Map=function(){function e(t){Object(E_workspace_nextWork_node_modules_babel_runtime_corejs2_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__["a"])(this,e),t?Object.assign(this,t):Object.assign(this,utils.deepCopy(window.mapConfig))}return Object(E_workspace_nextWork_node_modules_babel_runtime_corejs2_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__["a"])(e,[{key:"setCenter",value:function(e,t){e instanceof Array&&(this.map.view.center.coord=[parseFloat(e[0]),parseFloat(e[1])]),t&&(this.map.view.center.projection=t)}},{key:"setZoom",value:function(e){e&&(this.map.view.zoom=e)}},{key:"setCenterZoom",value:function(e,t,n){this.setCenter(e,n),this.setZoom(t)}}]),e}();__webpack_exports__["a"]={install:function(e,t){e.component("v-chart",_datashow_components_ECharts_vue__WEBPACK_IMPORTED_MODULE_7__["a"]),e.prototype.$utils=utils,e.prototype.$getMapConfig=function(e){return new Map(e)},e.prototype.$imgBaseUrl=function(){return window.$imgBaseUrl},e.prototype.$baseVideoSrc=function(){return window.$baseVideoSrc},e.directive("clickoutside",{bind:function(e,t){function n(n){if(e.contains(n.target))return!1;t.expression&&t.value(n)}e._vueClickOutside_=n,document.addEventListener("click",n)},unbind:function(e){document.removeEventListener("click",e._vueClickOutside_),delete e._vueClickOutside_}})}}},af38:function(e,t,n){"use strict";var r=n("c393"),i=n.n(r);i.a},b20f:function(e,t,n){},c393:function(e,t,n){},c737:function(e,t,n){},cd49:function(e,n,r){"use strict";r.r(n);var i={};r.r(i),r.d(i,"setLoginUser",(function(){return A})),r.d(i,"removeAllRouterTab",(function(){return R}));var o={};r.r(o),r.d(o,"openTabs",(function(){return F})),r.d(o,"BToA",(function(){return D})),r.d(o,"setRouteModule",(function(){return N})),r.d(o,"closeTab",(function(){return G})),r.d(o,"clearAllTabs",(function(){return V})),r.d(o,"setTabSize",(function(){return $}));var a={};r.r(a),r.d(a,"isDefined",(function(){return Ve})),r.d(a,"isDefinedAndNotNull",(function(){return $e})),r.d(a,"isFunction",(function(){return ze})),r.d(a,"isObjectLike",(function(){return He})),r.d(a,"isEqual",(function(){return Be})),r.d(a,"deepClone",(function(){return Ue})),r.d(a,"exportMap",(function(){return We})),r.d(a,"validCoords",(function(){return Ke})),r.d(a,"dateFormat",(function(){return Ye})),r.d(a,"stringToStamp",(function(){return qe})),r.d(a,"colorRgb",(function(){return Ze})),r.d(a,"coordinateTransform",(function(){return Je})),r.d(a,"extentTransform",(function(){return Qe})),r.d(a,"getLonLatFromPixelDis",(function(){return Xe})),r.d(a,"createVectorLayer",(function(){return et})),r.d(a,"createStyle",(function(){return rt})),r.d(a,"getArcPoints",(function(){return it})),r.d(a,"calcRadius",(function(){return ot})),r.d(a,"createFeature",(function(){return at})),r.d(a,"getControlClasses",(function(){return st})),r.d(a,"detectControls",(function(){return lt})),r.d(a,"createOverlay",(function(){return ct})),r.d(a,"removeOverlay",(function(){return ut})),r.d(a,"setLabelEvent",(function(){return ht})),r.d(a,"getGeodesicDistance",(function(){return dt})),r.d(a,"normalize",(function(){return ft})),r.d(a,"convolve",(function(){return vt})),r.d(a,"throttle",(function(){return mt})),r.d(a,"debounce",(function(){return gt}));var s={};r.r(s),r.d(s,"default",(function(){return Qt})),r.d(s,"Map",(function(){return Zt})),r.d(s,"View",(function(){return Ot})),r.d(s,"install",(function(){return Jt}));var l={};r.r(l),r.d(l,"default",(function(){return un})),r.d(l,"basicLayer",(function(){return ln})),r.d(l,"install",(function(){return cn}));var c={};r.r(c),r.d(c,"default",(function(){return Sn})),r.d(c,"markerGroup",(function(){return mn})),r.d(c,"marker",(function(){return Cn})),r.d(c,"install",(function(){return En}));var u={};r.r(u),r.d(u,"default",(function(){return Dn})),r.d(u,"overlay",(function(){return Rn})),r.d(u,"install",(function(){return Fn}));var h={};r.r(h),r.d(h,"default",(function(){return qn})),r.d(h,"cluster",(function(){return Kn})),r.d(h,"install",(function(){return Yn}));var d={};r.r(d),r.d(d,"EventType",(function(){return Ir})),r.d(d,"PlotDrawEvent",(function(){return Vr})),r.d(d,"PlotEditEvent",(function(){return Br}));var f={};r.r(f),r.d(f,"Arc",(function(){return ni})),r.d(f,"Ellipse",(function(){return oi})),r.d(f,"Curve",(function(){return li})),r.d(f,"ClosedCurve",(function(){return hi})),r.d(f,"Lune",(function(){return pi})),r.d(f,"Sector",(function(){return gi})),r.d(f,"GatheringPlace",(function(){return Pi})),r.d(f,"StraightArrow",(function(){return ki})),r.d(f,"AssaultDirection",(function(){return Li})),r.d(f,"AttackArrow",(function(){return xi})),r.d(f,"FineArrow",(function(){return Ci})),r.d(f,"Circle",(function(){return Ri})),r.d(f,"DoubleArrow",(function(){return Ni})),r.d(f,"TailedAttackArrow",(function(){return $i})),r.d(f,"SquadCombat",(function(){return Bi})),r.d(f,"TailedSquadCombat",(function(){return Ki})),r.d(f,"FreehandLine",(function(){return Zi})),r.d(f,"FreehandPolygon",(function(){return Xi})),r.d(f,"Polygon",(function(){return no})),r.d(f,"Marker",(function(){return oo})),r.d(f,"Rectangle",(function(){return lo})),r.d(f,"Polyline",(function(){return ho}));var p={};r.r(p),r.d(p,"default",(function(){return Xo})),r.d(p,"point",(function(){return ar})),r.d(p,"shape",(function(){return dr})),r.d(p,"route",(function(){return br})),r.d(p,"measure",(function(){return _r})),r.d(p,"plot",(function(){return Jo})),r.d(p,"install",(function(){return Qo}));var v={};r.r(v),r.d(v,"default",(function(){return Ma})),r.d(v,"flash",(function(){return oa})),r.d(v,"twinkle",(function(){return ha})),r.d(v,"track",(function(){return ga})),r.d(v,"migrate",(function(){return ka})),r.d(v,"radar",(function(){return La})),r.d(v,"install",(function(){return Ia}));var m={};r.r(m),r.d(m,"default",(function(){return ps})),r.d(m,"Path",(function(){return Da})),r.d(m,"MulPath",(function(){return Ha})),r.d(m,"PointCollection",(function(){return Qa})),r.d(m,"HeatMap",(function(){return as})),r.d(m,"NearBy",(function(){return ds})),r.d(m,"install",(function(){return fs}));var g=r("2b1a"),y=r("6be2"),b=(r("cadf"),r("551c"),r("f751"),r("097d"),r("2b0e")),P=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-view")},w=[],O={computed:{},watch:{},methods:{}},k=O,j=r("2877"),_=Object(j["a"])(k,P,w,!1,null,null,null),C=_.exports,E=r("75fc"),S=r("8c4f"),L=[{path:"futureHome",name:"未来社区首页",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-9b9461b2"),r.e("chunk-2d0b924f"),r.e("chunk-e4c2d952"),r.e("chunk-60dbb3da")]).then(r.bind(null,"a9c9"))}},{path:"dataManage",name:"数字化管理",component:function(){return Promise.all([r.e("chunk-734bdb52"),r.e("chunk-9b9461b2"),r.e("chunk-673d1dfb")]).then(r.bind(null,"942d"))}},{path:"health",name:"健康场景",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-9b9461b2"),r.e("chunk-2d0b924f"),r.e("chunk-10a64a58"),r.e("chunk-0517fa9b"),r.e("chunk-e4c2d952"),r.e("chunk-720fe7aa"),r.e("chunk-d503db16")]).then(r.bind(null,"ba8a"))}},{path:"traffic",name:"交通场景",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-2d0b924f"),r.e("chunk-0517fa9b"),r.e("chunk-3aa72fdf")]).then(r.bind(null,"8ca8"))}},{path:"govern",name:"治理场景",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-9b9461b2"),r.e("chunk-10a64a58"),r.e("chunk-e4c2d952"),r.e("chunk-8d391c9c")]).then(r.bind(null,"12c1"))}},{path:"neighbor",name:"邻里场景",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-9b9461b2"),r.e("chunk-2d0b924f"),r.e("chunk-10a64a58"),r.e("chunk-0517fa9b"),r.e("chunk-e4c2d952"),r.e("chunk-350c38c2")]).then(r.bind(null,"6575"))}},{path:"lowCarbon",name:"低碳场景",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-9b9461b2"),r.e("chunk-2d0b924f"),r.e("chunk-10a64a58"),r.e("chunk-0517fa9b"),r.e("chunk-e4c2d952"),r.e("chunk-f9309eb2")]).then(r.bind(null,"3e21"))}},{path:"serve",name:"服务场景",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-9b9461b2"),r.e("chunk-2d0b924f"),r.e("chunk-10a64a58"),r.e("chunk-0517fa9b"),r.e("chunk-63fe99a2")]).then(r.bind(null,"6b91"))}},{path:"building",name:"建筑场景",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-9b9461b2"),r.e("chunk-2d0b924f"),r.e("chunk-10a64a58"),r.e("chunk-0517fa9b"),r.e("chunk-720fe7aa"),r.e("chunk-c7634e9e")]).then(r.bind(null,"1a5c"))}},{path:"entrepreneurship",name:"创业场景",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-2d0b924f"),r.e("chunk-10a64a58"),r.e("chunk-0517fa9b"),r.e("chunk-2de0a28a")]).then(r.bind(null,"81ca"))}},{path:"education",name:"教育场景",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-9b9461b2"),r.e("chunk-2d0b924f"),r.e("chunk-10a64a58"),r.e("chunk-001f3007")]).then(r.bind(null,"27bb"))}}];b["default"].use(S["a"]);var I=new S["a"]({routes:[{path:"",redirect:"/dataShow"},{name:"数据展示",path:"/dataShow",component:function(){return Promise.all([r.e("chunk-734bdb52"),r.e("chunk-427cbb9e")]).then(r.bind(null,"a0dd"))},redirect:"dataShow/futureHome",children:Object(E["a"])(L)},{name:"控件下载",path:"/download",component:function(){return Promise.all([r.e("dll"),r.e("chunk-734bdb52"),r.e("chunk-3378d534")]).then(r.bind(null,"565b"))}}]}),M=r("2f62"),x={routeModuleList:["security","property"],routeModule:"",tabList:[],activeTabName:"",partB:[],Asize:2,toRouteName:""},T=x;function A(e,t){e.commit("setLoginUser",t)}function R(e){e.commit("removeAllRouter")}r("ac6a");function F(e,t){var n=!1;if(e.tabList.forEach((function(e){e.routeName===t.routeName&&(n=!0)})),!n)if(e.Asize>e.tabList.length)e.tabList.push(t);else{var r=e.tabList.splice(e.tabList.length-1,1);e.tabList.push(t),e.partB.forEach((function(n,r){n.routeName===t.routeName&&e.partB.splice(r,1)})),e.partB=r.concat(e.partB)}e.activeTabName=t.routeName}function D(e,t){var n=e.partB.splice(t.index,1),r=e.tabList.splice(e.tabList.length-1,1);e.tabList=e.tabList.concat(n),e.partB=r.concat(e.partB)}function N(e,t){e.routeModule=t}function G(e,t){if(e.tabList.length>1){var n=0;if(e.tabList.forEach((function(r,i){r.routeName===t&&(e.tabList.splice(i,1),n=i)})),e.partB.length>0){var r=e.partB.splice(0,1);e.tabList=e.tabList.concat(r)}e.toRouteName=0===n?e.tabList[0].routeName:e.tabList[n-1].routeName}}function V(e){e.tabList=[],e.partB=[]}function $(e,t){e.Asize=t}var z={namespaced:!0,state:T,actions:i,mutations:o},H=z;b["default"].use(M["a"]);var B={routeTabs:H},U=new M["a"].Store({state:{userInfo:null},modules:B,mutations:{getUserInfo:function(e,t){e.userInfo=t}},actions:{}}),W=(r("7f7f"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-map",staticStyle:{height:"100%"},attrs:{id:e.options.id}},[e._t("default")],2)}),K=[],Y=r("5eee"),q=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-view",staticStyle:{display:"none !important"}},[e._v("\n    "+e._s(e.handleCenter)+"\n")])},Z=[],J=r("7618"),Q=(r("c5f6"),r("a2c7")),X=(r("6b54"),r("28a5"),r("a481"),r("3b2b"),r("6762"),r("456d"),r("3e6b")),ee=r("5831"),te=r("4cdf"),ne=r("6c77"),re=r("83a6"),ie=r("8682"),oe=r("ce2c"),ae=r("6cbf"),se=r("ab35"),le=r("35d8"),ce=r("8295"),ue=r("a567"),he=r("5bc3"),de=r("88da"),fe=r("7a09"),pe=r("47e4"),ve=r("f403"),me=r("9a44"),ge=r("f822"),ye=r("076a"),be=r("c320"),Pe=r("e50d"),we=r("a7f7"),Oe=r("9d47"),ke=r("e29f"),je=r("1e00"),_e=r("9e15"),Ce=r("020f"),Ee=r("0710"),Se=r("256f"),Le=r("790a"),Ie={},Me=function(e,t){var n=Ae(e,t);e[n].resolvedDefer=!0},xe=function(e,t){var n=Ae(e,t),r={promise:null,resolve:null};return Ve(e[n])&&!0!==e[n].resolvedDefer?r=e[n].defer:(r.promise=new Promise((function(e,t){r.resolve=e})),e[n]={defer:r,resolvedDefer:!1}),r},Te=function(e,t){var n,r=Ae(e,t);return n=Ve(e[r])&&!1!==e[r].resolvedDefer?e[r].defer:xe(e,t),n};function Ae(e,t){var n,r;if(Ve(t))n=t;else{var i=Object.keys(e).length;if(1===i)for(r in e)e.hasOwnProperty(r)&&(n=r);else 0===i?n="main":console.error("[Vue - Openlayers] - You have more than 1 map on the DOM, you must provide the map ID to the olData.getXXX call")}return n}var Re={setMap:function(e,t){var n=xe(Ie,t);n.resolve(e),Me(Ie,t)},getMap:function(e){var t=Te(Ie,e);return t.promise},resetMap:function(e){Ve(Ie[e])&&delete Ie[e]}},Fe=Re,De=r("21a6"),Ne={TWO_PI:2*Math.PI,HALF_PI:Math.PI/2,FITTING_COUNT:100,ZERO_TOLERANCE:1e-4},Ge=Ne;function Ve(e){return void 0!==e}function $e(e){return null!==e&&void 0!==e}function ze(e){return"function"===typeof e}function He(e){return null!=e&&"object"===Object(J["a"])(e)}function Be(e,t){if(e===t)return!0;if(null==e||null==t||!He(e)&&!He(t))return e!==e&&t!==t;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;var i=[],o=function(n,r){for(var o=0,a=n.length;o<a;o++){var s=n[o];if(!i.includes(s)){if(!1===t.hasOwnProperty(s))return!1;var l=r[o];if(!Be(e[s],t[l]))return!1;i.push(l)}}return!0};return!1!==o(n,r)&&o(r,n)}function Ue(e){var t=Array.isArray(e)?[]:{};if(e&&"object"===Object(J["a"])(e))for(var n in e)e.hasOwnProperty(n)&&(e[n]&&e[n]&&"object"===Object(J["a"])(e[n])?t[n]=Ue(e[n]):t[n]=e[n]);return t}function We(e){navigator.msSaveBlob?navigator.msSaveBlob(e.msToBlob(),"map.png"):e.toBlob((function(e){Object(De["saveAs"])(e,"map.png")}))}function Ke(e,t){var n=/^-?((0|[1-9]\d?|1[0-7]\d)(\.\d+)?|180(\.0+)?)?$/,r=/^-?((0|[1-8]?\d|)(\.\d+)?|90(\.0+)?)?$/,i=new RegExp(n),o=new RegExp(r);return!(!i.test(e)||!o.test(t))}function Ye(e,t){if(!e)return null;e instanceof Date||(e=new Date(e));var n={"M+":e.getMonth()+1,"d+":e.getDate(),"H+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S+":e.getMilliseconds()};for(var r in/(y+)/i.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),n)new RegExp("("+r+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[r]:("00"+n[r]).substr((""+n[r]).length)));return t}function qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:":";if(!e)return null;var r=e.split(" ");if(2!=r.length)return null;var i,o=r[0].split(t),a=parseInt(o[0]);i=0==o[1].indexOf("0")?parseInt(o[1].substring(1)):parseInt(o[1]);var s=parseInt(o[2]),l=r[1].split(n),c=parseInt(l[0]),u=parseInt(l[1]),h=parseInt(l[2]),d=new Date(a,i-1,s,c,u,h);return d.getTime()}function Ze(e){if(e instanceof Array)return e.join(",");var t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,n=e.toLowerCase();if(n&&t.test(n)){if(4===n.length){for(var r="#",i=1;i<4;i+=1)r+=n.slice(i,i+1).concat(n.slice(i,i+1));n=r}for(var o=[],a=1;a<7;a+=2)o.push(parseInt("0x"+n.slice(a,a+2)));return o.join(",")}if(n&&-1!=n.indexOf("rgb")){var s=n.split("(")[1];return s=s.slice(0,s.length-1),n=s,n}return null}function Je(e,t,n){return Object(Se["m"])(e,t,n)}function Qe(e,t,n){return Object(Se["n"])(e,t,n)}function Xe(e,t,n){Fe.getMap(e).then((function(e){var r=e.getPixelFromCoordinate(Object(Se["g"])(t)),i=[r[0]+n[0],r[1]+n[1]];return e.getCoordinateFromPixel(i)}))}function et(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=new X["a"]({source:new ee["a"],zIndex:arguments[0]||0});return t.set("name",e),t}var tt={style:ne["c"],fill:re["a"],stroke:ie["a"],circle:oe["a"],icon:ae["a"],image:se["a"],regularshape:le["a"],text:ce["a"],atlasManager:ue["a"]},nt=function(e,t){return t&&e instanceof t?e:t?new t(e):e},rt=function e(t,n){var r,i;if(n?r=t[n]:(n="style",r=t),"style"===n&&t instanceof Function)return t;if(!(r instanceof Object))return r;if("[object Object]"===Object.prototype.toString.call(r)){i={};var o=tt[n];if(o&&r instanceof o)return r;Object.keys(r).forEach((function(t,a,s){var l=tt[t];if(o&&l&&l.prototype instanceof tt[n])return console.assert(1===s.length,"Extra parameters for "+n),i=e(r,t),nt(i,l);i[t]=e(r,t),"text"!==t&&"string"!==typeof i[t]&&(i[t]=nt(i[t],tt[t]))}))}else i=r;return nt(i,tt[n])};function it(e,t,n,r){var i,o,a=[],s=r-n;s=s<0?s+2*Math.PI:s;for(var l=100,c=0;c<=l;c++){var u=n+s*(c/l);i=e[0]+t*Math.cos(u),o=e[1]+t*Math.sin(u),a.push([i,o])}return a}function ot(e,t,n){if(t){if("pixel"!=e){var r=dt(e,n,[n[0]+1,n[1]]),i=t/r;return i}return t}return 0}function at(e,t){var n;switch(e.type){case"Polygon":n=new he["a"](e.coords);break;case"MultiPolygon":n=new de["a"](e.coords);break;case"LineString":n=new fe["a"](e.coords);break;case"MultiLineString":n=new pe["a"](e.coords);break;case"Point":n=new ve["a"](e.coords);break;case"MultiPoint":n=new me["a"](e.coords);break;case"Circle":n=new ge["a"](e.coords,e.radius);break;case"Sector":var r=it(e.coords,e.radius,e.startAngle,e.endAngle);r.push(e.coords,r[0]),n=new he["a"]([r]);break;default:e.coords?n=new ve["a"](e.coords):!e.lat&&0!=e.lat||!e.lon&&0!=e.lon||(n=new ve["a"]([e.lon,e.lat]));break}Ve(e.projection)&&"pixel"!==e.projection&&(n=n.transform(e.projection,t));var i=new te["a"]({id:e.id,name:e.name,geometry:n}),o=[];if(Ve(e.style)){if(e.style instanceof Array)for(var a=e.style.length,s=0;s<a;s++)o[s]=rt(e.style[s]);else o=rt(e.style);i.setStyle(o)}return i}function st(){return{attribution:ye["a"],fullscreen:be["a"],mouseposition:Ce["a"],overviewmap:Pe["a"],rotate:we["a"],scaleline:Oe["a"],zoom:ke["a"],zoomslider:je["a"],zoomtoextent:_e["a"]}}function lt(e){var t={},n=st();return e.forEach((function(e){for(var r in n)e instanceof n[r]&&(t[r]=e)})),t}function ct(e,t,n,r){var i=new Ee["a"]({id:n,element:e,positioning:"top-left",insertFirst:!1,stopEvent:void 0==r||r});return i.setPosition(t),i}function ut(e,t,n){var r=e.getOverlays(),i=r.getLength();if(t||n)if(t)for(var o=i-1;o>=0;o--)r.item(o).getId()==t&&r.removeAt(o);else for(var a=i-1;a>=0;a--)r.item(a).get(n)&&r.removeAt(a);else r.clear()}function ht(e,t,n){var r,i=t.getView().getProjection().getCode();if(n.coord&&2==n.coord.length?r=Object(Se["m"])(n.coord,n.projection,i):n.lon&&n.lat&&(r=Object(Se["m"])([n.lon,n.lat],n.projection,i)),n.label||n.label.message){var o=document.createElement("div");o.className=n.label.classNm,o.innerHTML=n.label.message;var a=ct(o,r,n.label.id,n.label.stopEvent);return t.addOverlay(a),e&&e.set("overLay",a),a}}function dt(e,t,n){if("pixel"==e)return Math.sqrt((t[0]-n[0])*(t[0]-n[0])+(t[1]-n[1])*(t[1]-n[1]));var r=Object(Se["m"])(t,e,"EPSG:4326"),i=Object(Se["m"])(n,e,"EPSG:4326"),o=Le["b"](r,i,6378137);return o}function ft(e){for(var t={none:[1,0,0,0,1,0,0,0,1],gray:[.33,.34,.33,.33,.34,.33,.33,.34,.33],sepia:[.393,.769,.189,.349,.686,.168,.272,.534,.131],test:[.299,.587,.114,.299,.587,.114,.299,.587,.144]},n=t[e],r=n.length,i=new Array(r),o=0;o<r;++o)i[o]=n[o]/1;return i}function pt(e,t,n){for(var r=new Array(3),i=[[0,12,43,1],[129,150,173,1],[0,28,55,1]],o=[0,.72,1],a=o.length,s=0;s<a-1;++s){var l=o[s],c=i[s],u=o[s+1],h=i[s+1];e<=255*u&&(r[0]=(e/255-l)/(u-l)*(h[0]-c[0])+c[0]),t<=255*u&&(r[1]=(t/255-l)/(u-l)*(h[1]-c[1])+c[1]),n<=255*u&&(r[2]=(n/255-l)/(u-l)*(h[2]-c[2])+c[2])}return r}function vt(e,t){for(var n=e.canvas,r=n.width,i=n.height,o=Math.sqrt(t.length),a=(Math.floor(o/2),e.getImageData(0,0,r,i).data),s=e.createImageData(r,i),l=s.data,c=0;c<l.length;c+=4){var u=a[c],h=a[c+1],d=a[c+2],f=a[c+3],p="color";if(p){var v=pt(u*t[0]+h*t[1]+d*t[2],u*t[3]+h*t[4]+d*t[5],u*t[6]+h*t[7]+d*t[8]);l[c]=v[0],l[c+1]=v[1],l[c+2]=v[2]}else l[c]=u*t[0]+h*t[1]+d*t[2]+0*f+0,l[c+1]=u*t[3]+h*t[4]+d*t[5]+0*f+0,l[c+2]=u*t[6]+h*t[7]+d*t[8]+0*f+0;l[c+3]=f}e.putImageData(s,0,0)}function mt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=!0;return function(){n&&(n=!1,e.apply(this,arguments),setTimeout((function(){n=!0}),t))}}function gt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,n=null;return function(){var r=arguments,i=this;clearTimeout(n),n=setTimeout((function(){e.apply(i,r)}),t)}}var yt=r("f5dd"),bt={name:"ol-view",props:{center:{type:Object,default:function(){return{coord:[120,30],projection:"EPSG:4326"}}},constrainRotation:{type:[Boolean,Number],default:!0},enableRotation:{type:Boolean,default:!0},extent:{type:Array,validator:function(e){return 4===e.length}},maxResolution:Number,minResolution:Number,maxZoom:{type:Number,default:28},minZoom:{type:Number,default:0},projection:{type:[String,Object],default:"EPSG:3857"},resolution:Number,resolutions:Array,rotation:{type:Number,default:0},zoom:{type:Number,default:6},zoomFactor:{type:Number,default:2}},data:function(){return{$view:null}},created:function(){},watch:{center:{handler:function(e){if(this.$view&&!Be(e.coord,this.viewCenter))if("object"==Object(J["a"])(this.projection))e.animate?this.$view.animate({center:e.coord}):this.$view.setCenter(e.coord);else{var t=Je(e.coord,e.projection||"EPSG:4326",this.projection);e.animate?this.$view.animate({center:t},{zoom:this.zoom}):this.$view.setCenter(t)}},deep:!0},resolution:function(e){this.$view&&e!==this.viewResolution&&this.$view.setResolution(e)},zoom:function(e){e=Math.round(e),this.$view&&e!==this.viewZoom&&this.$view.setZoom(e)},rotation:function(e){this.$view&&e!==this.viewRotation&&this.$view.setRotation(e)},minZoom:function(e){this.$view&&e!==this.$view.getMinZoom()&&this.$view.setMinZoom(e)},maxZoom:function(e){this.$view&&e!==this.$view.getMaxZoom()&&this.$view.setMaxZoom(e)}},computed:{viewZoom:function(){return this.$view?Math.round(this.$view.getZoom()):this.zoom},viewRotation:function(){return this.$view?this.$view.getRotation():this.rotation},viewResolution:function(){return this.$view?this.$view.getResolution():this.resolution},viewCenter:function(){if(this.$view)return this.$view.getCenter()}},methods:{handleCenter:function(){return"object"==Object(J["a"])(this.projection)?this.center.coord:Je(this.center.coord,this.center.projection||"EPSG:4326",this.projection)},createView:function(){var e=this.handleCenter();return new Q["a"]({center:e,constrainRotation:this.constrainRotation,enableRotation:this.enableRotation,extent:this.extent,maxResolution:this.maxResolution,minResolution:this.minResolution,maxZoom:this.maxZoom,minZoom:this.minZoom,projection:"object"==Object(J["a"])(this.projection)?new yt["a"](this.projection):this.projection,resolution:this.resolution,resolutions:this.resolutions,rotation:this.rotation,zoom:this.zoom,zoomFactor:this.zoomFactor})},listenViewChange:function(e){var t=this;e.on("moveend",(function(){var e=t.$view.getCenter();"object"!=Object(J["a"])(t.projection)&&(e=Je(e,t.projection,t.center.projection||"EPSG:4326"));var n={coord:e};t.center.projection&&(n.projection=t.center.projection),t.$emit("update:center",n),t.$emit("update:zoom",t.$view.getZoom())})),t.$view.on("change:rotation",(function(){t.$emit("update:rotation",t.$view.getRotation())}))}}},Pt=bt,wt=Object(j["a"])(Pt,q,Z,!1,null,null,null),Ot=wt.exports,kt=r("c810"),jt=r("480c"),_t=r("4787"),Ct=r("97e6"),Et=r("2ef1"),St=r("e7df"),Lt=r("5043"),It=r("b090"),Mt=r("6792"),xt=r("f2f0"),Tt=r("d510"),At=r("78db2"),Rt=r("55bd"),Ft=r("27c7"),Dt=r("05d2"),Nt=r("a2e1"),Gt=r("1ab5"),Vt=r("715e"),$t=r("78db"),zt=r("6ed8"),Ht=r("0af5"),Bt=r("132e"),Ut={detectLayerType:function(e){if(e.type)return e.type;if(Ve(e.source))switch(e.source.type){case"ImageWMS":return"Image";case"ImageStatic":case"ImageArcGISRest":return"Image";case"GeoJSON":case"JSONP":case"TopoJSON":case"KML":case"WKT":case"EsriJSON":return"Vector";case"TileVector":return"TileVector";case"Raster":return"Image";default:return"Tile"}else console.error("[Vue - Openlayers] - layer needs valid source")},createAttribution:function(e){var t=[];return Ve(e.attribution)&&t.unshift(new ye["a"]({html:e.attribution})),t},createXYZSource:function(e){e.url||e.tileUrlFunction||console.error("[Vue - Openlayers] - XYZ Layer needs valid url or tileUrlFunction properties");var t=null;if(e.tileGrid){var n=e.tileGrid,r={tileSize:n.tileSize?n.tileSize:[256,256],minZoom:n.minZoom||0};n.extent&&(r.extent=n.extent),n.origin&&(r.origin=n.origin),n.origins&&(r.origins=n.origins),n.resolutions&&(r.resolutions=n.resolutions),n.sizes&&(r.sizes=n.sizes),n.tileSizes&&(r.tileSizes=n.tileSizes),t=new $t["a"](r)}var i={url:e.url,attributions:this.createAttribution(e),minZoom:e.minZoom,maxZoom:e.maxZoom,projection:e.projection||"EPSG:3857",tileUrlFunction:e.tileUrlFunction,tileLoadFunction:e.tileLoadFunction,crossOrigin:e.crossOrigin||null};return t&&(i.tileGrid=t),new Et["a"](i)},createImageStatic:function(e){if(e.url&&Array.isArray(e.imageExtent)&&4===e.imageExtent.length){var t=new Se["b"]({code:"xkcd-image",units:"pixels",extent:e.imageExtent});return new St["a"]({url:e.url,attributions:this.createAttribution(e),imageSize:e.imageSize,projection:e.projection||t,imageExtent:e.imageExtent,imageLoadFunction:e.imageLoadFunction})}console.error("[Vue - Openlayers] - You need a image URL to create a ImageStatic layer.")},createTileArcGISRest:function(e){var t;return e.url||console.error("[Vue - Openlayers] - TileArcGISRest Layer needs valid url"),t=e.params?new Lt["a"]({attributions:this.createAttribution(e),tileLoadFunction:e.tileLoadFunction,params:e.params,url:e.url}):new Lt["a"]({attributions:this.createAttribution(e),tileLoadFunction:e.tileLoadFunction,url:e.url}),t},createImageArcGISRest:function(e){var t;return e.url||console.error("[Vue - Openlayers] - ImageArcGISRest Layer needs valid url"),t=e.params?new It["a"]({projection:e.projection?e.projection:"EPSG:4326",ratio:1,params:e.params,url:e.url}):new It["a"]({projection:e.projection?e.projection:"EPSG:4326",ratio:1,url:e.url}),t},handleJsonFeatures:function(e,t,n){e.forEach((function(e){var r=[];if(Ve(t.style)){if(t.style instanceof Array)for(var i=t.style.length,o=0;o<i;o++)r[o]=rt(t.style[o]);else r=ze(t.style)?rt(t.style(e)):rt(t.style);e.setStyle(r)}t.moveStyle&&e.set("moveStyle",t.moveStyle),t.clickStyle&&e.set("clickStyle",t.clickStyle),e.set("featureInfo",{type:"esrijson"==n?"esriFeature":"geoFeature",data:{style:t.style,moveStyle:t.moveStyle,clickStyle:t.clickStyle}})}))},createObjJson:function(e,t,n,r){var i;i="esrijson"==r?new Dt["a"]:new Nt["a"];var o,a=new ee["a"]({strategy:Vt["b"]}),s=t;o=Ve(e[r].projection)?Object(Se["h"])(e[r].projection):t;var l=i.readFeatures(e[r].object,{featureProjection:s.getCode(),dataProjection:o.getCode()});return this.handleJsonFeatures(l,e,r),a.addFeatures(l),n&&n({oSource:a}),a},jsonp:function(e,t,n){var r=!1,i="callback_"+(new Date).getTime()+Math.round(100*Math.random()),o=-1==e.indexOf("?")?"?":"&";for(var a in t)o+=a+"="+t[a]+"&";o+="callback="+i;var s=document.createElement("script");s.src=e+o,window[i]=function(e){r=!0,n(e);for(var t=document.body.getElementsByTagName("script"),o=t.length,a=o-1;a>-1;a--)if(-1!=t[a].src.indexOf(i)){document.body.removeChild(t[a]),window[i]=void 0;try{delete window[i]}catch(s){}}},window[i+"_err"]=function(){r||console.error("跨域script请求失败或者请求超时！",s.src)},setTimeout((function(){window[i+"_err"]&&window[i+"_err"]()}),3e4),document.body.appendChild(s)},createUrlJson:function(e,t,n,r){var i,o=this;i="esrijson"==r?new Dt["a"]:new Nt["a"];var a=new ee["a"]({strategy:Vt["b"]}),s=e.url,l=function(s){var l=s;if(l.error)alert(l.error.message+"\n"+l.error.details.join("\n"));else{var c=i.readFeatures(l,{featureProjection:t});o.handleJsonFeatures(c,e,r),c.length>0&&(a.addFeatures(c),n&&n({oSource:a}))}};if(e.local){var c=new XMLHttpRequest;c.open("GET",s),c.send(),c.onerror=function(){a.clear()},c.onload=function(){l(JSON.parse(c.responseText))}}else o.jsonp(s,null,l);return a},createJson:function(e,t,n,r){if(e.url||e[r])return Ve(e.url)?this.createUrlJson(e,t,n,r):this.createObjJson(e,t,n,r);console.error("[Vue - Openlayers] - You need a "+r+" property to add a "+r+" layer.")},createGeoJSON:function(e,t,n){return this.createJson(e,t,n,"geojson")},createEsriJSON:function(e,t,n){return this.createJson(e,t,n,"esrijson")},createImageWMS:function(e){return e.url&&e.params||console.error("[Vue - Openlayers] - ImageWMS Layer needs valid server url and params properties"),new Mt["a"]({url:e.url,imageLoadFunction:e.imageLoadFunction,attributions:this.createAttribution(e),crossOrigin:"undefined"===typeof e.crossOrigin?"anonymous":e.crossOrigin,params:e.params,ratio:e.ratio})},createTileWMS:function(e){(e.url||e.urls)&&e.params||console.error("[Vue - Openlayers] - TileWMS Layer needs valid url (or urls) and params properties");var t={tileLoadFunction:e.tileLoadFunction,crossOrigin:"undefined"===typeof e.crossOrigin?"anonymous":e.crossOrigin,params:e.params,attributions:this.createAttribution(e)};return e.serverType&&(t.serverType=e.serverType),e.url&&(t.url=e.url),e.urls&&(t.urls=e.urls),new xt["a"](t)},createBdTileImage:function(e){var t=[72.004,.8293,137.8347,55.8271],n=new Se["b"]({code:"baidu",extent:Object(Ht["a"])(t,Bt["ll2bmerc"]),units:"m"});Object(Se["d"])(n),Object(Se["c"])("EPSG:4326",n,Bt["ll2bmerc"],Bt["bmerc2ll"]),Object(Se["c"])("EPSG:3857",n,Bt["smerc2bmerc"],Bt["bmerc2smerc"]);for(var r=new Array(19),i=0;i<19;++i)r[i]=Math.pow(2,18-i);var o=[0,1,2,3,4].map((function(e){return"http://online"+e+".map.bdimg.com/onlinelabel/qt=tile&x={x}&y={y}&z={z}&v=009&styles=pl&udt=20170301&scaler=1&p=1"}));return new Et["a"]({projection:"baidu",maxZoom:18,tileUrlFunction:function(t){var n=t[1],r=t[2],i=t[0],a=(n<<i)+r,s=a%o.length;return s=s<0?s+o.length:s,e.intranet?e.url+"?qt=tile&x="+n+"&y="+r+"&z="+i+"&styles=pl&udt=20170620&scaler=1&p=1":o[s].replace("{x}",n).replace("{y}",r).replace("{z}",i)},tileGrid:new $t["a"]({resolutions:r,origin:[0,0],extent:Object(Ht["a"])(t,Bt["ll2bmerc"]),tileSize:[256,256]}),crossOrigin:e.crossOrigin||null})},createWmts:function(e,t){e.url||e.urls||console.error("[Vue - Openlayers] - WMTS Layer needs valid url (or urls)");for(var n=Object(Se["h"])(e.projection||t),r=n.getExtent(),i=Object(Ht["E"])(r)/256,o=e.zoomRange||[0,19],a=o[1],s=new Array(a),l=new Array(a),c=o[0];c<a;++c)s[c]=i/Math.pow(2,c),l[c]=c;var u={tileLoadFunction:e.tileLoadFunction,projection:e.projection||t,layer:e.layer,attributions:this.createAttribution(e),matrixSet:"undefined"===e.matrixSet?t:e.matrixSet,format:"undefined"===e.format?"image/jpeg":e.format,requestEncoding:"undefined"===e.requestEncoding?"KVP":e.requestEncoding,tileGrid:new zt["b"]({origin:e.tileGrid?e.tileGrid.origin:Object(Ht["C"])(r),resolutions:e.tileGrid?e.tileGrid.resolutions:s,matrixIds:e.tileGrid?e.tileGrid.matrixIds:l}),style:"undefined"===e.style?"normal":e.style,wrapX:e.wrapX||!1};return Ve(e.url)&&(u.url=e.url),Ve(e.urls)&&(u.urls=e.urls),new Tt["a"](u)},createTileVector:function(e,t){(e.url||e.tileUrlFunction)&&e.format||console.error("[Vue - Openlayers] - TileVector Layer needs valid url and format properties");var n=null;if(e.tileGrid){var r=e.tileGrid,i={tileSize:r.tileSize?r.tileSize:[256,256],minZoom:r.minZoom||0};r.extent&&(i.extent=r.extent),r.origin&&(i.origin=r.origin),r.origins&&(i.origins=r.origins),r.resolutions&&(i.resolutions=r.resolutions),r.sizes&&(i.sizes=r.sizes),r.tileSizes&&(i.tileSizes=r.tileSizes),n=new $t["a"](i)}var o={url:e.url,projection:e.projection||t,attributions:this.createAttribution(e),tileLoadFunction:e.tileLoadFunction,tileUrlFunction:e.tileUrlFunction,format:new Ft[e.format]};return n&&(o.tileGrid=n),new At["a"](o)},createSource:function(e,t,n){var r;switch(e.type){case"ImageStatic":r=this.createImageStatic(e);break;case"XYZ":r=this.createXYZSource(e);break;case"TileArcGISRest":r=this.createTileArcGISRest(e);break;case"ImageArcGISRest":r=this.createImageArcGISRest(e);break;case"GeoJSON":r=this.createGeoJSON(e,t,n);break;case"EsriJSON":r=this.createEsriJSON(e,t,n);break;case"ImageWMS":r=this.createImageWMS(e);break;case"TileWMS":r=this.createTileWMS(e);break;case"bdTileImage":r=this.createBdTileImage(e);break;case"WMTS":r=this.createWmts(e,t);break;case"KML":var i=e.extractStyles||!1;r=new ee["a"]({url:e.url,format:new Gt["a"]({extractStyles:i})});break;case"TileVector":r=this.createTileVector(e,t);break}return r||console.warn('[Vue - Openlayers] - No source could be found for type "'+e.type+'"'),r},createLayer:function(e,t,n,r){var i,o=this.detectLayerType(e);"function"!==typeof n||r||(r=n,n=void 0);var a=this.createSource(e.source,t,r);if(a){"Vector"===o&&e.clustering&&(a=new Rt["a"]({source:a,distance:e.clusteringDistance}));var s,l={source:a};switch($e(e.opacity)&&(l.opacity=e.opacity),$e(e.visible)&&(l.visible=e.visible),$e(e.extent)&&(l.extent=e.extent),$e(e.zIndex)&&(l.zIndex=e.zIndex),$e(e.minResolution)&&(l.minResolution=e.minResolution),$e(e.maxResolution)&&(l.maxResolution=e.maxResolution),$e(e.updateWhileAnimating)&&(l.updateWhileAnimating=e.updateWhileAnimating),$e(e.updateWhileInteracting)&&(l.updateWhileInteracting=e.updateWhileInteracting),$e(e.radius)&&(l.radius=e.radius),$e(e.blur)&&(l.blur=e.blur),$e(e.declutter)&&(l.declutter=e.declutter),o){case"Image":i=new kt["a"](l);break;case"Tile":i=new jt["a"](l);break;case"Heatmap":i=new _t["a"](l);break;case"Vector":i=new X["a"](l);break;case"TileVector":i=new Ct["a"](l);break}if(Ve(n)?i.set("name",n):Ve(e.name)&&i.set("name",e.name),$e(e.style)&&(s=ze(e.style)?e.style:rt(e.style),i.setStyle&&ze(i.setStyle)&&i.setStyle(s)),Ve(e.customAttributes))for(var c in e.customAttributes)i.set(c,e.customAttributes[c]);return r&&r({oLayer:i}),i}}},Wt=new b["default"],Kt={name:"suc-map",mixins:[Ot],props:{options:{type:Object,default:function(){return{id:"default",controls:[{name:"fullscreen"},{name:"overviewmap",collapsed:!1,label:"«",collapseLabel:"»",tipLabel:"鹰眼"}]}}}},data:function(){return{mapObject:null,promise:null}},watch:{projection:{handler:function(e){this.$view&&this.$view.getProjection().getExtent()&&e.extent&&e.extent!==this.$view.getProjection().getExtent()&&(this.$view=this.createView(),this.mapObject.setView(this.$view))},deep:!0}},created:function(){var e=this;e.promise=new Promise((function(t,n){e.resolve=t}))},mounted:function(){this.init()},provide:function(){return{getMap:this.getMap}},methods:{init:function(){var e=this;e.mapObject=this.createMap(),e.$view=e.createView(),e.mapObject.setView(e.$view),e.listenViewChange(e.mapObject),e.createControls(),e.resolve(e.mapObject),Fe.setMap(e.mapObject,e.options.id),e.options.events.forEach((function(t){e.listenEvent(e.mapObject,t)})),window.onresize=function(){e.mapObject.updateSize()}},createMap:function(){var e=new Y["a"]({target:this.$el});return e},getMap:function(){return this.promise},createControls:function(){var e=this,t=e.options.controls||[],n=st(),r=[],i=e.mapObject.getControls();return i.forEach((function(t){e.mapObject.removeControl(t)})),t.forEach((function(t){if("overviewmap"==t.name){var i=[];t.layers&&(t.layers.forEach((function(t){var n=Ut.createLayer(t,e.$view.getProjection(),null);i.push(n)})),t.layers=i),t.view=e.createView()}var o=new n[t.name](t);r.push(o),e.mapObject.addControl(o)})),r},emitEvent:function(e,t,n,r){var i=this;if(r&&r[1]){var o,a=r[0],s=r[1],l=s.get("featureInfo");l&&(o=l.type),s.get("features")&&(o="clusterFeature"),"marker"===o?Wt.$emit((i.options.id||"default")+".marker."+e,{feature:s}):s.get("features")?Wt.$emit((i.options.id||"default")+".cluster."+e,{feature:s,olLayer:a}):"esriFeature"===o||"geoFeature"===o?Wt.$emit((i.options.id||"default")+".vectorLayer."+e,{feature:s,olLayer:a,coord:n,info:l.data}):a&&a.get("collectionLayer")?Wt.$emit((i.options.id||"default")+".collection."+e,{feature:s,olLayer:a}):a&&a.get("trackLayer")&&Wt.$emit((i.options.id||"default")+".track."+e,{feature:s,olLayer:a})}else Wt.$emit((i.options.id||"default")+"."+e+".blank")},listenEvent:function(e,t){var n=this;e.on(t,(function(r){var i,o=e.getView().getProjection().getCode(),a=r.coordinate;if("pixel"!==o&&"xkcd-image"!==o||(a=a.map((function(e){return parseInt(e,10)}))),"singleclick"==t?i=r.pixel:"pointermove"==t&&(i=e.getEventPixel(r.originalEvent)),Wt.$emit((n.options.id||"default")+"."+t,r),"ol-cesium"==r.originalEvent.srcElement.className)return!1;var s=e.forEachFeatureAtPixel(i,(function(e,t){return[t,e]}));if(s&&s[1]){var l=s[0],c=s[1],u=a;"pixel"!=o&&"xkcd-image"!=o&&(u=Je(a,o,"EPSG:4326")),n.$emit(t,{coord:u,projection:"pixel"===o||"xkcd-image"===o?o:"EPSG:4326",event:r,layer:l,feature:c})}else{var h=a;"pixel"!=o&&"xkcd-image"!=o&&(h=Je(a,o,"EPSG:4326")),n.$emit(t+"-blank",{coord:h,projection:"pixel"===o||"xkcd-image"===o?o:"EPSG:4326"})}n.emitEvent(t,o,a,s)}))}},beforeDestroy:function(){var e=this;Fe.resetMap(e.options.id)}},Yt=Kt,qt=Object(j["a"])(Yt,W,K,!1,null,null,null),Zt=qt.exports;function Jt(e){Jt.installed||(Jt.installed=!0,e.component(Zt.name,Zt),e.component(Ot.name,Ot))}var Qt=Jt,Xt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-baselayer",staticStyle:{display:"none !important"}},[e._t("default",null,{select:e.selectFeature,move:e.moveFeature})],2)},en=[],tn=(r("8e6e"),r("bd86"));function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){Object(tn["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var on={name:"ol-layer",inject:["getMap"],props:{options:{type:Object,default:function(){return{name:"satelliteMap_base",source:{type:"XYZ",url:"http://webrd01.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}"},onLayerCreated:function(e){console.log(e)},visible:!0}}},params:Object,filter:{type:String,default:""}},data:function(){return{layer:null,selectFeature:null,moveFeature:null,curClickFeature:null,curMoveFeature:null,curMoveNormalStyle:null}},created:function(){this.init()},watch:{options:{handler:function(e){var t=this,n=this;n.selectFeature=null,n.getMap().then((function(e){n.updateLayer(e,Ue(t.options))}))},deep:!0},params:{handler:function(e){this.layer&&this.layer.getSource().updateParams&&this.layer.getSource().updateParams()},deep:!0}},methods:{init:function(){var e=this,t=this;t.getMap().then((function(n){t.map=n;var r=Ue(e.options);e.params&&(r.source.params=e.params),t.updateLayer(n,r),t.handleEvent(n)}))},updateLayer:function(e,t){var n=e.getView().getProjection();if(this.layer&&t.refresh){this.layer.getSource().clear&&this.layer.getSource().clear();var r,i=Ut.createSource(t.source,n,t.onLayerCreated);this.layer.setSource(i),t.opacity&&this.layer.setOpacity(t.opacity),t.visible&&this.layer.setVisible(t.visible),$e(this.layer.style)&&(r=ze(t.style)?t.style:rt(t.style),this.layer.setStyle&&ze(this.layer.setStyle)&&this.layer.setStyle(r))}else{this.layer&&(this.layer.getSource().clear&&this.layer.getSource().clear(),e.removeLayer(this.layer)),this.layer=Ut.createLayer(t,n,t.name,t.onLayerCreated),e.addLayer(this.layer);var o=this;o.filter&&o.layer.on("postcompose",(function(t){vt(t.context,ft(o.filter)),e.render()}))}},handleStyle:function(e,t){var n=[];if(Ve(e))if(e instanceof Array)for(var r=source.style.length,i=0;i<r;i++)n[i]=rt(e[i]);else n=ze(e)?rt(e(t)):rt(e);if(!(n instanceof Array&&0==n.length))return n},listenerMove:function(e){var t=this,n=e.feature,r=e.info.style;t.curMoveNormalStyle=t.handleStyle(r,n);var i=null;e.info.moveStyle&&(t.curMoveFeature&&t.curMoveFeature!=t.curClickFeature&&(t.curMoveFeature.setStyle(t.handleStyle(r,t.curMoveFeature)),t.curMoveFeature=null),n!=t.curClickFeature&&(i=t.handleStyle(e.info.moveStyle,n),n.setStyle(i),t.curMoveFeature=n));var o=e.coord,a=t.map.getView().getProjection();"pixel"!=a&&(o=Je(e.coord,a,"EPSG:4326")),t.moveFeature=rn({coord:o,projection:"pixel"===a?a:"EPSG:4326"},n.getProperties())},listenerMove_blank:function(){var e=this;e.curMoveFeature&&e.curMoveFeature!=e.curClickFeature&&e.curMoveFeature.setStyle(e.curMoveNormalStyle),e.curMoveFeature=null,e.moveFeature=null},listenerClick:function(e){var t=this,n=e.feature,r=(e.info.style,null);e.info.clickStyle&&(t.curClickFeature&&t.curClickFeature.setStyle(t.curClickStyle),t.curClickStyle=t.curMoveNormalStyle,r=t.handleStyle(e.info.clickStyle,n),n.setStyle(r),t.curClickFeature=n);var i=e.coord,o=t.map.getView().getProjection();"pixel"!=o&&(i=Je(e.coord,o,"EPSG:4326")),t.selectFeature=rn({coord:i,projection:"pixel"===o?o:"EPSG:4326"},n.getProperties())},listenerClick_blank:function(){var e=this;e.curClickFeature&&(e.curClickFeature.setStyle(e.curClickStyle),e.curClickFeature=null),e.selectFeature=null},handleEvent:function(e){var t=this,n=e.getTarget().id||"default";Wt.$on(n+".vectorLayer.pointermove",t.listenerMove),Wt.$on(n+".pointermove.blank",t.listenerMove_blank),Wt.$on(n+".vectorLayer.singleclick",t.listenerClick),Wt.$on(n+".singleclick.blank",t.listenerClick_blank)}},beforeDestroy:function(){var e=this,t=this;t.getMap().then((function(n){var r=t.layer.getSource();r.clear&&r.getFeatures&&(r.getFeatures().forEach((function(e){e.getStyle();e.setStyle(null),e=null})),r.clear()),r=null,t.layer.setSource(void 0),n.removeLayer(e.layer);var i=n.getTarget().id||"default";Wt.$off(i+".vectorLayer.pointermove",t.listenerMove),Wt.$off(i+".pointermove.blank",t.listenerMove_blank),Wt.$off(i+".vectorLayer.singleclick",t.listenerClick),Wt.$off(i+".singleclick.blank",t.listenerClick_blank)})),this.selectFeature=null,this.moveFeature=null,this.curClickFeature=null,this.curMoveFeature=null,this.curMoveNormalStyle=null}},an=on,sn=Object(j["a"])(an,Xt,en,!1,null,null,null),ln=sn.exports;function cn(e){cn.installed||(cn.installed=!0,e.component(ln.name,ln))}var un=cn,hn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-markerLayer"},[e._t("default")],2)},dn=[],fn={name:"ol-markers",provide:function(){return{getLayer:this.getLayer}},inject:["getMap"],props:{zIndex:{type:Number,default:0}},data:function(){return{layer:null}},beforeDestroy:function(){var e=this;e.getMap().then((function(t){var n=e.layer.getSource();n.getFeatures().forEach((function(e){e.getStyle();e.setStyle(null),e=null})),n.clear(),t.removeLayer(e.layer)}))},created:function(){var e=this;e.getMap().then((function(t){e.createLayer(t)})),e.promise=new Promise((function(t,n){e.resolve=t}))},methods:{createLayer:function(e){this.layer=new X["a"]({source:new ee["a"]({strategy:Vt["b"]}),zIndex:this.zIndex}),this.layer.set("markers",!0),e.addLayer(this.layer),this.resolve(this.layer)},getLayer:function(){var e=this;return e.promise}}},pn=fn,vn=Object(j["a"])(pn,hn,dn,!1,null,null,null),mn=vn.exports,gn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-marker",staticStyle:{display:"none"}},[e._t("default",null,{selectPoint:e.selectPoint})],2)},yn=[],bn=(r("96cf"),r("3b8d")),Pn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAGmklEQVRYw7VXeUyTZxjvNnfELFuyIzOabermMZEeQC/OclkO49CpOHXOLJl/CAURuYbQi3KLgEhbrhZ1aDwmaoGqKII6odATmH/scDFbdC7LvFqOCc+e95s2VG50X/LLm/f4/Z7neY/ne18aANCmAr5E/xZf1uDOkTcGcWR6hl9247tT5U7Y6SNvWsKT63P58qbfeLJG8M5qcgTknrvvrdDbsT7Ml+tv82X6vVxJE33aRmgSyYtcWVMqX97Yv2JvW39UhRE2HuyBL+t+gK1116ly06EeWFNlAmHxlQE0OMiV6mQCScusKRlhS3QLeVJdl1+23h5dY4FNB3thrbYboqptEFlphTC1hSpJnbRvxP4NWgsE5Jyz86QNNi/5qSUTGuFk1gu54tN9wuK2wc3o+Wc13RCmsoBwEqzGcZsxsvCSy/9wJKf7UWf1mEY8JWfewc67UUoDbDjQC+FqK4QqLVMGGR9d2wurKzqBk3nqIT/9zLxRRjgZ9bqQgub+DdoeCC03Q8j+0QhFhBHR/eP3U/zCln7Uu+hihJ1+bBNffLIvmkyP0gpBZWYXhKussK6mBz5HT6M1Nqpcp+mBCPXosYQfrekGvrjewd59/GvKCE7TbK/04/ZV5QZYVWmDwH1mF3xa2Q3ra3DBC5vBT1oP7PTj4C0+CcL8c7C2CtejqhuCnuIQHaKHzvcRfZpnylFfXsYJx3pNLwhKzRAwAhEqG0SpusBHfAKkxw3w4627MPhoCH798z7s0ZnBJ/MEJbZSbXPhER2ih7p2ok/zSj2cEJDd4CAe+5WYnBCgR2uruyEw6zRoW6/DWJ/OeAP8pd/BGtzOZKpG8oke0SX6GMmRk6GFlyAc59K32OTEinILRJRchah8HQwND8N435Z9Z0FY1EqtxUg+0SO6RJ/mmXz4VuS+DpxXC3gXmZwIL7dBSH4zKE50wESf8qwVgrP1EIlTO5JP9Igu0aexdh28F1lmAEGJGfh7jE6ElyM5Rw/FDcYJjWhbeiBYoYNIpc2FT/SILivp0F1ipDWk4BIEo2VuodEJUifhbiltnNBIXPUFCMpthtAyqws/BPlEF/VbaIxErdxPphsU7rcCp8DohC+GvBIPJS/tW2jtvTmmAeuNO8BNOYQeG8G/2OzCJ3q+soYB5i6NhMaKr17FSal7GIHheuV3uSCY8qYVuEm1cOzqdWr7ku/R0BDoTT+DT+ohCM6/CCvKLKO4RI+dXPeAuaMqksaKrZ7L3FE5FIFbkIceeOZ2OcHO6wIhTkNo0ffgjRGxEqogXHYUPHfWAC/lADpwGcLRY3aeK4/oRGCKYcZXPVoeX/kelVYY8dUGf8V5EBRbgJXT5QIPhP9ePJi428JKOiEYhYXFBqou2Guh+p/mEB1/RfMw6rY7cxcjTrneI1FrDyuzUSRm9miwEJx8E/gUmqlyvHGkneiwErR21F3tNOK5Tf0yXaT+O7DgCvALTUBXdM4YhC/IawPU+2PduqMvuaR6eoxSwUk75ggqsYJ7VicsnwGIkZBSXKOUww73WGXyqP+J2/b9c+gi1YAg/xpwck3gJuucNrh5JvDPvQr0WFXf0piyt8f8/WI0hV4pRxxkQZdJDfDJNOAmM0Ag8jyT6hz0WGXWuP94Yh2jcfjmXAGvHCMslRimDHYuHuDsy2QtHuIavznhbYURq5R57KpzBBRZKPJi8eQg48h4j8SDdowifdIrEVdU+gbO6QNvRRt4ZBthUaZhUnjlYObNagV3keoeru3rU7rcuceqU1mJBxy+BWZYlNEBH+0eH4vRiB+OYybU2hnblYlTvkHinM4m54YnxSyaZYSF6R3jwgP7udKLGIX6r/lbNa9N6y5MFynjWDtrHd75ZvTYAPO/6RgF0k76mQla3FGq7dO+cH8sKn0Vo7nDllwAhqwLPkxrHwWmHJOo+AKJ4rab5OgrM7rVu8eWb2Pu0Dh4eDgXoOfvp7Y7QeqknRmvcTBEyq9m/HQQSCSz6LHq3z0yzsNySRfMS253wl2KyRDbcZPcfJKjZmSEOjcxyi+Y8dUOtsIEH6R2wNykdqrkYJ0RV92H0W58pkfQk7cKevsLK10Py8SdMGfXNXATY+pPbyJR/ET6n9nIfztNtZYRV9XniQu9IA2vOVgy4ir7GCLVmmd+zjkH0eAF9Po6K61pmCXHxU5rHMYd1ftc3owjwRSVRzLjKvqZEty6cRUD7jGqiOdu5HG6MdHjNcNYGqfDm5YRzLBBCCDl/2bk8a8gdbqcfwECu62Fg/HrggAAAABJRU5ErkJggg==",wn={view:{projection:"EPSG:3857",minZoom:void 0,maxZoom:void 0,rotation:0,extent:void 0},center:{lat:0,lon:0,zoom:1,autodiscover:!1,bounds:[],centerUrlHash:!1,projection:"EPSG:4326"},styles:{path:{fill:{color:"rgba(255,0,0,0.2)"},stroke:{color:"blue",width:4}},marker:{image:new ae["a"]({anchor:[.5,1],anchorXUnits:"fraction",anchorYUnits:"fraction",opacity:.9,src:Pn})},feature:{fill:new re["a"]({color:"#0099ff"}),stroke:new ie["a"]({color:"#1F497D",width:1}),image:new oe["a"]({radius:7,fill:new re["a"]({color:"#0099ff"}),stroke:new ie["a"]({color:"#1F497D",width:1})})}},events:{map:[],markers:[],layers:[]},controls:{attribution:!0,rotate:!1,zoom:!0},interactions:{mouseWheelZoom:!1},renderer:"canvas"},On={getDefaults:function(){return wn}},kn={name:"ol-marker",inject:["getMap","getLayer"],props:{options:{type:Object,default:function(){return{id:"default",lat:30,lon:120,projection:"EPSG:4326",info:"",overLabel:"name",style:{image:{circle:{radius:10,fill:{color:"rgba(103, 58, 183, 0.5)"}}}}}}},blankClear:{type:Boolean,default:!0}},data:function(){return{marker:null,markerLayer:null,defaultProperties:{id:"",projection:"EPSG:4326",lat:0,lon:0,show:!0,showOnMouseOver:!1,showOnMouseClick:!1,keepOneOverlayVisible:!0,ngClick:!1,clickLabel:{},overLabel:{},info:{}},resultData:{},selectPoint:null}},mounted:function(){this.init()},watch:{options:{handler:function(){var e=Object(bn["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=this,e.next=3,n.getMap();case 3:r=e.sent,n.updateMarker(r,t);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deep:!0}},methods:{listenerMove:function(e){var t=this;e.feature==t.marker?(t.$emit("pointermove"),t.label=t.showNameOverlay(t.map,e.feature)):t.label&&t.map.removeOverlay(t.label)},listenerMove_blank:function(){var e=this;e.label&&e.map.removeOverlay(e.label)},listenerClick:function(e){var t=this;e.feature==t.marker?(t.$emit("singleclick"),t.selectPoint=Object.assign({},Ue(t.options),{coord:[t.options.lon,t.options.lat]})):t.selectPoint=null},listenerClick_blank:function(){var e=this;e.blankClear&&(e.selectPoint=null)},init:function(){var e=this,t=this;t.getMap().then((function(n){if(!t.getLayer)return console.error("[Vue - Openlayers] 缺少ol-markers"),!1;t.map=n,t.getLayer().then((function(r){e.markerLayer=r,t.updateMarker(n,t.options)}));var r=n.getTarget().id||"default";Wt.$on(r+".marker.pointermove",t.listenerMove),Wt.$on(r+".pointermove.blank",t.listenerMove_blank),Wt.$on(r+".marker.singleclick",t.listenerClick),Wt.$on(r+".singleclick.blank",t.listenerClick_blank)}))},updateMarker:function(e,t){var n=this,r=n.marker,i=n.defaultProperties,o=e.getView().getProjection().getCode(),a=On.getDefaults();if(t.lon=parseFloat(t.lon),t.lat=parseFloat(t.lat),r){var s;if(s="pixel"===t.projection?t.coord||[t.lon,t.lat]:Object(Se["m"])([t.lon,t.lat],i.projection,e.getView().getProjection()),!Be(n.marker.getGeometry().getCoordinates(),s)){var l=new ve["a"](s);r.setGeometry(l)}if(Ve(t.style)){var c=[];if(t.style instanceof Array)for(var u=t.style.length,h=0;h<u;h++)c[h]=rt(t.style[h]);else c=rt(t.style);r.setStyle(c)}r.get("overLay")&&r.get("overLay").getMap()&&r.get("overLay").setPosition(s),i.lat=t.lat?t.lat:i.lat,i.lon=t.lon?t.lon:i.lon,i.info=t.info?t.info:i.info,i.name=t.name,Ve(t.style)&&(i.style=t.style)}else{if(i.id=t.id?t.id:i.id,i.projection=t.projection?t.projection:i.projection,i.lat=isNaN(t.lat)?i.lat:t.lat,i.lon=isNaN(t.lon)?i.lon:t.lon,i.name=t.name,i.info=t.info?t.info:i.info,!i.lat&&0!=i.lat||!i.lon&&0!=i.lon)return console.log("缺失经纬度"),!1;if("EPSG:4326"==i.projection&&!Ke(i.lon,i.lat))return console.error("marker 经纬度不规范！",i),!1;Ve(t.overLabel)&&(i.overLabel=t.overLabel),Ve(t.style)?i.style=t.style:i.style=a.styles.marker,r=at(i,o),Ve(r)||console.error("[Vue - Openlayers] Received invalid data on the marker."),r.set("featureInfo",{type:"marker",data:i}),n.markerLayer.getSource().addFeature(r),n.marker=r}n.resultData=i},showNameOverlay:function(e,t){var n=this;ut(e,null,"overLabel");var r=null;if("none"==n.options.overLabel)return!1;if((!n.options.overLabel||"name"==n.options.overLabel)&&n.options.name){var i={lat:this.resultData.lat,lon:this.resultData.lon,projection:this.resultData.projection,label:{classNm:"featureOver",message:this.resultData.name}};r=ht(t,e,i)}return r&&r.set("overLabel","true"),r},clearSelect:function(){this.selectPoint=null}},beforeDestroy:function(){var e=this;if(e.selectPoint=null,e.marker&&e.markerLayer.getSource().removeFeature(e.marker),e.map){var t=e.map.getTarget().id||"default";Wt.$off(t+".marker.pointermove",e.listenerMove),Wt.$off(t+".pointermove.blank",e.listenerMove_blank),Wt.$off(t+".marker.singleclick",e.listenerClick),Wt.$off(t+".singleclick.blank",e.listenerClick_blank)}}},jn=kn,_n=Object(j["a"])(jn,gn,yn,!1,null,null,null),Cn=_n.exports;function En(e){En.installed||(En.installed=!0,e.component(mn.name,mn),e.component(Cn.name,Cn))}var Sn=En,Ln=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-overlay-container",staticStyle:{display:"none"}},[n("div",{staticClass:"vueol-overlay"},[e._t("default",null,{id:e.id,position:e.position,offset:e.offset,positioning:e.positioning})],2)])},In=[];function Mn(){for(var e=[],t="0123456789abcdef",n=0;n<36;n++)e[n]=t.substr(Math.floor(16*Math.random()),1);e[14]="4",e[19]=t.substr(3&e[19]|8,1),e[8]=e[13]=e[18]=e[23]="-";var r=e.join("");return r}var xn={name:"ol-overlay",inject:["getMap"],props:{id:{type:[String,Number],default:function(){return Mn()}},category:String,offset:{type:Array,default:function(){return[0,0]},validator:function(e){return 2===e.length}},position:{type:Array,validator:function(e){return 2===e.length},required:!0},projection:{type:String,default:"EPSG:4326"},positioning:{type:String,default:"top-left"},stopEvent:{type:Boolean,default:!0},insertFirst:{type:Boolean,default:!0},autoPan:{type:Boolean,default:!1},autoPanMargin:{type:Number,default:20},autoPanAnimation:Object,single:{type:Boolean,default:!0}},data:function(){return{$overlay:null}},watch:{offset:function(e){this.$overlay&&!Be(e,this.$overlay.getOffset())&&this.$overlay.setOffset(e)},position:{handler:function(e){var t=this;t.getMap().then((function(n){var r=e;"pixel"!=t.projection&&(r=Je(e,t.projection,n.getView().getProjection().getCode())),t.$overlay&&!Be(r,t.$overlay.getPosition())&&t.$overlay.setPosition(r)}))},deep:!0},positioning:function(e){this.$overlay&&e!==this.$overlay.getPositioning()&&this.$overlay.setPositioning(e)}},methods:{init:function(){var e=this;e.getMap().then((function(t){ut(t,null,"single"),e.$overlay=e.createObj(t),e.$overlay.set("single",e.single),e.$overlay.set(e.category,!0),t.addOverlay(e.$overlay);var n=e.position;n[0]&&n[1]&&("pixel"!=e.projection&&(n=Je(e.position,e.projection,t.getView().getProjection().getCode())),e.$overlay.setPosition(n))}))},createObj:function(e){var t=this.$el.className,n=t.split(" ").slice(1),r=this.$el.children[0];return r.className="vueol-overlay "+n.join(" "),this.$el.className="vueol-overlay-container",new Ee["a"]({id:this.id,element:this.$el.children[0],offset:this.offset,positioning:this.positioning,stopEvent:this.stopEvent,insertFirst:this.insertFirst,autoPan:this.autoPan,autoPanMargin:this.autoPanMargin,autoPanAnimation:this.autoPanAnimation})}},mounted:function(){var e=this;this.$nextTick((function(){e.init()}))},beforeDestroy:function(){var e=this;e.getMap().then((function(t){e.$overlay.setElement(void 0),t.removeOverlay(e.$overlay)}))}},Tn=xn,An=Object(j["a"])(Tn,Ln,In,!1,null,null,null),Rn=An.exports;function Fn(e){Fn.installed||(Fn.installed=!0,e.component(Rn.name,Rn))}var Dn=Fn,Nn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-cluster",staticStyle:{display:"none"}},[n("div",{staticClass:"featureOver clusterMulOver"},[n("ul",{staticClass:"featureList",attrs:{id:"clusterList"}},e._l(e.clusterList,(function(t){return n("li",{on:{click:function(n){return e.locateFeature(t.id,t.coord)}}},[e._v(e._s(t.name))])})),0)]),e._t("default",null,{points:e.points,selectPoint:e.selectPoint})],2)},Gn=[],Vn=(r("ac4d"),r("8a81"),r("5df3"),r("1c4c"),r("35a7"));function $n(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=zn(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function zn(e,t){if(e){if("string"===typeof e)return Hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hn(e,t):void 0}}function Hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Bn={name:"ol-cluster",inject:["getMap"],props:{points:{type:Array,required:!0,default:function(){return[]}},clusterStyle:{type:Object,default:function(){return{image:{circle:{radius:10,stroke:{color:"#fff"},fill:{color:"#3399CC"},atlasManager:{initialSize:512}}},text:{text:"",fill:{color:"#fff"}}}}},pointStyle:[Object,Array],zIndex:{type:Number,default:0},distance:{type:Number,default:20},projection:{type:String,default:"EPSG:4326"},overLabel:{type:String},blankClear:{type:Boolean,default:!0},selectPointId:[String,Number]},data:function(){var e=rt(this.clusterStyle),t=[];if(this.pointStyle instanceof Array)for(var n=this.pointStyle.length,r=0;r<n;r++)t[r]=rt(this.pointStyle[r]);else t=rt(this.pointStyle);return{layer:null,gatherStyle:e,commonStyle:t,nameLabel:null,clusterLabel:null,clusterList:[],exoticId:this.selectPointId,selectPoint:null}},watch:{points:{handler:function(e){var t=this;t.selectPoint=null,t.getMap().then((function(e){t.updateCluster(e)}))},deep:!0},clusterStyle:{handler:function(e){var t=this;t.gatherStyle=rt(this.clusterStyle)},deep:!0},pointStyle:{handler:function(e){var t=this,n=[];if(e instanceof Array)for(var r=e.length,i=0;i<r;i++)n[i]=rt(e[i]);else n=rt(e);t.commonStyle=n},deep:!0},selectPointId:{handler:function(e){var t=this;if(!e)return t.selectPoint=null,!1;t.checkPoint(e)}},selectPoint:function(e){e?this.$emit("update:selectPointId",e.id):this.$emit("update:selectPointId","")}},created:function(){this.init()},methods:{init:function(){var e,t=this;t.getMap().then((function(n){t.map=n,t.createLayer(n),t.updateCluster(n);var r=n.getView();e&&Object(Vn["b"])(e),e=r.on("change:resolution",(function(){t.clusterLabel&&t.clusterLabel.setPosition(void 0)}));var i=n.getTarget().id||"default";t.listen(n,i),t.selectPointId&&t.checkPoint(t.selectPointId)}))},createLayer:function(e){this.layer=new X["a"]({source:new Rt["a"]({distance:this.distance,source:new ee["a"]({strategy:Vt["b"]})}),zIndex:this.zIndex}),this.layer.set("cluster",!0),e.addLayer(this.layer)},styleFunction:function(e){var t,n=e.get("features").length;if(n>1){if(t=this.gatherStyle,t.setZIndex(n),t&&t.getText()){var r=n.toString();n>99&&(r="99+"),t.getText().setText(r)}}else{var i=e.get("features")[0].get("pointStyle");if(this.commonStyle)t=this.commonStyle;else{var o=[];if(i instanceof Array)for(var a=i.length,s=0;s<a;s++)o[s]=rt(i[s]);else o=rt(i);t=rt(o)}}return t},isRepeatId:function(e){var t,n=[],r=$n(e);try{var i=function(){var r=t.value;if(!r.id)return console.log("id缺失："+JSON.stringify(r)),{v:!0};if(-1!=n.indexOf(r.id)){var i=e.filter((function(e){return e.id==r.id}));return console.log("id重复："+JSON.stringify(i)),{v:!0}}n.push(r.id)};for(r.s();!(t=r.n()).done;){var o=i();if("object"===Object(J["a"])(o))return o.v}}catch(a){r.e(a)}finally{r.f()}return!1},updateCluster:function(e){var t=this.points;if(this.isRepeatId(t))return console.error("聚集点位必须有唯一的id值"),!1;var n=t.length,r=e.getView().getProjection().getCode(),i=new Array;this.storeObject={};for(var o={projection:this.projection,label:{title:"",message:"",classNm:"",placement:"top"},coord:[0,0],lat:0,lon:0,keepOneOverlayVisible:!0,clickLabel:{},overLabel:{}},a=0;a<n;a++){var s=t[a];if(s.lon&&s.lat){if("EPSG:4326"==this.projection&&!Ke(s.lon,s.lat)){console.error("经纬度不规范！"+s.lon+", "+s.lat);continue}var l=at({projection:this.projection,lat:parseFloat(s.lat),lon:parseFloat(s.lon),id:s.id,name:s.name},r);i.push(l);var c=Ue(o);c.coord=[parseFloat(t[a].lon),parseFloat(t[a].lat)],c.lon=c.coord[0],c.lat=c.coord[1],c.info=t[a].info,l.set("featureInfo",{type:"clusterFeature",data:c}),Ve(s.style)&&l.set("pointStyle",s.style),this.storeObject[s.id]=s}else console.error("经纬度缺失！")}this.layer.getSource().getSource().clear(!0),this.layer.getSource().getSource().addFeatures(i),this.layer.setStyle(this.styleFunction),this.$once("hook:beforeDestroy",(function(){i=[]}))},showNameOverlay:function(e,t,n){var r=this;ut(e,null,"overLabel");var i=null;return"none"!=r.overLabel&&(r.overLabel&&"name"!=r.overLabel||(i=ht(t,e,n)),i&&i.set("overLabel","true"),i)},setMoveLay:function(e,t){var n=e.getView().getProjection().getCode(),r=t.get("features"),i=r.length;if(1==i){var o=r[0].getGeometry().getCoordinates(),a={lat:o[1],lon:o[0],projection:n,label:{classNm:"featureOver",message:r[0].get("name")||"空"}};this.nameLabel=this.showNameOverlay(e,r[0],a)}else{var s=t.getGeometry().getCoordinates();if(this.clusterLabel&&this.clusterLabel.get("clusterClickLabel")&&this.clusterLabel.getPosition())return;this.clusterList=r.map((function(e){return{id:e.get("id"),name:e.get("name")||"空",coord:e.getGeometry().getCoordinates()}})),ut(e,null,"overLabel"),this.clusterLabel?(this.clusterLabel.setPosition(s),this.clusterLabel.get("clusterClickLabel")&&(this.clusterLabel.unset("clusterClickLabel"),this.clusterLabel.getElement().classList.remove("clusterMulClick"),this.clusterLabel.set("clusterMoveLabel","true"))):(this.clusterLabel=ct(this.$el.children[0],s),e.addOverlay(this.clusterLabel),this.clusterLabel&&this.clusterLabel.set("clusterMoveLabel","true"))}},listenerMove:function(e){var t=this;e.olLayer==t.layer&&(t.$emit("pointermove",e),t.setMoveLay(t.map,e.feature))},listenerMove_blank:function(){var e=this;ut(e.map,null,"overLabel"),e.clusterLabel&&e.clusterLabel.get("clusterMoveLabel")&&e.clusterLabel.getPosition()&&e.clusterLabel.setPosition(void 0)},listenerClick:function(e){var t=this;if(e.olLayer==t.layer){t.$emit("singleclick",e);var n=e.feature,r=n.get("features"),i=r.length;i>1?t.clusterLabel&&t.clusterLabel.get("clusterMoveLabel")&&(t.clusterLabel.unset("clusterMoveLabel"),t.clusterLabel.set("clusterClickLabel","true"),t.clusterLabel.getElement().classList.add("clusterMulClick"),t.selectPoint=null):(t.clusterLabel&&t.clusterLabel.setPosition(void 0),t.checkPoint(r[0].get("id")))}},listenerClick_blank:function(){var e=this;e.blankClear&&(e.selectPoint=null),e.clusterLabel&&e.clusterLabel.get("clusterClickLabel")&&e.clusterLabel.setPosition(void 0)},listen:function(e,t){var n=this;Wt.$on(t+".cluster.pointermove",n.listenerMove),Wt.$on(t+".pointermove.blank",n.listenerMove_blank),Wt.$on(t+".cluster.singleclick",n.listenerClick),Wt.$on(t+".singleclick.blank",n.listenerClick_blank)},locateFeature:function(e,t){var n=this;n.getMap().then((function(r){n.clusterLabel.setPosition(void 0);var i=r.getView(),o=i.getZoom(),a=i.getMaxZoom()||18,s=Math.max(a,o+2);i.animate({center:t},{zoom:s},(function(){n.checkPoint(e)}))}))},checkPoint:function(e){var t=this,n=t.storeObject[e];n&&(t.selectPoint=Object.assign({},Ue(n),{coord:[n.lon,n.lat]}))},clearSelect:function(){this.selectPoint=null}},beforeDestroy:function(){var e=this;e.getMap().then((function(t){var n=e.layer.getSource();n.clear&&(n.getFeatures().forEach((function(e){e.getStyle();e.setStyle(null),e=null})),n.clear()),n=null,e.layer.setSource(void 0),t.removeLayer(e.layer),e.clusterLabel&&t.removeOverlay(e.clusterLabel),e.selectPoint=null;var r=t.getTarget().id||"default";Wt.$off(r+".cluster.pointermove",e.listenerMove),Wt.$off(r+".pointermove.blank",e.listenerMove_blank),Wt.$off(r+".cluster.singleclick",e.listenerClick),Wt.$off(r+".singleclick.blank",e.listenerClick_blank)}))}},Un=Bn,Wn=Object(j["a"])(Un,Nn,Gn,!1,null,null,null),Kn=Wn.exports;function Yn(e){Yn.installed||(Yn.installed=!0,e.component(Kn.name,Kn))}var qn=Yn,Zn=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-interaction-point",staticStyle:{display:"none"}})},Jn=[],Qn=r("c807"),Xn=r("ac29"),er=r("b2fc"),tr=r("834d"),nr=r("617d"),rr={name:"ol-draw-point",inject:["getMap"],props:{hasPoints:{type:Array},isModify:{type:Boolean,default:!0},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"},pixelTolerance:{type:Number,default:20},icon:{type:Object,default:function(){return{image:{circle:{radius:6,fill:{color:"#0099ff"},stroke:{color:"#fff",width:1}}}}}},newId:[String,Number]},data:function(){return{layer:null,source:null,draw:null,snap:null,modify:null,style:null}},watch:{hasPoints:function(){var e=this;this.source.clear(),this.getMap().then((function(t){e.loadPoints(t)}))},isModify:function(e){this.modify.setActive(e)},newId:function(){var e=this;this.getMap().then((function(t){e.addPoint(t)}))}},created:function(){this.init()},methods:{init:function(){var e=this;this.style=rt(this.icon),this.getMap().then((function(t){e.createLayer(t),e.loadPoints(t)}))},createCornerLine:function(e){var t=nr["b"],n=document.createElement("canvas"),r=Object(tr["a"])(n.getContext("2d"),{size:[2*e/t,2*e/t],pixelRatio:t});r.setStyle(new ne["c"]({fill:new re["a"]({color:"blue"}),stroke:new ie["a"]({width:4/t,color:"#333"})}));var i=5/t,o=2*e/t,a=[[[0,0],[i,0]],[[o-i,0],[o,0]],[[o,0],[o,i]],[[o,o-i],[o,o]],[[o,o],[o-i,o]],[[i,o],[0,o]],[[0,o],[0,o-i]],[[0,i],[0,0]]];return a.forEach((function(e){var t=new fe["a"](e);r.drawGeometry(t)})),n},createLayer:function(e){var t=this;t.source=new ee["a"],t.layer=new X["a"]({source:t.source,zIndex:t.zIndex}),t.layer.set("drawLayer",!0),e.addLayer(this.layer),this.modify=new Qn["a"]({source:t.source,style:function(e){var n=t.pixelTolerance,r=t.createCornerLine(n);return new ne["c"]({image:new ae["a"]({anchor:[.5,.5],img:r,imgSize:[r.width,r.height]})})},pixelTolerance:this.pixelTolerance}),e.addInteraction(this.modify),this.modify.setActive(t.isModify),this.modify.on("modifyend",(function(n){var r=t.source.getFeatures(),i=r.map((function(n){var r,i=n.getGeometry().getCoordinates();return r="pixel"===t.projection?i:Object(Se["m"])(i,e.getView().getProjection(),t.projection),{coord:r,fId:n.get("id")}}));t.$emit("drawend",i)}))},addInteractions:function(e){var t=this;this.draw=new Xn["c"]({source:this.source,type:"Point",style:this.style}),e.addInteraction(this.draw),this.snap=new er["a"]({source:this.source}),e.addInteraction(this.snap),this.draw.on("drawend",(function(n){var r,i=n.feature;i.setStyle(t.style),i.set("id",t.newId),e.removeInteraction(t.draw),r="pixel"===t.projection?i.getGeometry().getCoordinates():Object(Se["m"])(i.getGeometry().getCoordinates(),e.getView().getProjection(),t.projection),t.$emit("drawend",[{coord:r,fId:i.get("id")}])}))},addPoint:function(e){this.draw&&e.removeInteraction(this.draw),e.removeInteraction(this.snap),this.style=rt(this.icon),this.addInteractions(e)},loadPoints:function(e){for(var t=e.getView().getProjection().getCode(),n=new Array,r=this.hasPoints.length,i=0;i<r;i++){var o=this.hasPoints[i];if(o.lon&&o.lat){if(o.lon=parseFloat(o.lon),o.lat=parseFloat(o.lat),"EPSG:4326"==this.projection&&!Ke(o.lon,o.lat)){console.error("经纬度不规范！");continue}var a=at({projection:this.projection,lat:parseFloat(o.lat),lon:parseFloat(o.lon),id:o.id,name:o.name},t);if(Ve(o.style)){(!o.style.zIndex||o.style.zIndex<2)&&(o.style.zIndex=2);var s=rt(o.style);a.setStyle(s)}else a.setStyle(this.style);n.push(a)}}this.layer.getSource().addFeatures(n)}},beforeDestroy:function(){var e=this,t=this;t.getMap().then((function(n){e.source.clear(),n.removeLayer(t.layer),e.draw&&n.removeInteraction(e.draw),n.removeInteraction(e.snap),n.removeInteraction(e.modify)}))}},ir=rr,or=Object(j["a"])(ir,Zn,Jn,!1,null,null,null),ar=or.exports,sr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-interaction-shape",staticStyle:{display:"none"}})},lr=[],cr={name:"ol-draw-shape",inject:["getMap"],props:{type:{type:String,required:!0,default:"Point"},hasFeatures:{type:Array,default:function(){return[]}},isModify:{type:Boolean,default:!0},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"},olStyle:{type:Object,default:function(){return{fill:{color:[32,88,165,.4]},stroke:{color:"#2058A5",width:2},image:{circle:{radius:6,fill:{color:"#0099ff"},stroke:{color:"#fff",width:1}}}}}},newId:[String,Number],isSingle:{type:Boolean,default:!1}},data:function(){return{}},watch:{hasFeatures:function(){var e=this;this.source.clear(),this.getMap().then((function(t){e.loadFeatures(t)}))},isModify:function(e){this.modify.setActive(e)},newId:function(){var e=this;this.getMap().then((function(t){e.addFeature(t)}))}},created:function(){this.init()},methods:{initData:function(){this.map=null,this.layer=null,this.source=null,this.draw=null,this.snap=null,this.modify=null,this.style=null},init:function(){var e=this;this.initData(),this.style=rt(this.olStyle),this.getMap().then((function(t){e.map=t,e.createLayer(t),e.loadFeatures(t)}))},addModify:function(){var e=this,t=new Qn["a"]({source:e.source});return t.setActive(e.isModify),t.on("modifyend",(function(t){var n=e.source.getFeatures(),r=n.map((function(t){var n,r,i=t.getGeometry();if("pixel"!=e.projection&&(i=i.clone().transform(e.map.getView().getProjection(),e.projection)),n="Circle"!=e.type?i.getCoordinates():i.getRadius(),"Point"==e.type)r=n;else if("LineString"==e.type)r=i.getCoordinateAt(.5);else if("Circle"==e.type)r=i.getCenter();else if("Polygon"==e.type){var o=i.getInteriorPoint().getCoordinates();r=[o[0],o[1]]}else if(i.getCenter)r=i.getCenter();else{var a=i.getInteriorPoint().getCoordinates();r=[a[0],a[1]]}return{coord:n,center:r,fId:t.get("id")}}));e.$emit("drawend",r)})),t},createLayer:function(e){var t=this;t.source=new ee["a"],t.layer=new X["a"]({source:t.source,zIndex:t.zIndex}),t.layer.set("shapeLayer",!0),e.addLayer(this.layer),t.modify=t.addModify(),e.addInteraction(t.modify)},starGeo:function(e,t){for(var n=e[0],r=e[1],i=n[0]-r[0],o=n[1]-r[1],a=Math.sqrt(i*i+o*o),s=Math.atan2(o,i),l=[],c=12,u=0;u<c;++u){var h=s+2*u*Math.PI/c,d=u%2===0?1:.5,f=a*d*Math.cos(h),p=a*d*Math.sin(h);l.push([n[0]+f,n[1]+p])}return l.push(l[0].slice()),t?t.setCoordinates([l]):t=new he["a"]([l]),t},drawEnd:function(e){var t=this,n=e.feature;n.setStyle(t.style),n.set("id",t.newId),t.map.removeInteraction(t.draw);var r,i,o=n.getGeometry();if("pixel"!=t.projection&&(o=o.clone().transform(t.map.getView().getProjection(),t.projection)),r="Circle"!=t.type?o.getCoordinates():o.getRadius(),"Point"==t.type)i=r;else if("LineString"==t.type)i=o.getCoordinateAt(.5);else if("Circle"==t.type)i=o.getCenter();else if("Polygon"==t.type){var a=o.getInteriorPoint().getCoordinates();i=[a[0],a[1]]}else if(o.getCenter)i=o.getCenter();else{var s=o.getInteriorPoint().getCoordinates();i=[s[0],s[1]]}this.$emit("drawend",[{coord:r,center:i,fId:n.get("id")}])},addInteractions:function(e){var t=this,n=t.type,r=null;"Box"==n?(n="Circle",r=Object(Xn["a"])()):"Square"==n?(n="Circle",r=Object(Xn["b"])(4)):"Star"===n&&(n="Circle",r=t.starGeo),t.draw=new Xn["c"]({source:t.source,type:n,style:t.style,geometryFunction:r}),e.addInteraction(t.draw),this.snap=new er["a"]({source:t.source}),e.addInteraction(t.snap),t.draw.on("drawend",t.drawEnd)},addFeature:function(e){this.draw&&e.removeInteraction(this.draw),e.removeInteraction(this.snap),this.isSingle&&this.source.clear(),this.style=rt(this.olStyle),this.addInteractions(e)},calcRadius:function(e,t){if(e){if("pixel"!=this.projection){var n=dt(this.projection,t,[t[0]+1,t[1]]),r=e/n;return r}return e}return 0},loadFeatures:function(e){for(var t=this,n=e.getView().getProjection().getCode(),r=new Array,i=t.hasFeatures.length,o=0;o<i;o++){var a=t.hasFeatures[o];if(a.coords){var s=a.type;"Box"!=s&&"Square"!=s&&"Star"!=s||(s="Polygon");var l={type:s,projection:t.projection,coords:a.coords,id:a.id,name:a.name};"Circle"==s&&(l.radius=a.radius);var c=at(l,n);if(Ve(a.style)){var u=rt(a.style);c.setStyle(u)}else c.setStyle(t.style);r.push(c)}}this.layer.getSource().addFeatures(r)}},beforeDestroy:function(){var e=this,t=this;t.getMap().then((function(n){e.source.clear(),n.removeLayer(t.layer),e.draw&&n.removeInteraction(e.draw),n.removeInteraction(e.snap),n.removeInteraction(e.modify)}))}},ur=cr,hr=Object(j["a"])(ur,sr,lr,!1,null,null,null),dr=hr.exports,fr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-interaction-route",staticStyle:{display:"none"}},[e._t("default",null,{selectPoint:e.selectPoint})],2)},pr=[],vr=r("cdf3"),mr={name:"ol-draw-route",inject:["getMap"],props:{isModify:{type:Boolean,default:!0},icon:{type:Object,default:function(){return{image:{circle:{radius:6,fill:{color:"#0099ff"},stroke:{color:"#fff",width:1}}}}}},lineStyle:{type:Object,default:function(){return{stroke:{color:"#2058A5",width:2}}}},modifyColor:String|Array,zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"},hasFeatures:{type:Array,default:function(){return[]}},newId:[String,Number],isSingle:{type:Boolean,default:!0}},data:function(){return{selectPoint:null}},watch:{hasFeatures:function(){var e=this;this.source.clear(),this.getMap().then((function(t){e.loadFeatures(t)}))},isModify:function(e){this.modify.setActive(e)},newId:function(){var e=this;this.getMap().then((function(t){e.addFeature(t)}))}},created:function(){this.init()},methods:{init:function(){var e=this;this.initData(),this.getMap().then((function(t){e.map=t,e.viewProjection=t.getView().getProjection().getCode(),e.layer=e.createLayer(t),e.pointLayer=e.createPointLayer(t),e.modify=e.addModify(),t.addInteraction(e.modify),e.loadFeatures(),e.listenEvent()}))},initData:function(){this.layer=null,this.source=null,this.pointLayer=null,this.pointSource=null,this.draw=null,this.snap=null,this.modify=null,this.curFeature=null,this.style=null,this.drawing=!1,this.listenChanges=[],this.listener=null},removeDblZoom:function(){var e=this,t=this.map.getInteractions();t.forEach((function(t){t instanceof vr["a"]&&e.map.removeInteraction(t)}))},addDblZoom:function(){var e=this.map.getInteractions(),t=!1;e.forEach((function(e){e instanceof vr["a"]&&(t=!0)})),t||this.map.addInteraction(new vr["a"])},modifyEnd:function(e){var t=this;t.drawing=!1;var n=t.source.getFeatures(),r=n.filter((function(e){var t=e.getGeometry();return t instanceof fe["a"]})),i=r.map((function(e){var n=e.getGeometry();"pixel"!=t.projection&&(n=n.clone().transform(t.map.getView().getProjection(),t.projection));var r=n.getCoordinates();return{coord:r,fId:e.get("id")}}));t.$emit("drawend",i)},addModify:function(){var e=this,t=new Qn["a"]({source:e.pointSource,deleteCondition:function(e){return!1},insertVertexCondition:function(){return!1},style:new ne["c"]({image:new oe["a"]({radius:5,fill:new re["a"]({color:e.modifyColor||"#1d94f7"}),stroke:new ie["a"]({width:1,color:"white"})})})});return t.setActive(e.isModify),t.on("modifystart",(function(t){e.drawing=!0,e.selectPoint=null})),t.on("modifyend",e.modifyEnd),t},createLayer:function(e){var t=this;t.source=new ee["a"];var n=new X["a"]({source:t.source,style:rt(Object.assign({},t.lineStyle,t.icon)),zIndex:t.zIndex});return n.set("routeLayer",!0),e.addLayer(n),n},createPointLayer:function(e){var t=this;t.pointSource=new ee["a"];var n=new X["a"]({source:t.pointSource,style:rt(Object.assign({zIndex:2},this.icon)),zIndex:t.zIndex});return n.set("routeLayer",!0),e.addLayer(n),n},createNode:function(e,t){var n=this,r={id:t,coords:e},i=at(r,this.viewProjection);i.set("name","drawNode"),i.set("nodeIndex",t.split("-")[1]),i.setId(t),this.pointSource.addFeature(i);var o=i.on("change",(function(e){var t=e.target,r=t.getId().split("-"),i=r[0],o=t.get("nodeIndex"),a=n.source.getFeatureById(i).getGeometry(),s=a.getCoordinates(),l=t.getGeometry().getCoordinates();s[o]=l,a.setCoordinates(s)}));this.listenChanges.push(o)},drawStart:function(e){var t=this;t.drawing=!0,t.curFeature=e.feature,t.curFeature.set("id",t.newId),t.curFeature.setId(t.newId)},drawEnd:function(){var e=this,t=e.curFeature,n=t.getGeometry(),r=n.getCoordinates();r.forEach((function(t,n){e.createNode(t,"".concat(e.newId,"-").concat(n))})),e.map.removeInteraction(e.draw),"pixel"!=e.projection&&(n=n.clone().transform(e.map.getView().getProjection(),e.projection));var i=n.getCoordinates();e.$emit("drawend",[{coord:i,fId:t.get("id")}]),e.curFeature=null,e.isModify&&e.modify.setActive(!0),e.drawing=!1,setTimeout((function(){e.addDblZoom()}))},styleFunction:function(e){var t=this,n=Object.assign({lineDash:[10,5]},t.lineStyle.stroke||{}),r=rt(Object.assign({stroke:n},t.icon)),i=[r],o=e.getGeometry();if(o instanceof fe["a"]){var a=!1;o.forEachSegment((function(e,n){a||(i.push(new ne["c"]({geometry:new ve["a"](e),image:rt(t.icon,"image")})),a=!0),i.push(new ne["c"]({geometry:new ve["a"](n),image:rt(t.icon,"image")}))}))}return i},addInteractions:function(e){var t=this;t.draw=new Xn["c"]({source:t.source,type:"LineString",style:t.styleFunction}),e.addInteraction(t.draw),t.draw.on("drawstart",t.drawStart),t.draw.on("drawend",t.drawEnd),this.snap=new er["a"]({source:t.source}),e.addInteraction(t.snap),this.removeDblZoom(),t.isModify&&t.modify.setActive(!1)},addFeature:function(e){this.draw&&e.removeInteraction(this.draw),e.removeInteraction(this.snap),this.isSingle&&(this.source.clear(),this.pointSource.clear()),this.addInteractions(e)},loadFeatures:function(){for(var e=this,t=new Array,n=e.hasFeatures.length,r=0;r<n;r++){var i=e.hasFeatures[r];if(i.coord){var o={type:"LineString",projection:e.projection,coords:i.coord,id:i.fId},a=at(o,e.viewProjection);t.push(a)}}this.source.addFeatures(t)},listenClick:function(e){var t=this;if(this.drawing)return!1;var n=[],r=!1;this.map.forEachFeatureAtPixel(e.pixel,(function(e,t){n.push([t,e])})),n.forEach((function(e){if(e[0]&&e[1]&&"drawNode"==e[1].get("name")){var n=e[0],i=e[1];if(n.get("routeLayer")&&(r=!0,i.getGeometry()instanceof ve["a"])){var o=i.getGeometry().getCoordinates();"pixel"!=t.projection&&(o=Object(Se["m"])(o,t.viewProjection,t.projection)),t.selectPoint={coord:o,id:i.get("id")}}}})),r||(this.selectPoint=null)},listenEvent:function(){this.listener=this.map.on("click",this.listenClick)},changeNodeStyle:function(e,t){var n=this.pointSource.getFeatureById(e);n?(n.setStyle(rt(t)),this.selectPoint=null):console.error("id 不存在")},deleteNode:function(e,t){var n=this.source.getFeatureById(e),r=this.pointSource.getFeatureById(t);if(n){var i=n.getGeometry().getCoordinates(),o=r.getGeometry().getCoordinates();if(i.forEach((function(e,t){e[0]===o[0]&&e[1]===o[1]&&i.splice(t,1)})),i.length<2)alert("节点不能少于两个！");else if(n.getGeometry().setCoordinates(i),r){this.pointSource.removeFeature(r);var a=this.pointSource.getFeatures(),s=r.get("nodeIndex");a.forEach((function(e){var t=e.get("nodeIndex");t>s&&e.set("nodeIndex",t-1)}))}this.selectPoint=null}else console.error("id 不存在")}},beforeDestroy:function(){var e=this;e.getMap().then((function(t){e.source.clear(),t.removeLayer(e.layer),e.pointSource.clear(),t.removeLayer(e.pointLayer),e.draw&&t.removeInteraction(e.draw),t.removeInteraction(e.snap),t.removeInteraction(e.modify),e.listenChanges.forEach((function(e){e&&Object(Vn["b"])(e)})),e.listener&&Object(Vn["b"])(e.listener)}))}},gr=mr,yr=Object(j["a"])(gr,fr,pr,!1,null,"0ed449f9",null),br=yr.exports,Pr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-measure"},[e._l(e.deleteIcons,(function(t){return[n("div",{staticClass:"tooltip-close",attrs:{id:t.id}},[n("img",{attrs:{title:"删除",src:r("4736")},on:{click:function(n){return e.delObj(t.id)}}})])]}))],2)},wr=[],Or={name:"ol-measure",inject:["getMap"],props:{type:{type:String,required:!0,default:"LineString"},zIndex:{type:Number,default:0}},data:function(){return{layer:null,source:null,sketch:null,helpTooltipElement:null,helpTooltip:null,measureTooltipElement:null,measureTooltip:null,distanceTooltipElement:null,distanceTooltip:null,movePos:null,draw:null,featureNum:0,listenerClick:null,listenerChange:null,deleteIcons:[]}},watch:{type:function(){var e=this;this.getMap().then((function(t){t.removeInteraction(e.draw),e.addInteraction(t)}))}},created:function(){this.init()},methods:{init:function(){var e=this;this.getMap().then((function(t){e.projection=t.getView().getProjection().getCode(),e.createLayer(t),e.listenEvent(t),e.addInteraction(t)}))},createLayer:function(e){this.source=new ee["a"];var t=rt({fill:{color:[142,77,209,.3]},stroke:{color:"#8e4dd1",width:2}});this.layer=new X["a"]({source:this.source,style:t,zIndex:this.zIndex}),this.layer.set("measureLayer",!0),e.addLayer(this.layer)},createHelpTooltip:function(e,t){this.helpTooltipElement&&this.helpTooltipElement.parentNode.removeChild(this.helpTooltipElement),this.helpTooltipElement=document.createElement("div"),this.helpTooltipElement.className="tooltip hidden",this.helpTooltip=ct(this.helpTooltipElement,void 0,"helpTooltip",!1),this.helpTooltip.set("name",t),this.helpTooltip.setOffset([15,30]),e.addOverlay(this.helpTooltip)},createMeasureTooltip:function(e,t){this.measureTooltipElement&&this.measureTooltipElement.parentNode.removeChild(this.measureTooltipElement),this.measureTooltipElement=document.createElement("div"),this.measureTooltipElement.className="tooltip tooltip-measure",this.measureTooltip=ct(this.measureTooltipElement,void 0,"helpTooltip",!1),this.measureTooltip.set("name",t),this.measureTooltip.setOffset([15,30]),e.addOverlay(this.measureTooltip)},createDistanceTooltip:function(e,t){this.distanceTooltipElement=document.createElement("div"),this.distanceTooltipElement.className="tooltip tooltip-distance",this.distanceTooltip=ct(this.distanceTooltipElement,void 0,"distanceNum",!1),this.distanceTooltip.set("name",t),this.distanceTooltip.setOffset([10,0]),e.addOverlay(this.distanceTooltip)},createDelTooltip:function(e,t,n,r){this.$nextTick((function(){var i=ct(document.getElementById(t),n,t,!0),o=r.length;r[o-1][0]>r[o-2][0]?i.setOffset([10,0]):i.setOffset([-30,0]),i.set("name",t),e.addOverlay(i)}))},formatLength:function(e,t){var n,r=Math.round(100*Object(Le["c"])(e,{projection:t}))/100;return n=r>100?"<span>"+Math.round(r/1e3*100)/100+"</span> km":"<span>"+Math.round(100*r)/100+"</span> m",n},formatArea:function(e,t){var n,r=Object(Le["a"])(e,{projection:t});return n=r>1e4?"<span>"+Math.round(r/1e6*100)/100+"</span> km<sup>2</sup>":"<span>"+Math.round(100*r)/100+"</span> m<sup>2</sup>",n},outEvent:function(){var e=this;-1==e.helpTooltipElement.className.indexOf("hidden")&&(e.helpTooltipElement.className+=" hidden")},listenerMove:function(e){var t=this;if(!e.dragging)if(t.movePos=e.coordinate,t.sketch)t.helpTooltipElement.className+=" hidden";else{t.helpTooltipElement.innerHTML="单击确定起点",t.helpTooltip.setPosition(e.coordinate);var n=t.helpTooltipElement.className.split(" "),r=n.indexOf("hidden");-1!=r&&(n.splice(r,1),t.helpTooltipElement.className=n.join(" "))}},listenEvent:function(e){var t=this,n=e.getTarget().id||"default";Wt.$on(n+".pointermove",t.listenerMove),e.getViewport().addEventListener("mouseout",t.outEvent)},createPointStyle:function(e,t,n){var r=e.getView().getProjection().getCode(),i={coords:t,style:rt({image:{circle:{radius:4,fill:{color:"white"},stroke:{width:2,color:"#005699"}}}})},o=at(i,r);o.set("id",n),this.source.addFeature(o)},startDraw:function(e){var t=this;this.draw.on("drawstart",(function(n){t.featureNum++,t.sketch=n.feature;var r="measure"+t.featureNum;t.sketch.set("id",r),t.createMeasureTooltip(e,r),t.listenerClick=e.on("click",(function(n){var i=t.sketch.getGeometry().getLastCoordinate();"LineString"==t.type&&(t.distanceTooltipElement=null,t.createDistanceTooltip(e,r),t.distanceTooltipElement.innerHTML="起点",t.distanceTooltip.setPosition(i)),t.createPointStyle(e,i,r)})),t.listenerChange=t.sketch.getGeometry().on("change",(function(n){var i=n.target,o="",a="";i instanceof he["a"]?(a=t.formatArea(i,t.projection),o+="<div>面积："+a+"</div><div>单击继续绘制，双击结束</div>"):i instanceof fe["a"]&&(a=t.formatLength(i,t.projection),o="<div>总长："+a+"</div><div>单击继续绘制，双击结束</div>"),t.measureTooltipElement.innerHTML=o,t.measureTooltip.setPosition(t.movePos),t.listenerClick&&Object(Vn["b"])(t.listenerClick),t.listenerClick=e.on("click",(function(n){"LineString"==t.type&&(t.createDistanceTooltip(e,r),t.distanceTooltipElement.innerHTML=a,t.distanceTooltip.setPosition(t.movePos)),t.createPointStyle(e,t.movePos,r)}))}))}),this)},endDraw:function(e){var t=this;t.draw.on("drawend",(function(n){var r,i,o=t.sketch.getGeometry(),a="";if(o instanceof he["a"]){a+="<div>面积："+t.formatArea(o,t.projection)+"</div>";var s=o.getInteriorPoint().getCoordinates();r=o.getCoordinates()[0],i=r.length,t.measureTooltip.setPosition(s),t.measureTooltip.setOffset([0,-7])}else o instanceof fe["a"]&&(r=o.getCoordinates(),i=r.length,a="<div>总长："+t.formatLength(o,t.projection)+"</div>",r[i-1][1]>r[i-2][1]?t.measureTooltip.setOffset([-5,-40]):t.measureTooltip.setOffset([-5,20]));t.measureTooltipElement.innerHTML=a,t.measureTooltipElement.className="tooltip tooltip-static",t.deleteIcons.push({id:t.sketch.get("id")}),t.createDelTooltip(e,t.deleteIcons[t.deleteIcons.length-1].id,o.getLastCoordinate(),r),t.sketch=null,t.measureTooltipElement=null,t.distanceTooltipElement=null,e.removeOverlay(t.distanceTooltip),Object(Vn["b"])(t.listenerChange),Object(Vn["b"])(t.listenerClick)}),this)},addInteraction:function(e){var t=[],n=rt({fill:{color:[142,77,209,.3]},stroke:{color:[142,77,209,.7],lineDash:[10,5],width:2},image:{circle:{radius:2,fill:{color:"white"},stroke:{width:2,color:"#005699"}}}});t.push(n),this.draw=new Xn["c"]({source:this.source,type:this.type,style:n}),e.addInteraction(this.draw),this.createHelpTooltip(e,"measure"),this.startDraw(e),this.endDraw(e)},delObj:function(e){for(var t=this,n=t.source.getFeatures(),r=n.length,i=r-1;i>=0;i--)n[i].get("id")==e&&t.source.removeFeature(n[i]);t.getMap().then((function(t){for(var n=t.getOverlays(),r=n.getLength(),i=r-1;i>=0;i--)n.item(i).get("name")==e&&n.removeAt(i)}))}},beforeDestroy:function(){var e=this,t=this;t.getMap().then((function(n){e.source.clear(),n.removeLayer(t.layer),t.draw&&n.removeInteraction(t.draw);for(var r=n.getOverlays(),i=r.getLength(),o=i-1;o>-1;o--)-1!=r.item(o).get("name").indexOf("measure")&&n.removeOverlay(r.item(o));n.getViewport().removeEventListener("mouseout",t.outEvent);var a=n.getTarget().id||"default";Wt.$off(a+".pointermove",t.listenerMove)}))}},kr=Or,jr=Object(j["a"])(kr,Pr,wr,!1,null,null,null),_r=jr.exports,Cr=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-plot",staticStyle:{display:"none"}},[e._t("default",[e.noEdit?e._e():[2==e.selectedFeature.layPosition.length?n("ol-overlay",{staticClass:"editLay",attrs:{position:e.selectedFeature.layPosition,projection:e.viewProjection,offset:e.layOffset}},[n("edit-overlay",{attrs:{type:e.selectedFeature.category,data:e.selectedFeature.data},on:{"change-stroke":e.refreshStroke,"change-line":e.refreshLine,"change-width":e.refreshWidth,"change-fill":e.refreshFill,delete:e.deleteFeature}})],1):e._e()]],{selectedFeature:e.selectedFeature})],2)},Er=[],Sr=r("768b"),Lr={MOUSEMOVE:"mousemove",MOUSEUP:"mouseup",MOUSEDOWN:"mousedown"},Ir=Lr,Mr=(r("2397"),r("d225")),xr=r("4e2b"),Tr=r("308d"),Ar=r("6bb5"),Rr=r("b0b4"),Fr=function(){function e(t,n){Object(Mr["a"])(this,e),this.type=t,this.target=n,this.currentTarget=this.target,this.propagationStopped_=!1,this.defaultPrevented=!1,this.returnValue_=!0}return Object(Rr["a"])(e,[{key:"stopPropagation",value:function(){this.propagationStopped_=!0}},{key:"preventDefault",value:function(){this.defaultPrevented=!0,this.returnValue_=!1}},{key:"stopPropagation",value:function(e){e.stopPropagation()}},{key:"preventDefault",value:function(e){e.preventDefault()}}]),e}();function Dr(e){return function(){var t,n=Object(Ar["a"])(e);if(Nr()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Nr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Gr=function(e){Object(xr["a"])(n,e);var t=Dr(n);function n(e,r){var i;return Object(Mr["a"])(this,n),i=t.call(this,e),i.feature=r,i}return n}(Fr);Gr.DRAW_START="draw_start",Gr.DRAW_END="draw_end";var Vr=Gr;function $r(e){return function(){var t,n=Object(Ar["a"])(e);if(zr()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function zr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Hr=function(e){Object(xr["a"])(n,e);var t=$r(n);function n(e,r){var i;return Object(Mr["a"])(this,n),i=t.call(this,e),i.feature=r,i}return n}(Fr);Hr.EDIT_START="edit_start",Hr.EDIT_MOVE="edit_move",Hr.EDIT_END="edit_end";var Br=Hr,Ur=r("013f");function Wr(e){return function(){var t,n=Object(Ar["a"])(e);if(Kr()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Kr(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Yr=function(e){return function(e){Object(xr["a"])(n,e);var t=Wr(n);function n(e){var r;return Object(Mr["a"])(this,n),r=t.call(this,e),r.setPoints(e),r}return Object(Rr["a"])(n,[{key:"isPlot",value:function(){return!0}},{key:"setPoints",value:function(e){this.points=e||[],this.points.length>=1&&this.generate()}},{key:"getPoints",value:function(){return this.points.slice(0)}},{key:"getPointCount",value:function(){return this.points.length}},{key:"updatePoint",value:function(e,t){t>=0&&t<this.points.length&&(this.points[t]=e,this.generate())}},{key:"updateLastPoint",value:function(e){this.updatePoint(e,this.points.length-1)}},{key:"generate",value:function(){}},{key:"finishDrawing",value:function(){}}]),n}(e)},qr=Yr,Zr={ARC:"Arc",ELLIPSE:"Ellipse",CURVE:"Curve",CLOSED_CURVE:"ClosedCurve",LUNE:"Lune",SECTOR:"Sector",GATHERING_PLACE:"GatheringPlace",STRAIGHT_ARROW:"StraightArrow",ASSAULT_DIRECTION:"AssaultDirection",ATTACK_ARROW:"AttackArrow",TAILED_ATTACK_ARROW:"TailedAttackArrow",SQUAD_COMBAT:"SquadCombat",TAILED_SQUAD_COMBAT:"TailedSquadCombat",FINE_ARROW:"FineArrow",CIRCLE:"Circle",DOUBLE_ARROW:"DoubleArrow",POLYLINE:"Polyline",FREEHAND_LINE:"FreehandLine",POLYGON:"Polygon",FREEHAND_POLYGON:"FreehandPolygon",RECTANGLE:"Rectangle",MARKER:"Marker",TRIANGLE:"Triangle"},Jr=Zr,Qr={distance:function(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))},wholeDistance:function(e){for(var t=0,n=0;n<e.length-1;n++)t+=Qr.distance(e[n],e[n+1]);return t},getBaseLength:function(e){return Math.pow(Qr.wholeDistance(e),.99)},mid:function(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]},getCircleCenterOfThreePoints:function(e,t,n){var r=[(e[0]+t[0])/2,(e[1]+t[1])/2],i=[r[0]-e[1]+t[1],r[1]+e[0]-t[0]],o=[(e[0]+n[0])/2,(e[1]+n[1])/2],a=[o[0]-e[1]+n[1],o[1]+e[0]-n[0]];return Qr.getIntersectPoint(r,i,o,a)},getIntersectPoint:function(e,t,n,r){var i,o,a,s;return e[1]==t[1]?(i=(r[0]-n[0])/(r[1]-n[1]),o=i*(e[1]-n[1])+n[0],a=e[1],[o,a]):n[1]==r[1]?(s=(t[0]-e[0])/(t[1]-e[1]),o=s*(n[1]-e[1])+e[0],a=n[1],[o,a]):(s=(t[0]-e[0])/(t[1]-e[1]),i=(r[0]-n[0])/(r[1]-n[1]),a=(s*e[1]-e[0]-i*n[1]+n[0])/(s-i),o=s*a-s*e[1]+e[0],[o,a])},getAzimuth:function(e,t){var n,r=Math.asin(Math.abs(t[1]-e[1])/Qr.distance(e,t));return t[1]>=e[1]&&t[0]>=e[0]?n=r+Math.PI:t[1]>=e[1]&&t[0]<e[0]?n=Ge.TWO_PI-r:t[1]<e[1]&&t[0]<e[0]?n=r:t[1]<e[1]&&t[0]>=e[0]&&(n=Math.PI-r),n},getAngleOfThreePoints:function(e,t,n){var r=Qr.getAzimuth(t,e)-Qr.getAzimuth(t,n);return r<0?r+Ge.TWO_PI:r},isClockWise:function(e,t,n){return(n[1]-e[1])*(t[0]-e[0])>(t[1]-e[1])*(n[0]-e[0])},getPointOnLine:function(e,t,n){var r=t[0]+e*(n[0]-t[0]),i=t[1]+e*(n[1]-t[1]);return[r,i]},getCubicValue:function(e,t,n,r,i){e=Math.max(Math.min(e,1),0);var o=1-e,a=e*e,s=a*e,l=o*o,c=l*o,u=c*t[0]+3*l*e*n[0]+3*o*a*r[0]+s*i[0],h=c*t[1]+3*l*e*n[1]+3*o*a*r[1]+s*i[1];return[u,h]},getThirdPoint:function(e,t,n,r,i){var o=Qr.getAzimuth(e,t),a=i?o+n:o-n,s=r*Math.cos(a),l=r*Math.sin(a);return[t[0]+s,t[1]+l]},getArcPoints:function(e,t,n,r){var i,o,a=[],s=r-n;s=s<0?s+Ge.TWO_PI:s;for(var l=0;l<=Ge.FITTING_COUNT;l++){var c=n+s*l/Ge.FITTING_COUNT;i=e[0]+t*Math.cos(c),o=e[1]+t*Math.sin(c),a.push([i,o])}return a},getBisectorNormals:function(e,t,n,r){var i,o,a,s,l,c=Qr.getNormal(t,n,r),u=Math.sqrt(c[0]*c[0]+c[1]*c[1]),h=c[0]/u,d=c[1]/u,f=Qr.distance(t,n),p=Qr.distance(n,r);return u>Ge.ZERO_TOLERANCE?Qr.isClockWise(t,n,r)?(i=e*f,o=n[0]-i*d,a=n[1]+i*h,s=[o,a],i=e*p,o=n[0]+i*d,a=n[1]-i*h,l=[o,a]):(i=e*f,o=n[0]+i*d,a=n[1]-i*h,s=[o,a],i=e*p,o=n[0]-i*d,a=n[1]+i*h,l=[o,a]):(o=n[0]+e*(t[0]-n[0]),a=n[1]+e*(t[1]-n[1]),s=[o,a],o=n[0]+e*(r[0]-n[0]),a=n[1]+e*(r[1]-n[1]),l=[o,a]),[s,l]},getNormal:function(e,t,n){var r=e[0]-t[0],i=e[1]-t[1],o=Math.sqrt(r*r+i*i);r/=o,i/=o;var a=n[0]-t[0],s=n[1]-t[1],l=Math.sqrt(a*a+s*s);a/=l,s/=l;var c=r+a,u=i+s;return[c,u]},getCurvePoints:function(e,t){for(var n,r,i,o,a=Qr.getLeftMostControlPoint(t),s=[a],l=0;l<t.length-2;l++)n=t[l],r=t[l+1],i=t[l+2],o=Qr.getBisectorNormals(e,n,r,i),s=s.concat(o);var c=Qr.getRightMostControlPoint(t);s.push(c);for(var u=[],h=0;h<t.length-1;h++){n=t[h],r=t[h+1],u.push(n);for(var d=0;d<Ge.FITTING_COUNT;d++){var f=Qr.getCubicValue(d/Ge.FITTING_COUNT,n,s[2*h],s[2*h+1],r);u.push(f)}u.push(r)}return u},getLeftMostControlPoint:function(e){var n,r,i=e[0],o=e[1],a=e[2],s=Qr.getBisectorNormals(0,i,o,a),l=s[0],c=Qr.getNormal(i,o,a),u=Math.sqrt(c[0]*c[0]+c[1]*c[1]);if(u>Ge.ZERO_TOLERANCE){var h=Qr.mid(i,o),d=i[0]-h[0],f=i[1]-h[1],p=Qr.distance(i,o),v=2/p,m=-v*f,g=v*d,y=m*m-g*g,b=2*m*g,P=g*g-m*m,w=l[0]-h[0],O=l[1]-h[1];n=h[0]+y*w+b*O,r=h[1]+b*w+P*O}else n=i[0]+t*(o[0]-i[0]),r=i[1]+t*(o[1]-i[1]);return[n,r]},getRightMostControlPoint:function(e){var n,r,i=e.length,o=e[i-3],a=e[i-2],s=e[i-1],l=Qr.getBisectorNormals(0,o,a,s),c=l[1],u=Qr.getNormal(o,a,s),h=Math.sqrt(u[0]*u[0]+u[1]*u[1]);if(h>Ge.ZERO_TOLERANCE){var d=Qr.mid(a,s),f=s[0]-d[0],p=s[1]-d[1],v=Qr.distance(a,s),m=2/v,g=-m*p,y=m*f,b=g*g-y*y,P=2*g*y,w=y*y-g*g,O=c[0]-d[0],k=c[1]-d[1];n=d[0]+b*O+P*k,r=d[1]+P*O+w*k}else n=s[0]+t*(a[0]-s[0]),r=s[1]+t*(a[1]-s[1]);return[n,r]},getBezierPoints:function(e){if(e.length<=2)return e;for(var t=[],n=e.length-1,r=0;r<=1;r+=.01){for(var i=0,o=0,a=0;a<=n;a++){var s=Qr.getBinomialFactor(n,a),l=Math.pow(r,a),c=Math.pow(1-r,n-a);i+=s*l*c*e[a][0],o+=s*l*c*e[a][1]}t.push([i,o])}return t.push(e[n]),t},getBinomialFactor:function(e,t){return Qr.getFactorial(e)/(Qr.getFactorial(t)*Qr.getFactorial(e-t))},getFactorial:function(e){if(e<=1)return 1;if(2==e)return 2;if(3==e)return 6;if(4==e)return 24;if(5==e)return 120;for(var t=1,n=1;n<=e;n++)t*=n;return t},getQBSplinePoints:function(e){if(e.length<=2)return e;var t=2,n=[],r=e.length-t-1;n.push(e[0]);for(var i=0;i<=r;i++)for(var o=0;o<=1;o+=.05){for(var a=0,s=0,l=0;l<=t;l++){var c=Qr.getQuadricBSplineFactor(l,o);a+=c*e[i+l][0],s+=c*e[i+l][1]}n.push([a,s])}return n.push(e[e.length-1]),n},getQuadricBSplineFactor:function(e,t){return 0==e?Math.pow(t-1,2)/2:1==e?(-2*Math.pow(t,2)+2*t+1)/2:2==e?Math.pow(t,2)/2:0},mixin:function(e,t){for(var n in t)e[n]=t[n]}},Xr=Qr;function ei(e){return function(){var t,n=Object(Ar["a"])(e);if(ti()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function ti(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ni=function(e){Object(xr["a"])(n,e);var t=ei(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.ARC,e.fixPointCount=3,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();if(!(e<2))if(2==e)this.setCoordinates(this.points);else{var t,n,r=this.points[0],i=this.points[1],o=this.points[2],a=Xr.getCircleCenterOfThreePoints(r,i,o),s=Xr.distance(r,a),l=Xr.getAzimuth(r,a),c=Xr.getAzimuth(i,a);Xr.isClockWise(r,i,o)?(t=c,n=l):(t=l,n=c),this.setCoordinates(Xr.getArcPoints(a,s,t,n))}}}]),n}(qr(fe["a"]));function ri(e){return function(){var t,n=Object(Ar["a"])(e);if(ii()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function ii(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var oi=function(e){Object(xr["a"])(n,e);var t=ri(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.ELLIPSE,e.fixPointCount=2,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();if(!(e<2)){var t=this.points[0],n=this.points[1],r=Xr.mid(t,n),i=Math.abs((t[0]-n[0])/2),o=Math.abs((t[1]-n[1])/2);this.setCoordinates([this.generatePoints(r,i,o)])}}},{key:"generatePoints",value:function(e,t,n){for(var r,i,o,a=[],s=0;s<=Ge.FITTING_COUNT;s++)o=2*Math.PI*s/Ge.FITTING_COUNT,r=e[0]+t*Math.cos(o),i=e[1]+n*Math.sin(o),a.push([r,i]);return a}}]),n}(qr(he["a"]));function ai(e){return function(){var t,n=Object(Ar["a"])(e);if(si()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function si(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var li=function(e){Object(xr["a"])(n,e);var t=ai(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.CURVE,e.t=.3,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();e<2||(2==e?this.setCoordinates(this.points):this.setCoordinates(Xr.getCurvePoints(this.t,this.points)))}}]),n}(qr(fe["a"]));function ci(e){return function(){var t,n=Object(Ar["a"])(e);if(ui()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function ui(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var hi=function(e){Object(xr["a"])(n,e);var t=ci(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.CLOSED_CURVE,e.t=.3,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();if(!(e<2))if(2==e)this.setCoordinates([this.points]);else{var t=this.getPoints();t.push(t[0],t[1]);for(var n=[],r=0;r<t.length-2;r++){var i=Xr.getBisectorNormals(this.t,t[r],t[r+1],t[r+2]);n=n.concat(i)}var o=n.length;n=[n[o-1]].concat(n.slice(0,o-1));for(var a=[],s=0;s<t.length-2;s++){var l=t[s],c=t[s+1];a.push(l);for(var u=0;u<=Ge.FITTING_COUNT;u++){var h=Xr.getCubicValue(u/Ge.FITTING_COUNT,l,n[2*s],n[2*s+1],c);a.push(h)}a.push(c)}this.setCoordinates([a])}}}]),n}(qr(he["a"]));function di(e){return function(){var t,n=Object(Ar["a"])(e);if(fi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function fi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var pi=function(e){Object(xr["a"])(n,e);var t=di(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.LUNE,e.fixPointCount=3,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){if(!(this.getPointCount()<2)){var e=this.getPoints();if(2==this.getPointCount()){var t=Xr.mid(e[0],e[1]),n=Xr.distance(e[0],t),r=Xr.getThirdPoint(e[0],t,Ge.HALF_PI,n);e.push(r)}var i,o,a=e[0],s=e[1],l=e[2],c=Xr.getCircleCenterOfThreePoints(a,s,l),u=Xr.distance(a,c),h=Xr.getAzimuth(a,c),d=Xr.getAzimuth(s,c);Xr.isClockWise(a,s,l)?(i=d,o=h):(i=h,o=d),e=Xr.getArcPoints(c,u,i,o),e.push(e[0]),this.setCoordinates([e])}}}]),n}(qr(he["a"]));function vi(e){return function(){var t,n=Object(Ar["a"])(e);if(mi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function mi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var gi=function(e){Object(xr["a"])(n,e);var t=vi(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.SECTOR,e.fixPointCount=3,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){if(!(this.getPointCount()<2))if(2==this.getPointCount())this.setCoordinates([this.points]);else{var e=this.getPoints(),t=e[0],n=e[1],r=e[2],i=Xr.distance(n,t),o=Xr.getAzimuth(n,t),a=Xr.getAzimuth(r,t),s=Xr.getArcPoints(t,i,o,a);s.push(t,s[0]),this.setCoordinates([s])}}}]),n}(qr(he["a"]));function yi(e){return function(){var t,n=Object(Ar["a"])(e);if(bi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function bi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Pi=function(e){Object(xr["a"])(n,e);var t=yi(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.GATHERING_PLACE,e.t=.4,e.fixPointCount=3,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPoints();if(!(e.length<2)){if(2==this.getPointCount()){var t=Xr.mid(e[0],e[1]),n=Xr.distance(e[0],t)/.9,r=Xr.getThirdPoint(e[0],t,Ge.HALF_PI,n,!0);e=[e[0],r,e[1]]}var i=Xr.mid(e[0],e[2]);e.push(i,e[0],e[1]);for(var o=[],a=0;a<e.length-2;a++){var s=e[a],l=e[a+1],c=e[a+2],u=Xr.getBisectorNormals(this.t,s,l,c);o=o.concat(u)}var h=o.length;o=[o[h-1]].concat(o.slice(0,h-1));for(var d=[],f=0;f<e.length-2;f++){var p=e[f],v=e[f+1];d.push(p);for(var m=0;m<=Ge.FITTING_COUNT;m++){var g=Xr.getCubicValue(m/Ge.FITTING_COUNT,p,o[2*f],o[2*f+1],v);d.push(g)}d.push(v)}this.setCoordinates([d])}}}]),n}(qr(he["a"]));function wi(e){return function(){var t,n=Object(Ar["a"])(e);if(Oi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Oi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ki=function(e){Object(xr["a"])(n,e);var t=wi(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.STRAIGHT_ARROW,e.fixPointCount=2,e.maxArrowLength=3e6,e.arrowLengthScale=5,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){if(!(this.getPointCount()<2)){var e=this.getPoints(),t=e[0],n=e[1],r=Xr.distance(t,n),i=r/this.arrowLengthScale;i=i>this.maxArrowLength?this.maxArrowLength:i;var o=Xr.getThirdPoint(t,n,Math.PI/6,i,!1),a=Xr.getThirdPoint(t,n,Math.PI/6,i,!0);this.setCoordinates([t,n,o,n,a])}}}]),n}(qr(fe["a"]));function ji(e){return function(){var t,n=Object(Ar["a"])(e);if(_i()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function _i(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ci=function(e){Object(xr["a"])(n,e);var t=ji(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.FINE_ARROW,e.tailWidthFactor=.15,e.neckWidthFactor=.2,e.headWidthFactor=.25,e.headAngle=Math.PI/8.5,e.neckAngle=Math.PI/13,e.fixPointCount=2,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();if(!(e<2)){var t=this.getPoints(),n=t[0],r=t[1],i=Xr.getBaseLength(t),o=i*this.tailWidthFactor,a=i*this.neckWidthFactor,s=i*this.headWidthFactor,l=Xr.getThirdPoint(r,n,Ge.HALF_PI,o,!0),c=Xr.getThirdPoint(r,n,Ge.HALF_PI,o,!1),u=Xr.getThirdPoint(n,r,this.headAngle,s,!1),h=Xr.getThirdPoint(n,r,this.headAngle,s,!0),d=Xr.getThirdPoint(n,r,this.neckAngle,a,!1),f=Xr.getThirdPoint(n,r,this.neckAngle,a,!0),p=[l,d,u,r,h,f,c];this.setCoordinates([p])}}}]),n}(qr(he["a"]));function Ei(e){return function(){var t,n=Object(Ar["a"])(e);if(Si()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Si(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Li=function(e){Object(xr["a"])(n,e);var t=Ei(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.ASSAULT_DIRECTION,e.tailWidthFactor=.2,e.neckWidthFactor=.25,e.headWidthFactor=.3,e.headAngle=Math.PI/4,e.neckAngle=.17741*Math.PI,e.setPoints(r),e}return n}(Ci);function Ii(e){return function(){var t,n=Object(Ar["a"])(e);if(Mi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Mi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var xi=function(e){Object(xr["a"])(n,e);var t=Ii(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.ATTACK_ARROW,e.headHeightFactor=.18,e.headWidthFactor=.3,e.neckHeightFactor=.85,e.neckWidthFactor=.15,e.headTailFactor=.8,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){if(!(this.getPointCount()<2))if(2!=this.getPointCount()){var e=this.getPoints(),t=e[0],n=e[1];Xr.isClockWise(e[0],e[1],e[2])&&(t=e[1],n=e[0]);var r=Xr.mid(t,n),i=[r].concat(e.slice(2)),o=this.getArrowHeadPoints(i,t,n),a=o[0],s=o[4],l=Xr.distance(t,n)/Xr.getBaseLength(i),c=this.getArrowBodyPoints(i,a,s,l),u=c.length,h=[t].concat(c.slice(0,u/2));h.push(a);var d=[n].concat(c.slice(u/2,u));d.push(s),h=Xr.getQBSplinePoints(h),d=Xr.getQBSplinePoints(d),this.setCoordinates([h.concat(o,d.reverse())])}else this.setCoordinates([this.points])}},{key:"getArrowHeadPoints",value:function(e,t,n){var r=Xr.getBaseLength(e),i=r*this.headHeightFactor,o=e[e.length-1];r=Xr.distance(o,e[e.length-2]);var a=Xr.distance(t,n);i>a*this.headTailFactor&&(i=a*this.headTailFactor);var s=i*this.headWidthFactor,l=i*this.neckWidthFactor;i=i>r?r:i;var c=i*this.neckHeightFactor,u=Xr.getThirdPoint(e[e.length-2],o,0,i,!0),h=Xr.getThirdPoint(e[e.length-2],o,0,c,!0),d=Xr.getThirdPoint(o,u,Ge.HALF_PI,s,!1),f=Xr.getThirdPoint(o,u,Ge.HALF_PI,s,!0),p=Xr.getThirdPoint(o,h,Ge.HALF_PI,l,!1),v=Xr.getThirdPoint(o,h,Ge.HALF_PI,l,!0);return[p,d,o,f,v]}},{key:"getArrowBodyPoints",value:function(e,t,n,r){for(var i=Xr.wholeDistance(e),o=Xr.getBaseLength(e),a=o*r,s=Xr.distance(t,n),l=(a-s)/2,c=0,u=[],h=[],d=1;d<e.length-1;d++){var f=Xr.getAngleOfThreePoints(e[d-1],e[d],e[d+1])/2;c+=Xr.distance(e[d-1],e[d]);var p=(a/2-c/i*l)/Math.sin(f),v=Xr.getThirdPoint(e[d-1],e[d],Math.PI-f,p,!0),m=Xr.getThirdPoint(e[d-1],e[d],f,p,!1);u.push(v),h.push(m)}return u.concat(h)}}]),n}(qr(he["a"]));function Ti(e){return function(){var t,n=Object(Ar["a"])(e);if(Ai()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Ai(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ri=function(e){Object(xr["a"])(n,e);var t=Ti(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.CIRCLE,e.fixPointCount=2,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();if(!(e<2)){var t=this.points[0],n=Xr.distance(t,this.points[1]);this.setCoordinates([this.generatePoints(t,n)])}}},{key:"generatePoints",value:function(e,t){for(var n,r,i,o=[],a=0;a<=Ge.FITTING_COUNT;a++)i=2*Math.PI*a/Ge.FITTING_COUNT,n=e[0]+t*Math.cos(i),r=e[1]+t*Math.sin(i),o.push([n,r]);return o}}]),n}(qr(he["a"]));function Fi(e){return function(){var t,n=Object(Ar["a"])(e);if(Di()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Di(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ni=function(e){Object(xr["a"])(n,e);var t=Fi(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.DOUBLE_ARROW,e.headHeightFactor=.25,e.headWidthFactor=.3,e.neckHeightFactor=.85,e.neckWidthFactor=.15,e.connPoint=null,e.tempPoint4=null,e.fixPointCount=4,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"finishDrawing",value:function(){3==this.getPointCount()&&null!=this.tempPoint4&&this.points.push(this.tempPoint4),null!=this.connPoint&&this.points.push(this.connPoint)}},{key:"generate",value:function(){var e=this.getPointCount();if(!(e<2))if(2!=e){var t,n,r=this.points[0],i=this.points[1],o=this.points[2];this.tempPoint4=3==e?this.getTempPoint4(r,i,o):this.points[3],this.connPoint=3==e||4==e?Xr.mid(r,i):this.points[4],Xr.isClockWise(r,i,o)?(t=this.getArrowPoints(r,this.connPoint,this.tempPoint4,!1),n=this.getArrowPoints(this.connPoint,i,o,!0)):(t=this.getArrowPoints(i,this.connPoint,o,!1),n=this.getArrowPoints(this.connPoint,r,this.tempPoint4,!0));var a=t.length,s=(a-5)/2,l=t.slice(0,s),c=t.slice(s,s+5),u=t.slice(s+5,a),h=n.slice(0,s),d=n.slice(s,s+5),f=n.slice(s+5,a);h=Xr.getBezierPoints(h);var p=Xr.getBezierPoints(f.concat(l.slice(1)));u=Xr.getBezierPoints(u);var v=h.concat(d,p,c,u);this.setCoordinates([v])}else this.setCoordinates([this.points])}},{key:"getArrowPoints",value:function(e,t,n,r){var i=Xr.mid(e,t),o=Xr.distance(i,n),a=Xr.getThirdPoint(n,i,0,.3*o,!0),s=Xr.getThirdPoint(n,i,0,.5*o,!0);a=Xr.getThirdPoint(i,a,Ge.HALF_PI,o/5,r),s=Xr.getThirdPoint(i,s,Ge.HALF_PI,o/4,r);var l=[i,a,s,n],c=this.getArrowHeadPoints(l,this.headHeightFactor,this.headWidthFactor,this.neckHeightFactor,this.neckWidthFactor),u=c[0],h=c[4],d=Xr.distance(e,t)/Xr.getBaseLength(l)/2,f=this.getArrowBodyPoints(l,u,h,d),p=f.length,v=f.slice(0,p/2),m=f.slice(p/2,p);return v.push(u),m.push(h),v=v.reverse(),v.push(t),m=m.reverse(),m.push(e),v.reverse().concat(c,m)}},{key:"getArrowHeadPoints",value:function(e,t,n){var r=Xr.getBaseLength(e),i=r*this.headHeightFactor,o=e[e.length-1],a=(Xr.distance(t,n),i*this.headWidthFactor),s=i*this.neckWidthFactor,l=i*this.neckHeightFactor,c=Xr.getThirdPoint(e[e.length-2],o,0,i,!0),u=Xr.getThirdPoint(e[e.length-2],o,0,l,!0),h=Xr.getThirdPoint(o,c,Ge.HALF_PI,a,!1),d=Xr.getThirdPoint(o,c,Ge.HALF_PI,a,!0),f=Xr.getThirdPoint(o,u,Ge.HALF_PI,s,!1),p=Xr.getThirdPoint(o,u,Ge.HALF_PI,s,!0);return[f,h,o,d,p]}},{key:"getArrowBodyPoints",value:function(e,t,n,r){for(var i=Xr.wholeDistance(e),o=Xr.getBaseLength(e),a=o*r,s=Xr.distance(t,n),l=(a-s)/2,c=0,u=[],h=[],d=1;d<e.length-1;d++){var f=Xr.getAngleOfThreePoints(e[d-1],e[d],e[d+1])/2;c+=Xr.distance(e[d-1],e[d]);var p=(a/2-c/i*l)/Math.sin(f),v=Xr.getThirdPoint(e[d-1],e[d],Math.PI-f,p,!0),m=Xr.getThirdPoint(e[d-1],e[d],f,p,!1);u.push(v),h.push(m)}return u.concat(h)}},{key:"getTempPoint4",value:function(e,t,n){var r,i,o,a,s=Xr.mid(e,t),l=Xr.distance(s,n),c=Xr.getAngleOfThreePoints(e,s,n);return c<Ge.HALF_PI?(i=l*Math.sin(c),o=l*Math.cos(c),a=Xr.getThirdPoint(e,s,Ge.HALF_PI,i,!1),r=Xr.getThirdPoint(s,a,Ge.HALF_PI,o,!0)):c>=Ge.HALF_PI&&c<Math.PI?(i=l*Math.sin(Math.PI-c),o=l*Math.cos(Math.PI-c),a=Xr.getThirdPoint(e,s,Ge.HALF_PI,i,!1),r=Xr.getThirdPoint(s,a,Ge.HALF_PI,o,!1)):c>=Math.PI&&c<1.5*Math.PI?(i=l*Math.sin(c-Math.PI),o=l*Math.cos(c-Math.PI),a=Xr.getThirdPoint(e,s,Ge.HALF_PI,i,!0),r=Xr.getThirdPoint(s,a,Ge.HALF_PI,o,!0)):(i=l*Math.sin(2*Math.PI-c),o=l*Math.cos(2*Math.PI-c),a=Xr.getThirdPoint(e,s,Ge.HALF_PI,i,!0),r=Xr.getThirdPoint(s,a,Ge.HALF_PI,o,!1)),r}}]),n}(qr(he["a"]));function Gi(e){return function(){var t,n=Object(Ar["a"])(e);if(Vi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Vi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var $i=function(e){Object(xr["a"])(n,e);var t=Gi(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.TAILED_ATTACK_ARROW,e.headHeightFactor=.18,e.headWidthFactor=.3,e.neckHeightFactor=.85,e.neckWidthFactor=.15,e.tailWidthFactor=.1,e.headTailFactor=.8,e.swallowTailFactor=1,e.swallowTailPnt=null,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){if("TailedAttackArrow"==this.type){var e=this.getPointCount();if(!(e<2))if(2!=this.getPointCount()){var t=this.getPoints(),n=t[0],r=t[1];Xr.isClockWise(t[0],t[1],t[2])&&(n=t[1],r=t[0]);var i=Xr.mid(n,r),o=[i].concat(t.slice(2)),a=this.getArrowHeadPoints(o,n,r),s=a[0],l=a[4],c=Xr.distance(n,r),u=Xr.getBaseLength(o),h=u*this.tailWidthFactor*this.swallowTailFactor;this.swallowTailPnt=Xr.getThirdPoint(o[1],o[0],0,h,!0);var d=c/u,f=this.getArrowBodyPoints(o,s,l,d);e=f.length;var p=[n].concat(f.slice(0,e/2));p.push(s);var v=[r].concat(f.slice(e/2,e));v.push(l),p=Xr.getQBSplinePoints(p),v=Xr.getQBSplinePoints(v),this.setCoordinates([p.concat(a,v.reverse(),[this.swallowTailPnt,p[0]])])}else this.setCoordinates([this.points])}}}]),n}(xi);function zi(e){return function(){var t,n=Object(Ar["a"])(e);if(Hi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Hi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Bi=function(e){Object(xr["a"])(n,e);var t=zi(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.SQUAD_COMBAT,e.headHeightFactor=.18,e.headWidthFactor=.3,e.neckHeightFactor=.85,e.neckWidthFactor=.15,e.tailWidthFactor=.1,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){if("SquadCombat"==this.type){var e=this.getPointCount();if(!(e<2)){var t=this.getPoints(),n=this.getTailPoints(t),r=this.getArrowHeadPoints(t,n[0],n[1]),i=r[0],o=r[4],a=this.getArrowBodyPoints(t,i,o,this.tailWidthFactor);e=a.length;var s=[n[0]].concat(a.slice(0,e/2));s.push(i);var l=[n[1]].concat(a.slice(e/2,e));l.push(o),s=Xr.getQBSplinePoints(s),l=Xr.getQBSplinePoints(l),this.setCoordinates([s.concat(r,l.reverse())])}}}},{key:"getTailPoints",value:function(e){var t=Xr.getBaseLength(e),n=t*this.tailWidthFactor,r=Xr.getThirdPoint(e[1],e[0],Ge.HALF_PI,n,!1),i=Xr.getThirdPoint(e[1],e[0],Ge.HALF_PI,n,!0);return[r,i]}}]),n}(xi);function Ui(e){return function(){var t,n=Object(Ar["a"])(e);if(Wi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Wi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Ki=function(e){Object(xr["a"])(n,e);var t=Ui(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.TAILED_SQUAD_COMBAT,e.headHeightFactor=.18,e.headWidthFactor=.3,e.neckHeightFactor=.85,e.neckWidthFactor=.15,e.tailWidthFactor=.1,e.swallowTailFactor=1,e.swallowTailPnt=null,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){if("TailedSquadCombat"==this.type){var e=this.getPointCount();if(!(e<2)){var t=this.getPoints(),n=this.getTailPoints(t),r=this.getArrowHeadPoints(t,n[0],n[2]),i=r[0],o=r[4],a=this.getArrowBodyPoints(t,i,o,this.tailWidthFactor);e=a.length;var s=[n[0]].concat(a.slice(0,e/2));s.push(i);var l=[n[2]].concat(a.slice(e/2,e));l.push(o),s=Xr.getQBSplinePoints(s),l=Xr.getQBSplinePoints(l),this.setCoordinates([s.concat(r,l.reverse(),[n[1],s[0]])])}}}},{key:"getTailPoints",value:function(e){var t=Xr.getBaseLength(e),n=t*this.tailWidthFactor,r=Xr.getThirdPoint(e[1],e[0],Ge.HALF_PI,n,!1),i=Xr.getThirdPoint(e[1],e[0],Ge.HALF_PI,n,!0),o=n*this.swallowTailFactor,a=Xr.getThirdPoint(e[1],e[0],0,o,!0);return[r,a,i]}}]),n}(xi);function Yi(e){return function(){var t,n=Object(Ar["a"])(e);if(qi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function qi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Zi=function(e){Object(xr["a"])(n,e);var t=Yi(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.FREEHAND_LINE,e.freehand=!0,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();e<2||this.setCoordinates(this.points)}}]),n}(qr(fe["a"]));function Ji(e){return function(){var t,n=Object(Ar["a"])(e);if(Qi()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function Qi(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var Xi=function(e){Object(xr["a"])(n,e);var t=Ji(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.FREEHAND_POLYGON,e.freehand=!0,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();e<2||this.setCoordinates([this.points])}}]),n}(qr(he["a"]));function eo(e){return function(){var t,n=Object(Ar["a"])(e);if(to()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function to(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var no=function(e){Object(xr["a"])(n,e);var t=eo(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.POLYGON,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();e<2||this.setCoordinates([this.points])}}]),n}(qr(he["a"]));function ro(e){return function(){var t,n=Object(Ar["a"])(e);if(io()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function io(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var oo=function(e){Object(xr["a"])(n,e);var t=ro(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.MARKER,e.fixPointCount=1,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.points[0];this.setCoordinates(e)}}]),n}(qr(ve["a"]));function ao(e){return function(){var t,n=Object(Ar["a"])(e);if(so()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function so(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var lo=function(e){Object(xr["a"])(n,e);var t=ao(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.RECTANGLE,e.fixPointCount=2,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();if(!(e<2)){var t=this.points[0],n=this.points[1],r=Math.min(t[0],n[0]),i=Math.max(t[0],n[0]),o=Math.min(t[1],n[1]),a=Math.max(t[1],n[1]),s=[r,a],l=[i,a],c=[i,o],u=[r,o];this.setCoordinates([[s,l,c,u]])}}}]),n}(qr(he["a"]));function co(e){return function(){var t,n=Object(Ar["a"])(e);if(uo()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function uo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var ho=function(e){Object(xr["a"])(n,e);var t=co(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(Mr["a"])(this,n),e=t.call(this,r),e.type=Jr.POLYLINE,e.setPoints(r),e}return Object(Rr["a"])(n,[{key:"generate",value:function(){var e=this.getPointCount();e<2||this.setCoordinates(this.points)}}]),n}(qr(fe["a"])),fo={createPlot:function(e,t){return e&&f[e]?new f[e](t):null}},po=fo;function vo(e){return function(){var t,n=Object(Ar["a"])(e);if(mo()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function mo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var go=function(e){Object(xr["a"])(n,e);var t=vo(n);function n(e,r){var i;if(Object(Mr["a"])(this,n),i=t.call(this),i.points=null,i.plot=null,i.feature=null,i.plotType=null,i.plotParams=null,i.mapViewport=null,i.dblClickZoomInteraction=null,i.clickListener=null,i.dblclickListener=null,i.moveCallback=i.mapMouseMoveHandler.bind(Object(Ur["a"])(i)),r)i.style=r;else{var o=new ie["a"]({color:"#000000",width:1.25}),a=new re["a"]({color:"rgba(0,0,0,0.4)"});i.style=new ne["c"]({fill:a,stroke:o})}return i.featureSource=new ee["a"],i.drawOverlay=new X["a"]({source:i.featureSource}),i.drawOverlay.setStyle(i.style),i.setMap(e),i}return Object(Rr["a"])(n,[{key:"activate",value:function(e,t){this.deactivate(),this.deactivateMapTools(),this.clickListener=this.map.on("click",this.mapFirstClickHandler.bind(this)),this.plotType=e,this.plotParams=t,t.style&&this.drawOverlay.setStyle(t.style),this.map.addLayer(this.drawOverlay)}},{key:"deactivate",value:function(){this.disconnectEventHandlers(),this.map.removeLayer(this.drawOverlay),this.featureSource.clear(),this.points=[],this.plot=null,this.feature=null,this.plotType=null,this.plotParams=null,this.activateMapTools()}},{key:"isDrawing",value:function(){return null!=this.plotType}},{key:"setMap",value:function(e){this.map=e,this.mapViewport=this.map.getViewport()}},{key:"mapFirstClickHandler",value:function(e){this.points.push(e.coordinate),this.plot=po.createPlot(this.plotType,this.points,this.plotParams),this.feature=new te["a"](this.plot),this.feature.getGeometry().set("altitudeMode","clampToGround"),this.featureSource.addFeature(this.feature),Object(Vn["b"])(this.clickListener),this.plot.fixPointCount!=this.plot.getPointCount()?(this.clickListener=this.map.on("click",this.mapNextClickHandler.bind(this)),this.plot.freehand||(this.dblclickListener=this.map.on("dblclick",this.mapDoubleClickHandler.bind(this))),this.mapViewport.addEventListener(Ir.MOUSEMOVE,this.moveCallback,!1)):this.mapDoubleClickHandler(e)}},{key:"mapMouseMoveHandler",value:function(e){var t=this.map.getCoordinateFromPixel([e.offsetX,e.offsetY]);if(!(Xr.distance(t,this.points[this.points.length-1])<Ge.ZERO_TOLERANCE))if(this.plot.freehand)this.points.push(t),this.plot.setPoints(this.points);else{var n=this.points.concat([t]);this.plot.setPoints(n)}}},{key:"mapNextClickHandler",value:function(e){!this.plot.freehand&&Xr.distance(e.coordinate,this.points[this.points.length-1])<Ge.ZERO_TOLERANCE||(this.points.push(e.coordinate),this.plot.setPoints(this.points),this.plot.fixPointCount!=this.plot.getPointCount()?this.plot&&this.plot.freehand&&this.mapDoubleClickHandler(e):this.mapDoubleClickHandler(e))}},{key:"mapDoubleClickHandler",value:function(e){this.disconnectEventHandlers(),this.plot.finishDrawing(),e.preventDefault(),this.drawEnd()}},{key:"disconnectEventHandlers",value:function(){Object(Vn["b"])(this.clickListener),this.mapViewport.removeEventListener(Ir.MOUSEMOVE,this.moveCallback,!1),Object(Vn["b"])(this.dblclickListener)}},{key:"drawEnd",value:function(e){this.featureSource.removeFeature(this.feature),this.activateMapTools(),this.disconnectEventHandlers(),this.map.removeOverlay(this.drawOverlay),this.points=[],this.plot=null,this.plotType=null,this.plotParams=null,this.dispatchEvent(new Vr(Vr.DRAW_END,this.feature)),this.feature=null}},{key:"deactivateMapTools",value:function(){for(var e=this.map.getInteractions(),t=e.getLength(),n=0;n<t;n++){var r=e.item(n);if(r instanceof vr["a"]){this.dblClickZoomInteraction=r,e.remove(r);break}}}},{key:"activateMapTools",value:function(){null!=this.dblClickZoomInteraction&&(this.map.getInteractions().push(this.dblClickZoomInteraction),this.dblClickZoomInteraction=null)}}]),n}(Vn["a"]),yo=r("cb76"),bo={_stampId:0,trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stamp:function(e){var t="_p_id_";return e[t]=e[t]||this._stampId++,e[t]}},Po=bo,wo={create:function(e,t,n,r){var i=document.createElement(e);return i.className=t||"",r&&(i.id=r),n&&n.appendChild(i),i},createHidden:function(e,t,n){var r=document.createElement(e);return r.style.display="none",n&&(r.id=n),t&&t.appendChild(r),r},remove:function(e,t){t&&e&&t.removeChild(e)},get:function(e){return document.getElementById(e)},getStyle:function(e,t){var n=e.style[t];return"auto"===n?null:n},hasClass:function(e,t){return e.className.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},addClass:function(e,t){this.hasClass(e,t)||(e.className&&(e.className+=" "),e.className+=t)},removeClass:function(e,t){e.className=Po.trim((" "+e.className+" ").replace(" "+t+" "," "))},getDomEventKey:function(e,t,n){return"_p_dom_event_"+e+"_"+Po.stamp(t)+(n?"_"+Po.stamp(n):"")},addListener:function(e,t,n,r){var i=this,o=wo.getDomEventKey(t,n,r),a=e[o];return a||(a=function(t){return n.call(r||e,t)},"addEventListener"in e?e.addEventListener(t,a,!1):"attachEvent"in e&&e.attachEvent("on"+t,a),e[o]=a),i},removeListener:function(e,t,n,r){var i=this,o=wo.getDomEventKey(t,n,r),a=e[o];return a?("removeEventListener"in e?e.removeEventListener(t,a,!1):"detachEvent"in e&&e.detachEvent("on"+t,a),e[o]=null,i):i}},Oo=wo;function ko(e){return function(){var t,n=Object(Ar["a"])(e);if(jo()){var r=Object(Ar["a"])(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return Object(Tr["a"])(this,t)}}function jo(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}var _o=function(e){Object(xr["a"])(n,e);var t=ko(n);function n(e){var r;return Object(Mr["a"])(this,n),r=t.call(this),r.activePlot=null,r.startPoint=null,r.ghostControlPoints=null,r.controlPoints=null,r.map=e,r.mapViewport=r.map.getViewport(),r.mouseOver=!1,r.elementTable={},r.activeControlPointId=null,r.mapDragPan=null,r.Constants={HELPER_HIDDEN_DIV:"p-helper-hidden-div",HELPER_CONTROL_POINT_DIV:"p-helper-control-point-div"},r.pointermoveListener=null,r.pointerdownListener=null,r.pointerupListener=null,r.pointerdragListener=null,r.mousemoveCallback=r.controlPointMouseMoveHandler.bind(Object(Ur["a"])(r)),r.mouseupCallback=r.controlPointMouseUpHandler.bind(Object(Ur["a"])(r)),r}return Object(Rr["a"])(n,[{key:"initHelperDom",value:function(){if(this.map&&this.activePlot){var e=this.getMapParentElement();if(e)for(var t=Oo.createHidden("div",e,this.Constants.HELPER_HIDDEN_DIV),n=this.getControlPoints(),r=0;r<n.length;r++){var i=this.Constants.HELPER_CONTROL_POINT_DIV+"-"+r;Oo.create("div",this.Constants.HELPER_CONTROL_POINT_DIV,t,i),this.elementTable[i]=r}}}},{key:"getMapParentElement",value:function(){var e=this.map.getTargetElement();if(e)return e.parentNode}},{key:"destroyHelperDom",value:function(){if(this.controlPoints){for(var e=0;e<this.controlPoints.length;e++){this.map.removeOverlay(this.controlPoints[e]);var t=Oo.get(this.Constants.HELPER_CONTROL_POINT_DIV+"-"+e);t&&(Oo.removeListener(t,"mousedown",this.controlPointMouseDownHandler,this),Oo.removeListener(t,"mousemove",this.controlPointMouseMoveHandler2,this))}this.controlPoints=null}var n=this.getMapParentElement(),r=Oo.get(this.Constants.HELPER_HIDDEN_DIV);r&&n&&Oo.remove(r,n)}},{key:"initControlPoints",value:function(){if(this.map){this.controlPoints=[];for(var e=this.getControlPoints(),t=0;t<e.length;t++){var n=this.Constants.HELPER_CONTROL_POINT_DIV+"-"+t,r=Oo.get(n),i=new Ee["a"]({id:n,position:e[t],positioning:"center-center",element:r});this.controlPoints.push(i),this.map.addOverlay(i),this.map.render(),Oo.addListener(r,"mousedown",this.controlPointMouseDownHandler,this),Oo.addListener(r,"mousemove",this.controlPointMouseMoveHandler2,this)}}}},{key:"controlPointMouseMoveHandler2",value:function(e){e.stopImmediatePropagation()}},{key:"controlPointMouseDownHandler",value:function(e){var t=e.target.id;this.activeControlPointId=t,this.mapViewport.addEventListener(Ir.MOUSEMOVE,this.mousemoveCallback,!1),this.mapViewport.addEventListener(Ir.MOUSEUP,this.mouseupCallback,!1)}},{key:"controlPointMouseMoveHandler",value:function(e){var t=this.map.getCoordinateFromPixel([e.offsetX,e.offsetY]);if(this.activeControlPointId){var n=this.activePlot.getGeometry(),r=this.elementTable[this.activeControlPointId];n.updatePoint(t,r);var i=this.map.getOverlayById(this.activeControlPointId);i.setPosition(t),this.dispatchEvent(new Br(Br.EDIT_MOVE,this.activePlot))}}},{key:"controlPointMouseUpHandler",value:function(e){this.mapViewport.removeEventListener(Ir.MOUSEMOVE,this.mousemoveCallback,!1),this.mapViewport.removeEventListener(Ir.MOUSEUP,this.mouseupCallback,!1),this.dispatchEvent(new Br(Br.EDIT_END,this.activePlot))}},{key:"activate",value:function(e){if(e&&e instanceof te["a"]&&e!=this.activePlot){var t=e.getGeometry();t.isPlot()&&(this.deactivate(),this.activePlot=e,this.pointermoveListener=this.map.on("pointermove",this.plotMouseOverOutHandler.bind(this)),this.initHelperDom(),this.initControlPoints())}}},{key:"getControlPoints",value:function(){if(!this.activePlot)return[];var e=this.activePlot.getGeometry();return e.getPoints()}},{key:"plotMouseOverOutHandler",value:function(e){var t=this.map.forEachFeatureAtPixel(e.pixel,(function(e,t){return e}));t&&t==this.activePlot?this.mouseOver||(this.mouseOver=!0,this.map.getViewport().style.cursor="move",this.pointerdownListener=this.map.on("pointerdown",this.plotMouseDownHandler.bind(this))):this.mouseOver&&(this.mouseOver=!1,this.map.getViewport().style.cursor="default",Object(Vn["b"])(this.pointerdownListener))}},{key:"plotMouseDownHandler",value:function(e){this.ghostControlPoints=this.getControlPoints(),this.startPoint=e.coordinate,this.disableMapDragPan(),this.pointerupListener=this.map.on("pointerup",this.plotMouseUpHandler.bind(this)),this.pointerdragListener=this.map.on("pointerdrag",this.plotMouseMoveHandler.bind(this))}},{key:"plotMouseMoveHandler",value:function(e){for(var t=e.coordinate,n=t[0]-this.startPoint[0],r=t[1]-this.startPoint[1],i=[],o=0;o<this.ghostControlPoints.length;o++){var a=this.ghostControlPoints[o],s=[a[0]+n,a[1]+r];i.push(s);var l=this.Constants.HELPER_CONTROL_POINT_DIV+"-"+o,c=this.map.getOverlayById(l);c.setPosition(s),c.setPositioning("center-center")}var u=this.activePlot.getGeometry();u.setPoints(i),this.dispatchEvent(new Br(Br.EDIT_MOVE,this.activePlot))}},{key:"plotMouseUpHandler",value:function(e){this.enableMapDragPan(),Object(Vn["b"])(this.pointerupListener),Object(Vn["b"])(this.pointerdragListener),this.dispatchEvent(new Br(Br.EDIT_END,this.activePlot))}},{key:"disconnectEventHandlers",value:function(){Object(Vn["b"])(this.pointermoveListener),this.mapViewport.removeEventListener(Ir.MOUSEMOVE,this.mousemoveCallback,!1),this.mapViewport.removeEventListener(Ir.MOUSEUP,this.mouseupCallback,!1),Object(Vn["b"])(this.pointerdownListener),Object(Vn["b"])(this.pointerupListener),Object(Vn["b"])(this.pointerdragListener)}},{key:"deactivate",value:function(){this.activePlot=null,this.mouseOver=!1,this.destroyHelperDom(),this.disconnectEventHandlers(),this.elementTable={},this.activeControlPointId=null,this.startPoint=null}},{key:"disableMapDragPan",value:function(){for(var e=this.map.getInteractions(),t=e.getLength(),n=0;n<t;n++){var r=e.item(n);if(r instanceof yo["a"]){this.mapDragPan=r,r.setActive(!1);break}}}},{key:"enableMapDragPan",value:function(){null!=this.mapDragPan&&(this.mapDragPan.setActive(!0),this.mapDragPan=null)}}]),n}(Vn["a"]),Co={point:[{value:"MARKER",label:"点"}],line:[{value:"ARC",label:"弧线"},{value:"CURVE",label:"曲线"},{value:"POLYLINE",label:"折线"},{value:"FREEHAND_LINE",label:"自由线"}],face:[{value:"CIRCLE",label:"圆"},{value:"ELLIPSE",label:"椭圆"},{value:"LUNE",label:"弓形"},{value:"SECTOR",label:"扇形"},{value:"CLOSED_CURVE",label:"曲线面"},{value:"POLYGON",label:"多边形"},{value:"RECTANGLE",label:"矩形"},{value:"FREEHAND_POLYGON",label:"自由面"},{value:"GATHERING_PLACE",label:"聚集地"}],arrow:[{value:"DOUBLE_ARROW",label:"钳击"},{value:"STRAIGHT_ARROW",label:"直箭头"},{value:"FINE_ARROW",label:"细直箭头"},{value:"ASSAULT_DIRECTION",label:"突击方向"},{value:"ATTACK_ARROW",label:"进攻方向"},{value:"TAILED_ATTACK_ARROW",label:"进攻方向（尾）"},{value:"SQUAD_COMBAT",label:"分队战斗行动"},{value:"TAILED_SQUAD_COMBAT",label:"分队战斗行动（尾）"}]},Eo=Co,So=(r("482f"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"editPlot"},[n("div",{directives:[{name:"show",rawName:"v-show",value:"point"!=e.type,expression:"type!='point'"}]},[n("i",{staticClass:"opIcon",class:e.plotOl.open?"openIcon":"closeIcon",on:{click:function(t){e.plotOl.open=!e.plotOl.open}}})]),n("ul",{directives:[{name:"show",rawName:"v-show",value:e.plotOl.open,expression:"plotOl.open"}],style:e.computedStyle},["line"!=e.type&&"point"!=e.type?n("li",[e._m(0),n("suc-colorpicker",{attrs:{title:"填充颜色",alpha:""},on:{change:e.changeFill},model:{value:e.colorData.fillColor,callback:function(t){e.$set(e.colorData,"fillColor",t)},expression:"colorData.fillColor"}})],1):e._e(),"point"!=e.type?n("li",[e._m(1),n("suc-colorpicker",{attrs:{title:"边框颜色",alpha:""},on:{change:e.changeStroke},model:{value:e.colorData.strokeColor,callback:function(t){e.$set(e.colorData,"strokeColor",t)},expression:"colorData.strokeColor"}})],1):e._e(),"point"!=e.type?n("li",[n("a",{staticClass:"font-color",attrs:{title:"边框样式"},on:{click:function(t){e.styleOpen=!e.styleOpen}}},[n("i",{staticClass:"plot_line"})]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.styleOpen,expression:"styleOpen"}],staticClass:"lineStyle"},[n("div",[n("div",[e._v("边框宽度：")]),n("suc-slider",{attrs:{"show-input":"","show-stops":"",min:1,max:10},on:{change:e.changeWidth},model:{value:e.colorData.width,callback:function(t){e.$set(e.colorData,"width",t)},expression:"colorData.width"}})],1),n("div",[n("div",[e._v("边框样式：")]),n("div",{staticClass:"lineSelect",class:{active:"solid"==e.colorData.lineStyle},on:{click:function(t){return e.changeLine("solid")}}},[n("a")]),n("div",{staticClass:"lineSelect lineDash",class:{active:"dashed"==e.colorData.lineStyle},on:{click:function(t){return e.changeLine("dashed")}}},[n("a")])])])]):e._e(),n("li",{staticClass:"delLi"},[n("a",{attrs:{title:"删除"},on:{click:function(t){return e.del()}}},[e._m(2)])])])])}),Lo=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{staticClass:"font-color",attrs:{title:"填充颜色"}},[n("i",{staticClass:"plot_fill"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a",{attrs:{title:"边框颜色",id:"plotEditStroke"}},[n("i",{staticClass:"plot_lineColor"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("i",{staticClass:"closeIcon"},[n("img",{attrs:{src:r("11d1")}})])}],Io=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ColorPicker",{attrs:{alpha:e.alpha,recommend:e.recommend},on:{"on-change":function(t){return e.$emit("change",e.newValue)}},model:{value:e.newValue,callback:function(t){e.newValue=t},expression:"newValue"}})},Mo=[],xo=r("dd4b"),To={name:"suc-colorpicker",components:{ColorPicker:xo["a"]},model:{prop:"value",event:"change"},props:{value:{type:String},alpha:{type:Boolean,default:!1},recommend:{type:Boolean,default:!1}},watch:{value:function(e){this.newValue=e}},data:function(){return{newValue:this.value}}},Ao=To,Ro=Object(j["a"])(Ao,Io,Mo,!1,null,null,null),Fo=Ro.exports,Do=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Slider",{attrs:{min:e.min,max:e.max,step:e.step,"show-input":e.showInput,"show-stops":e.showStops},on:{"on-input":function(t){return e.$emit("change",e.newValue)}},model:{value:e.newValue,callback:function(t){e.newValue=t},expression:"newValue"}})},No=[],Go=r("d531"),Vo={name:"suc-slider",components:{Slider:Go["a"]},model:{prop:"value",event:"change"},props:{value:{type:Number,default:0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:{type:Boolean,default:!1},showStops:{type:Boolean,default:!1}},watch:{value:function(e){this.newValue=e}},data:function(){return{newValue:this.value}}},$o=Vo,zo=Object(j["a"])($o,Do,No,!1,null,null,null),Ho=zo.exports,Bo={components:{sucColorpicker:Fo,sucSlider:Ho},props:{type:{type:String,default:"point"},data:{type:Object,default:function(){return{strokeColor:"#2058A5",fillColor:"rgba(32, 88, 165, 0.4)",width:1,lineStyle:"solid"}}}},watch:{data:{handler:function(e){var t=this;t.colorData=e},deep:!0}},data:function(){return{colorData:this.data,plotOl:{open:!0},styleOpen:!1}},methods:{changeStroke:function(e){this.$emit("change-stroke",e)},changeFill:function(e){this.$emit("change-fill",e)},changeLine:function(e){this.colorData.lineStyle!=e&&(this.colorData.lineStyle=e,this.$emit("change-line",e))},changeWidth:function(e){this.$emit("change-width",e)},del:function(){this.$emit("delete",!0)}},computed:{computedStyle:function(){return"point"==this.type?{width:"35px"}:"line"==this.category?{width:"135px",marginLeft:"20px"}:{width:"180px",marginLeft:"20px"}}}},Uo=Bo,Wo=(r("eaae"),Object(j["a"])(Uo,So,Lo,!1,null,null,null)),Ko=Wo.exports,Yo={name:"ol-plot",inject:["getMap"],props:{type:{type:String,required:!0,default:"MARKER"},olStyle:{type:Object,default:function(){return{fill:{color:[32,88,165,.4]},stroke:{color:"#2058A5",width:3},image:{circle:{radius:7,fill:{color:"#0099ff"},stroke:{color:"#1F497D",width:1}}}}}},noEdit:{type:Boolean,default:!1},isSingle:{type:Boolean,default:!1},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"},hasFeatures:{type:Array,default:function(){return[]}}},components:{olOverlay:Rn,editOverlay:Ko},data:function(){return{viewProjection:"EPSG:3857",selectedFeature:{category:"",layPosition:[],data:{}},layOffset:[0,20]}},watch:{type:function(e){var t=this;if(!e)return!1;this.getMap().then((function(e){t.addPlot(e)}))},hasFeatures:function(){var e=this;this.plotEdit.deactivate(),this.source.clear(),this.plotDraw.deactivate(),this.sketch=!0,this.selectedFeature={category:"",layPosition:[],data:{}},this.getMap().then((function(t){e.loadFeatures(t)}))},noEdit:function(e){e&&this.plotEdit.deactivate()}},methods:{init:function(){var e=this;this.initData(),this.getMap().then((function(t){e.map=t,e.viewProjection=t.getView().getProjection().getCode(),e.createLayer(t),e.hasFeatures.length&&e.loadFeatures(t),e.plotDraw=new go(t),e.plotDraw.on(d.PlotDrawEvent.DRAW_END,e.onDrawEnd),e.plotEdit=new _o(t),e.plotEdit.on(d.PlotEditEvent.EDIT_MOVE,e.onEditMove),e.plotEdit.on(d.PlotEditEvent.EDIT_END,e.onEditEnd),e.addPlot(t),e.listenEvent(t)}))},initData:function(){this.map=null,this.layer=null,this.source=null,this.helpTooltipElement=null,this.helpTooltipHtml="",this.helpTooltip=null},createLayer:function(e){var t=this;t.source=new ee["a"],t.layer=new X["a"]({source:t.source,zIndex:t.zIndex}),t.layer.set("plotLayer",!0),e.addLayer(this.layer)},createHelpTooltip:function(e,t){var n=this.helpTooltipElement,r=this.helpTooltip;n&&n.parentNode.removeChild(n),n=document.createElement("div"),n.className="tooltip hidden",r=ct(n,void 0,"helpTooltip",!1),r.set("name",t),r.setOffset([15,30]),e.addOverlay(r),this.helpTooltipElement=n,this.helpTooltip=r},outEvent:function(){var e=this;-1==e.helpTooltipElement.className.indexOf("hidden")&&(e.helpTooltipElement.className+=" hidden")},disableContxet:function(e){return this.plotDraw.deactivate(),this.sketch=!0,this.$emit("drawend",{feature:""}),e.returnValue=!1,!1},listenerMove:function(e){var t=this;if(!e.dragging)if(t.movePos=e.coordinate,t.sketch){var n=t.helpTooltipElement.className.split(" "),r=n.indexOf("hidden");-1==r&&(t.helpTooltipElement.className+=" hidden")}else if(t.type){t.helpTooltipElement.innerHTML=t.helpTooltipHtml,t.helpTooltip.setPosition(e.coordinate);var i=t.helpTooltipElement.className.split(" "),o=i.indexOf("hidden");-1!=o&&(i.splice(o,1),t.helpTooltipElement.className=i.join(" "))}},getPlotCategory:function(e){var t="";for(var n in Jr)Jr[n]==e&&(t=n);var r=Eo;for(var i in r)for(var o=r[i],a=o.length,s=0;s<a;s++){var l=o[s];if(l.value==t)return i}return""},getLayPos:function(e){var t=e.getGeometry().getExtent(),n=[(t[0]+t[2])/2,t[1]];return n},transfromColor:function(e){if(e instanceof Array){if(3==e.length)return"rgb("+e.join(",")+")";if(4==e.length)return"rgba("+e.join(",")+")"}return e},setFeatureInfo:function(e){var t,n,r,i={layPosition:this.getLayPos(e),category:this.getPlotCategory(e.getGeometry().type),data:{}},o=e.getStyle();if(o.getStroke()){var a=o.getStroke();t=a.getColor(),n=a.getWidth(),i.data.strokeColor=this.transfromColor(t),i.data.width=n,a.getLineDash()?i.data.lineStyle="dashed":i.data.lineStyle="solid"}return o.getFill()&&(r=o.getFill().getColor(),i.data.fillColor=this.transfromColor(r)),i},listenerClick:function(e){var t=this;if(t.sketch=!0,t.helpTooltipElement.className="tooltip hidden",!t.plotDraw.isDrawing()){var n;if(Ve(e.feature))n=e.feature;else{if("ol-cesium"==e.originalEvent.srcElement.className)return!1;n=t.map.forEachFeatureAtPixel(e.pixel,(function(e,t){return e}))}if(n&&n.getGeometry().isPlot()){if(t.noEdit)return!1;t.plotEdit.activate(n),t.selectedFeature=t.setFeatureInfo(n)}else t.plotEdit.deactivate(),t.selectedFeature={category:"",layPosition:[],data:{}}}},listenEvent:function(e){var t=this,n=e.getTarget().id||"default";Wt.$on(n+".singleclick",t.listenerClick),Wt.$on(n+".pointermove",t.listenerMove),e.getViewport().addEventListener("mouseout",t.outEvent),e.getViewport().addEventListener("contextmenu",t.disableContxet)},activate:function(e){this.plotEdit.deactivate(),this.selectedFeature={category:"",layPosition:[],data:{}},this.plotDraw.activate(e,{style:rt(this.olStyle)}),this.sketch=null},addPlot:function(e){var t=this.type;t&&(this.helpTooltipHtml="MARKER"==t?"可左键点击想要标记的位置，右键退出":"FREEHAND_LINE"==t||"FREEHAND_POLYGON"==t?"点击左键开始绘制，再次点击结束绘制，右键退出":"CURVE"==t||"POLYLINE"==t||"CLOSED_CURVE"==t||"POLYGON"==t||"ATTACK_ARROW"==t||"TAILED_ATTACK_ARROW"==t||"SQUAD_COMBAT"==t||"TAILED_SQUAD_COMBAT"==t?"点击左键开始绘制，双击结束绘制，右键退出":"点击左键开始绘制，右键退出",this.isSingle&&this.source.clear(),this.activate(Jr[t])),this.createHelpTooltip(e,"plot"),t||(this.helpTooltipElement.className="tooltip hidden")},getCoordData:function(e){var t=this.map,n=e.getGeometry();"pixel"!=this.projection&&(n=n.clone().transform(t.getView().getProjection(),this.projection));var r,i=n.getCoordinates();if(n instanceof ve["a"])r=i;else if(n instanceof fe["a"])r=n.getCoordinateAt(.5);else if(n instanceof he["a"]){var o=n.getInteriorPoint().getCoordinates();r=[o[0],o[1]]}return[i,r]},onDrawEnd:function(e){var t=this,n=e.feature,r=rt(this.olStyle);n.setStyle(r),n.getGeometry().set("altitudeMode","clampToGround"),this.source.addFeature(n),this.noEdit||setTimeout((function(){t.plotEdit.activate(n),t.selectedFeature=t.setFeatureInfo(n)}),500);var i=this.getCoordData(n),o=Object(Sr["a"])(i,2),a=o[0],s=o[1];this.$emit("drawend",{dataStore:{type:n.getGeometry().type,points:n.getGeometry().getPoints()},feature:n,coord:a,center:s})},onEditMove:function(e){var t=e.feature,n=this.getCoordData(t),r=Object(Sr["a"])(n,2),i=r[0],o=r[1];this.selectedFeature.layPosition=this.getLayPos(t),this.$emit("editmove",{dataStore:{type:t.getGeometry().type,points:t.getGeometry().getPoints()},feature:t,coord:i,center:o})},onEditEnd:function(e){var t=e.feature,n=this.getCoordData(t),r=Object(Sr["a"])(n,2),i=r[0],o=r[1];this.$emit("editend",{dataStore:{type:t.getGeometry().type,points:t.getGeometry().getPoints()},feature:t,coord:i,center:o})},refreshStroke:function(e){var t=this.plotEdit.activePlot,n=t.getStyle();n.getStroke()&&n.getStroke().setColor(e),t.changed(),this.source.refresh()},refreshLine:function(e){var t=this.plotEdit.activePlot,n=t.getStyle().getStroke();n&&("solid"==e?n.getLineDash()&&n.setLineDash(void 0):n.setLineDash([4,4]),t.changed(),this.source.refresh())},refreshWidth:function(e){var t=this.plotEdit.activePlot,n=t.getStyle().getStroke();n&&n.setWidth(e),t.changed(),this.source.refresh()},refreshFill:function(e){var t=this.plotEdit.activePlot,n=t.getStyle();n.getFill()&&n.getFill().setColor(e),t.changed(),this.source.refresh()},deleteFeature:function(){var e=this.plotEdit.activePlot;this.plotEdit.deactivate(),this.selectedFeature.layPosition=[],this.selectedFeature.category="",this.selectedFeature.data={},this.$emit("delete",{feature:e}),this.source.removeFeature(e),this.source.refresh()},getStyleInfo:function(e){var t,n=e.getStyle();if(n.getImage()){var r=n.getImage();if(r instanceof ae["a"]){var i=r.getAnchor(),o=r.getSize();t={image:{icon:{anchor:[i[0]/o[0],i[1]/o[1]],src:r.getSrc()}}},r.getColor()&&(t.image.icon.color=r.getColor())}else if(t={image:{circle:{radius:r.getRadius()}}},r.getFill()&&(t.image.circle.fill={color:r.getFill().getColor()}),r.getStroke()){var a=r.getStroke();t.image.circle.stroke={},a.getColor()&&(t.image.circle.stroke.color=a.getColor()),a.getWidth()&&(t.image.circle.stroke.width=a.getWidth())}}var s={};if(n.getStroke()){var l=n.getStroke();s.stroke={width:l.getWidth(),color:l.getColor()},l.getLineDash()&&(s.stroke.lineDash=l.getLineDash())}return n.getFill()&&(s.fill={color:n.getFill().getColor()}),Object.assign(s,t)},getLayerData:function(){var e=this,t=[],n=this.source.getFeatures();return n.forEach((function(n){var r=e.getCoordData(n),i=Object(Sr["a"])(r,2),o=i[0],a=i[1];t.push({dataStore:{type:n.getGeometry().type,points:n.getGeometry().getPoints(),style:e.getStyleInfo(n)},coord:o,center:a})})),t},loadFeatures:function(e){var t=this,n=[];if(this.hasFeatures.length){this.hasFeatures.forEach((function(e){var r=e.dataStore,i=po.createPlot(r.type,r.points),o=new te["a"](i);o.setStyle(rt(r.style)),t.source.addFeature(o);var a=t.getCoordData(o),s=Object(Sr["a"])(a,2),l=s[0],c=s[1];n.push({dataStore:{type:o.getGeometry().type,points:o.getGeometry().getPoints()},coord:l,center:c})}));var r=this.source.getExtent();e.getView().fit(r)}this.$emit("loadend",n)}},mounted:function(){this.init()},beforeDestroy:function(){var e=this,t=this;this.plotEdit.deactivate(),this.plotDraw.deactivate(),t.getMap().then((function(n){t.source.clear(),n.removeLayer(t.layer),n.getViewport().removeEventListener("mouseout",t.outEvent),n.getViewport().removeEventListener("contextmenu",t.disableContxet),n.removeOverlay(e.helpTooltip);var r=n.getTarget().id||"default";Wt.$off(r+".pointermove",t.listenerMove),Wt.$off(r+".singleclick",t.listenerClick)}))}},qo=Yo,Zo=(r("de24"),Object(j["a"])(qo,Cr,Er,!1,null,null,null)),Jo=Zo.exports;function Qo(e){Qo.installed||(Qo.installed=!0,e.component(ar.name,ar),e.component(dr.name,dr),e.component(br.name,br),e.component(_r.name,_r),e.component(Jo.name,Jo))}var Xo=Qo,ea=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-flash",staticStyle:{display:"none"}})},ta=[],na={name:"ol-flash",inject:["getMap"],props:{coords:{type:Array,validator:function(e){return 2==e.length}},circleStyle:{type:Object,default:function(){return{image:{circle:{radius:0,fill:{color:[255,0,0]}}}}}},duration:{type:Number,default:3e3},loops:{type:Number,default:3},radiusRange:{type:Array,default:function(){return[0,30]},validator:function(e){return 2==e.length&&e[0]<=e[1]}},hasCenter:{type:Object,validator:function(e){return e.radius&&e.color}},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"}},data:function(){return{layer:null,source:null,features:[],listenerKey:null}},watch:{coords:function(){var e=this;this.getMap().then((function(t){e.update(t)}))}},created:function(){this.init()},methods:{init:function(){var e=this;this.getMap().then((function(t){e.createLayer(t),e.update(t)}))},createLayer:function(e){this.source=new ee["a"],this.layer=new X["a"]({source:this.source,zIndex:this.zIndex}),this.layer.set("flashLayer",!0),e.addLayer(this.layer)},startFlash:function(e){for(var t=this,n=[],r=0;r<t.loops;r++)n.push(rt(t.circleStyle));function i(e,n){if(e>=0){var r=e/t.duration,i=r*(t.maxRadius-t.minRadius)+t.minRadius,o=1-r;if(n.getImage().setRadius(i),n.getImage().getFill()){var a=n.getImage().getFill().getColor();n.getImage().getFill().setColor([a[0],a[1],a[2],o])}return n}}function o(r){for(var o=r.frameState,a=0;a<t.loops;a++){var s=(o.time-parseInt(t.duration/t.loops*a))%t.duration;t.features[a].setStyle(i(s,n[a]))}e.render()}t.listenerKey&&Object(Vn["b"])(t.listenerKey),t.listenerKey=e.on("postcompose",o)},update:function(e){var t=this,n=e.getView().getProjection().getCode();function r(){var e;return e="pixel"===t.projection?new ve["a"](t.coords):new ve["a"](Object(Se["m"])(t.coords,t.projection,n)),new te["a"]({geometry:e})}this.source.clear(),t.listenerKey&&Object(Vn["b"])(t.listenerKey),t.features=[];for(var i=0;i<t.loops;i++)t.features.push(r());if(t.source.addFeatures(t.features),t.hasCenter){var o=r();o.setStyle(rt({image:{circle:{radius:t.hasCenter.radius,fill:{color:t.hasCenter.color}}}})),t.source.addFeature(o)}t.startFlash(e)}},computed:{minRadius:function(){return this.radiusRange[0]},maxRadius:function(){return this.radiusRange[1]}},beforeDestroy:function(){var e=this;this.listenerKey&&Object(Vn["b"])(this.listenerKey),e.getMap().then((function(t){e.features.forEach((function(e){e.getStyle();e.setStyle(null),e=null})),e.source.clear(),t.removeLayer(e.layer)}))}},ra=na,ia=Object(j["a"])(ra,ea,ta,!1,null,null,null),oa=ia.exports,aa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-twinkle",staticStyle:{display:"none"}})},sa=[],la={name:"ol-twinkle",inject:["getMap"],props:{coords:{type:Array},circleStyle:{type:Object,default:function(){return{image:{circle:{radius:14,snapToPixel:!1,fill:{color:[255,0,0,1]}}}}}},duration:{type:Number,default:1e3},radius:{type:Number,default:function(){return 10}},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"}},data:function(){return{layer:null,source:null,feature:null,listenerKey:null}},watch:{coords:function(){var e=this;this.getMap().then((function(t){e.update(t)}))}},created:function(){this.init()},methods:{init:function(){var e=this;this.getMap().then((function(t){e.createLayer(t),e.update(t)}))},createLayer:function(e){this.source=new ee["a"],this.layer=new X["a"]({source:this.source,zIndex:this.zIndex}),this.layer.set("twinkleLayer",!0),e.addLayer(this.layer)},startFlash:function(e){var t=this,n=rt(t.circleStyle);function r(r){var i=r.frameState,o=i.time%t.duration,a=o/t.duration*2,s=a;a>1&&(s=2-a),n.getImage().setRadius(t.radius);var l=n.getImage().getFill().getColor();n.getImage().getFill().setColor([l[0],l[1],l[2],s]),t.feature.setStyle(n),e.render()}t.listenerKey&&Object(Vn["b"])(t.listenerKey),t.listenerKey=e.on("postcompose",r)},update:function(e){var t=this,n=e.getView().getProjection().getCode();function r(){var e;return e="pixel"===t.projection?new ve["a"](t.coords):new ve["a"](Object(Se["m"])(t.coords,t.projection,n)),new te["a"]({geometry:e})}this.source.clear(),t.feature=r(),t.source.addFeature(t.feature),t.startFlash(e)}},beforeDestroy:function(){var e=this,t=this;t.getMap().then((function(n){t.feature.getStyle();t.feature.setStyle(null),t.feature=null,t.source.clear(),n.removeLayer(t.layer),e.listenerKey&&Object(Vn["b"])(e.listenerKey)}))}},ca=la,ua=Object(j["a"])(ca,aa,sa,!1,null,null,null),ha=ua.exports,da=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-track",staticStyle:{display:"none"}},[e._t("default",null,{selectPoint:e.selectPoint})],2)},fa=[],pa=(r("8449"),{name:"ol-track",inject:["getMap"],props:{points:{type:Array,required:!0,default:function(){return[]},validator:function(e){return e.length>2}},curIndex:{type:Number,default:0},curTime:{type:Number,default:0},node:{type:Object,required:!0,validator:function(e){return e.img&&e.imgSize}},marker:{type:Object,required:!0,validator:function(e){return e.img&&e.imgSize}},lineStyle:{type:Object,default:function(){return{stroke:{color:"#2058A5",width:4}}}},nodeShow:{type:Number,default:14},speed:{type:Number,default:1},maxSpeed:{type:Number,default:34},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"},isInterpolate:{type:Boolean,default:!0},maxMinutes:{type:Number,default:2},overLabel:String},data:function(){return{curNodeIndex:0,curSegIndex:0,selectPoint:null}},watch:{speed:function(){this.changeSpeed()},curIndex:function(e){this.curNodeIndex=e,this.goStep(e)},curNodeIndex:function(e){this.$emit("update:curIndex",e);var t=this.normalizedPoints[0].timestamp;this.$emit("update:curTime",this.normalizedPoints[e].timestamp-t)},curSegIndex:function(e){if(-1!=e&&this.isInterpolate){var t=this.normalizedPoints[0].timestamp;if(!this.segVirPoints[e])return void console.log("seg",e);this.$emit("update:curTime",this.segVirPoints[e].timestamp-t)}},curTime:function(e){this.isInterpolate&&this.goTime(e/1e3)}},methods:{init:function(){var e=this;if(this.initData(),!this.isValid(this.points))return console.error("请检查经纬度是否有效！"),!1;this.normalizedPoints=this.handlePoints(this.points),this.isInterpolate&&(this.segVirPoints=this.interpolateSegment(0,this.normalizedPoints)),this.getMap().then((function(t){e.map=t,e.viewProjection=t.getView().getProjection().getCode(),e.virtualLayer=e.createLayer(t),e.layer=e.createLayer(t),e.source=e.layer.getSource(),e.drawMarker(),e.listenEvent()}))},initData:function(){this.map=null,this.virtualLayer=null,this.layer=null,this.source=null,this.currentGeo=null,this.featureGeo=null,this.normalizedPoints=[],this.segVirPoints=[],this.segVirPoints_next=[],this.curNodeIndex=0,this.curSegIndex=-1,this.styles={};var e=new Image;e.src=this.node.img,this.styles.node=rt({image:{icon:{anchor:this.node.anchor||[.5,.5],img:e,imgSize:this.node.imgSize}}});var t=new Image;t.src=this.marker.img,this.styles.marker=rt({zIndex:2,image:{icon:{anchor:this.marker.anchor||[.5,.5],img:t,imgSize:this.marker.imgSize}}}),this.styles.line=rt(this.lineStyle),this.hisTimer=null,this.renderEventKey=null,this.exsitIndex=[]},isValid:function(e){for(var t=e.length,n=0;n<t;n++){var r=e[n],i=r.lon,o=r.lat;if("EPSG:4326"==this.projection)return Ke(i,o)}return!0},handlePoints:function(e){var t=e.map((function(e){var t=e;return t.lon=parseFloat(e.lon),t.lat=parseFloat(e.lat),"string"==typeof t.time?t.timestamp=qe(t.time,"-",":"):"number"==typeof t.time?(t.timestamp=t.time,t.time=Ye(t.timestamp,"yyyy-MM-dd HH:mm:ss")):console.error("请检查time格式！"),t}));return t},interpolateSegment:function(e,t){if(this.isInterpolate){var n=[],r=t[e],i=t[e+1],o=i.timestamp-r.timestamp,a=parseInt(o/1e3);if(a>60*this.maxMinutes)return[r,i];for(var s=i.lon-r.lon,l=i.lat-r.lat,c=i.speed-r.speed,u=1;u<=a;u++){var h={lon:r.lon+s*(u/a),lat:r.lat+l*(u/a),timestamp:r.timestamp+o*(u/a),time:Ye(r.timestamp+o*(u/a),"yyyy-MM-dd HH:mm:ss"),speed:r.speed+c*(u/a),direction:r.direction};n.push(h)}return n}},createLayer:function(e){var t=this,n=new ee["a"],r=new X["a"]({source:n,zIndex:this.zIndex,style:function(n,r){if(n.get("finished")){var i=n.get("type");if(null!=n.get("rotation")&&t.styles[i].getImage().setRotation(n.get("rotation")),"line"==i&&(n.get("lineDash")?t.styles["line"].getStroke().setLineDash([4,10]):t.styles["line"].getStroke().setLineDash(void 0)),"node"==i){var o=e.getView().getZoomForResolution(r);o<t.nodeShow?t.styles["node"].getImage().setOpacity(0):t.styles["node"].getImage().setOpacity(1)}return t.styles[i]}return null}});return r.set("trackLayer",!0),e.addLayer(r),r},drawMarker:function(){var e=this.normalizedPoints[0];this.currentGeo=new ve["a"]([e.lon,e.lat]),this.currentGeo=this.currentGeo.transform(this.projection,this.viewProjection),this.featureGeo=new te["a"](this.currentGeo),this.featureGeo.set("type","marker"),this.featureGeo.set("finished",!0),this.source.addFeature(this.featureGeo),this.featureGeo.set("featureInfo",{type:"trackMarker",data:Object.assign(Ue(e),{coord:[e.lon,e.lat]})})},createNodes:function(e){for(var t=0;t<=this.curNodeIndex;t++){var n=this.normalizedPoints[t],r=new ve["a"]([n.lon,n.lat]);r=r.transform(this.projection,this.viewProjection);var i=new te["a"](r),o=this.styles.node,a=n.direction?parseFloat(n.direction)/180*Math.PI:0;o.getImage().setRotation(a),this.map.getView().getZoom()<this.nodeShow?o.getImage().setOpacity(0):o.getImage().setOpacity(1),e.drawFeature(i,o)}},createMarker:function(e){var t;t=-1==this.curSegIndex?this.normalizedPoints[this.curNodeIndex]:this.segVirPoints[this.curSegIndex];var n=new ve["a"]([t.lon,t.lat]);n=n.transform(this.projection,this.viewProjection);var r,i=new te["a"](n),o=this.styles.marker;if(o&&o.getImage()&&void 0!=o.getImage().getRotation()){var a=t.direction?parseFloat(t.direction)/180*Math.PI:0;o.getImage().setRotation(a)}e.drawFeature(i,o),r="pixel"===this.projection?[t.lon,t.lat]:Object(Se["m"])([t.lon,t.lat],this.projection,this.viewProjection);var s=this.map.getView(),l=this.map.getSize(),c=s.calculateExtent(l);Object(Ht["f"])(c,r)||s.setCenter(r)},createLine:function(e,t){var n=[[e.lon,e.lat],[t.lon,t.lat]];if(e.timestamp){var r=dt(this.projection,n[1],n[0]);r>this.maxSpeed*(t.timestamp-e.timestamp)/1e3?this.styles.line.getStroke().setLineDash([4,10]):this.styles.line.getStroke().getLineDash()&&this.styles.line.getStroke().setLineDash(void 0)}var i=new fe["a"](n);return i=i.transform(this.projection,this.viewProjection),new te["a"](i)},createLines:function(e){for(var t=1;t<=this.curNodeIndex;t++){var n=this.normalizedPoints[t-1],r=this.normalizedPoints[t];e.drawFeature(this.createLine(n,r),this.styles.line)}for(var i=0;i<=this.curSegIndex;i++){var o=void 0,a=void 0;0==i?(o=this.normalizedPoints[this.curNodeIndex],a=this.segVirPoints[i]):(o=this.segVirPoints[i-1],a=this.segVirPoints[i]),e.drawFeature(this.createLine(o,a),this.styles.line)}},moveFeature:function(e){var t=this,n=e.vectorContext;t.createLines(n),t.createNodes(n),t.createMarker(n),this.map.render()},listenRender:function(){this.renderEventKey=this.map.on("postcompose",this.moveFeature),this.map.render()},drawNode:function(e,t){var n=[e.lon,e.lat],r=new ve["a"](n);r=r.transform(this.projection,this.viewProjection);var i=new te["a"]({geometry:r,type:"node",index:t,featureInfo:{type:"trackNode",data:Object.assign(Ue(e),{coord:[e.lon,e.lat]})}}),o=e.direction?parseFloat(e.direction)/180*Math.PI:0;return i.set("rotation",o),i},drawLine:function(e,t,n){var r=[t.lon,t.lat],i=[n.lon,n.lat],o=new fe["a"]([r,i]);o=o.transform(this.projection,this.viewProjection);var a=new te["a"]({geometry:o,type:"line",index:e+1});if(t.timestamp){var s=dt(this.projection,i,r);s>this.maxSpeed*(n.timestamp-t.timestamp)/1e3?a.set("lineDash",!0):a.set("lineDash",!1)}return a},drawFact:function(e){for(var t=1;t<=e;t++)if(-1==this.exsitIndex.indexOf(t)){var n=this.normalizedPoints[t-1],r=this.normalizedPoints[t];this.source.addFeature(this.drawLine(t-1,n,r)),this.source.addFeature(this.drawNode(this.normalizedPoints[t-1],t-1)),this.exsitIndex.push(t)}},draw:function(){this.drawFact(this.curNodeIndex),this.virtualLayer.getSource().clear();for(var e=0;e<=this.curSegIndex;e++){var t=void 0,n=void 0;0==e?(t=this.normalizedPoints[this.curNodeIndex],n=this.segVirPoints[e]):(t=this.segVirPoints[e-1],n=this.segVirPoints[e]),this.virtualLayer.getSource().addFeature(this.drawLine(e-1,t,n))}},setMarkerPosition:function(){var e;e=-1==this.curSegIndex?this.normalizedPoints[this.curNodeIndex]:this.segVirPoints[this.curSegIndex],this.currentGeo.setCoordinates(Object(Se["m"])([e.lon,e.lat],this.projection,this.viewProjection)),this.featureGeo.set("finished",!0);var t=e.direction?parseFloat(e.direction)/180*Math.PI:0;this.featureGeo.set("rotation",t),this.featureGeo.set("featureInfo",{type:"trackMarker",data:Object.assign(Ue(e),{coord:[e.lon,e.lat]})})},createTimer:function(e){var t=this,n=this;n.source.getFeatures().forEach((function(e){e.set("finished",!1)})),n.virtualLayer.getSource().getFeatures().forEach((function(e){e.set("finished",!1)})),n.hisTimer=setInterval((function(){n.curNodeIndex>=n.normalizedPoints.length-1?n.pause():t.isInterpolate?(n.curSegIndex==n.segVirPoints.length-1&&(n.curNodeIndex++,n.segVirPoints=n.segVirPoints_next,n.curSegIndex=-1),n.curSegIndex++,0==n.curSegIndex&&(n.segVirPoints_next=n.interpolateSegment(n.curNodeIndex+1,n.normalizedPoints))):n.curNodeIndex++}),e)},play:function(){var e=1e3/this.speed;this.listenRender(),this.createTimer(e)},pause:function(){var e=this;this.hisTimer&&(clearInterval(this.hisTimer),this.hisTimer=null),Object(Vn["b"])(this.renderEventKey),this.draw(),this.source.getFeatures().forEach((function(t){t.get("index")<=e.curNodeIndex&&t.set("finished",!0)})),this.isInterpolate&&this.virtualLayer.getSource().getFeatures().forEach((function(t){t.get("index")<=e.curSegIndex&&t.set("finished",!0)})),this.setMarkerPosition()},stop:function(){this.hisTimer&&(clearInterval(this.hisTimer),this.hisTimer=null),this.curNodeIndex=0,this.curSegIndex=-1,this.segVirPoints=this.interpolateSegment(0,this.normalizedPoints),Object(Vn["b"])(this.renderEventKey),this.source.getFeatures().forEach((function(e){e.set("finished",!1)})),this.isInterpolate&&this.virtualLayer.getSource().getFeatures().forEach((function(e){e.set("finished",!1)})),this.setMarkerPosition()},goStep:function(e){var t=this;this.curNodeIndex=e,this.curSegIndex=-1,this.curNodeIndex<this.normalizedPoints.length-1&&(this.segVirPoints=this.interpolateSegment(this.curNodeIndex,this.normalizedPoints)),this.hisTimer||(this.draw(),this.source.getFeatures().forEach((function(e){e.get("index")<=t.curNodeIndex?e.set("finished",!0):e.set("finished",!1)})),this.virtualLayer.getSource().clear(),this.setMarkerPosition())},changeSpeed:function(){var e=1e3/this.speed;this.hisTimer&&(clearInterval(this.hisTimer),this.createTimer(e))},findValue:function(e,t){var n=e.length;if(1==n)return e[0].index;var r=parseInt(n/2);return e[r].timestamp>t?this.findValue(e.slice(0,r),t):e[r].timestamp<t?this.findValue(e.slice(r),t):e[r].index},goTime:function(e){var t=this;if(this.isInterpolate){var n=this.normalizedPoints[0].timestamp,r=this.normalizedPoints.map((function(e,t){return e.index=t,e}));console.log("搜索位置",Ye(new Date,"yyyy-MM-dd HH:mm:ss")),this.curNodeIndex=this.findValue(r,n+1e3*e),console.log("搜索位置结束",Ye(new Date,"yyyy-MM-dd HH:mm:ss")),this.curSegIndex=(n+1e3*e-this.normalizedPoints[this.curNodeIndex].timestamp)/1e3-1,this.segVirPoints=this.interpolateSegment(this.curNodeIndex,this.normalizedPoints),this.hisTimer||(this.draw(),this.source.getFeatures().forEach((function(e){e.get("index")<=t.curNodeIndex?e.set("finished",!0):e.set("finished",!1)})),this.virtualLayer.getSource().getFeatures().forEach((function(e){e.get("index")<=t.curSegIndex?e.set("finished",!0):e.set("finished",!1)})),this.setMarkerPosition())}},showNameOverlay:function(e,t,n){var r=this;ut(e,null,"overLabel");var i=null;return"none"!=r.overLabel&&(i=ht(t,e,n),i&&i.set("overLabel","true"),i)},listenerMove:function(e){var t=this;if(e.olLayer==t.layer&&(t.$emit("pointermove",e),"node"==e.feature.get("type"))){var n=e.feature.getGeometry().getCoordinates();t.showNameOverlay(t.map,e.feature,{lat:n[1],lon:n[0],projection:t.viewProjection,label:{classNm:"featureOver trackOver",message:e.feature.get("featureInfo").data.time||"空"}})}},listenerMove_blank:function(){var e=this;ut(e.map,null,"overLabel")},listenerClick:function(e){var t=this;if(e.olLayer==t.layer){t.$emit("singleclick",e);var n=e.feature,r=n.get("type");"node"!=r&&"marker"!=r||(t.selectPoint=n.get("featureInfo").data)}},listenerClick_blank:function(){var e=this;e.selectPoint=null},listenEvent:function(){var e=this,t=this.map.getTarget().id||"default";Wt.$on(t+".track.pointermove",e.listenerMove),Wt.$on(t+".pointermove.blank",e.listenerMove_blank),Wt.$on(t+".track.singleclick",e.listenerClick),Wt.$on(t+".singleclick.blank",e.listenerClick_blank)}},mounted:function(){this.init()},beforeDestroy:function(){var e=this;e.getMap().then((function(t){e.source.clear(),t.removeLayer(e.layer),e.virtualLayer.getSource().clear(),t.removeLayer(e.virtualLayer);var n=t.getTarget().id||"default";Wt.$off(n+".track.pointermove",e.listenerMove),Wt.$off(n+".pointermove.blank",e.listenerMove_blank),Wt.$off(n+".track.singleclick",e.listenerClick),Wt.$off(n+".singleclick.blank",e.listenerClick_blank)})),this.curNodeIndex=0,this.hisTimer&&clearInterval(this.hisTimer),Object(Vn["b"])(this.renderEventKey)}}),va=pa,ma=Object(j["a"])(va,da,fa,!1,null,null,null),ga=ma.exports,ya=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-migrate",staticStyle:{display:"none"}})},ba=[],Pa={name:"ol-migrate",inject:["getMap"],props:{data:{type:Array,required:!0,validator:function(e){var t=e.filter((function(e){return!(!e.from||e.from.lnglat)||(!(!e.to||e.to.lnglat)||(!e.from||!e.to))}));return!t.length}},lineStyle:{type:Object,default:function(){return{stroke:{color:"#12b5d0",width:2}}}},textColor:String,moveRadius:{type:Number,default:3},moveColor:{type:String,default:"white"},speed:{type:String,default:"normal",validator:function(e){return-1!=["slow","normal"].indexOf(e)}},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"}},data:function(){return{}},methods:{init:function(){var e=this;this.initData(),this.getMap().then((function(t){e.map=t,e.layer=e.createLayer(t),e.source=e.layer.getSource(),e.loadLines(t),e.createText(),e.listenRender()}))},initData:function(){this.map=null,this.layer=null,this.source=null,this.style=rt(this.lineStyle),this.renderEventKey=null,this.lines=[],this.linesIndex=[],this.linesNumber=[],this.linesPnts=[],this.normalizedData=this.handleData(this.data)},handleData:function(e){var t=this;return e.map((function(e){var n=e.from.lnglat,r=e.to.lnglat;return e.from.lnglat=[parseFloat(n[0]),parseFloat(n[1])],e.to.lnglat=[parseFloat(r[0]),parseFloat(r[1])],t.linesIndex.push(0),t.linesNumber.push(0),t.linesPnts.push(0),e}))},createLayer:function(e){var t=new X["a"]({source:new ee["a"],zIndex:this.zIndex});return t.set("migrate",!0),e.addLayer(t),t},createLine:function(e){var t=e.startX,n=e.startY,r=e.endX,i=e.endY,o=(t+r)/2,a=(n+i)/2,s=.1,l=(i-n)*s+o,c=(t-r)*s+a;return new ni([[t,n],[r,i],[l,c]])},loadLines:function(e){var t=this,n=this;this.normalizedData.forEach((function(r){var i=r.from.lnglat,o=r.to.lnglat,a={startX:i[0],startY:i[1],endX:o[0],endY:o[1]},s=n.createLine(a);s=s.transform(n.projection,e.getView().getProjection());var l,c=new te["a"](s);l=r.lineStyle?rt(r.lineStyle):n.style,c.setStyle(l),t.lines.push(s.getCoordinates()),t.source.addFeature(c)})),this.map.getView().fit(this.source.getExtent())},createText:function(){var e=this,t=this,n=[],r=[];t.normalizedData.forEach((function(e){var t=e.from.lnglat,i=e.to.lnglat;-1==n.indexOf(e.from.city)&&r.push({lnglat:t,city:e.from.city}),-1==n.indexOf(e.to.city)&&r.push({lnglat:i,city:e.to.city})})),r.forEach((function(n){var r=new ve["a"](n.lnglat);r=r.transform(t.projection,t.map.getView().getProjection());var i=new te["a"](r);i.setStyle(new ne["c"]({text:new ce["a"]({text:n.city,font:"14px Calibri,sans-serif",offsetX:20,offsetY:20,fill:new re["a"]({color:e.lineStyle.stroke.color})})})),t.source.addFeature(i)}))},getPixelDis:function(e,t){var n=this.map.getPixelFromCoordinate(e),r=this.map.getPixelFromCoordinate(t);return Xr.distance(n,r)},getPointSeg:function(e,t){for(var n,r,i=this.getPixelDis(e,t),o=Math.ceil(i/this.moveRadius),a=t[1]-e[1],s=t[0]-e[0],l=[],c=1;c<o;c++)n=e[0]+this.moveRadius*c/i*s,r=e[1]+this.moveRadius*c/i*a,l.push([n,r]);return l.push(t),l},getPointList:function(){for(var e=this.lines.length,t=0;t<e;t++){for(var n=this.lines[t],r=n.length,i=[],o=0;o<r-1;o++)i=i.concat(this.getPointSeg(n[o],n[o+1]));i.push(n[0]),0!=this.linesPnts[t]&&(this.linesIndex[t]=i.length*this.linesIndex[t]/this.linesNumber[t]),this.linesPnts[t]=i,this.linesNumber[t]=i.length}},createMoveCircle:function(e,t){for(var n=rt({image:{circle:{radius:this.moveRadius,fill:{color:this.moveColor}}}}),r=parseInt(this.linesIndex[e]),i=0;i<=r;i++){var o=this.linesPnts[e][i],a=new ve["a"](o),s=new te["a"](a);n.getImage().setOpacity(Math.pow(.95,r-i+1)),t.drawFeature(s,n)}this.linesIndex[e]+="normal"==this.speed?1:.5,this.linesIndex[e]>this.linesNumber[e]-1&&(this.linesIndex[e]=0)},moveFeature:function(e){var t=this,n=e.vectorContext;0==this.linesPnts[0]&&this.getPointList();for(var r=this.lines.length,i=0;i<r;i++)t.createMoveCircle(i,n);this.map.render()},listenRender:function(){this.renderEventKey=this.map.on("postcompose",this.moveFeature),this.map.render(),this.listenMove(this.map)},listenMove:function(e){var t=this;e.getView().on("change:resolution",(function(){t.getPointList()}))}},mounted:function(){this.init()},beforeDestroy:function(){var e=this;e.getMap().then((function(t){e.source.clear(),t.removeLayer(e.layer)})),Object(Vn["b"])(this.renderEventKey)}},wa=Pa,Oa=Object(j["a"])(wa,ya,ba,!1,null,null,null),ka=Oa.exports,ja=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-radar",staticStyle:{display:"none"}})},_a=[],Ca={name:"ol-radar",inject:["getMap"],props:{center:{type:Array,required:!0,validator:function(e){return 2==e.length}},radius:{type:Number,default:500},circleStyle:{type:Object,default:function(){return{stroke:{width:1,color:"#12b5d0"}}}},sectorColor:{type:String,default:"#12b5d0"},speed:{type:String,default:"normal",validator:function(e){return-1!=["slow","normal"].indexOf(e)}},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"}},watch:{center:function(){this.update()},radius:function(){this.update()},circleStyle:{handler:function(e){this.circleFeature.setStyle(rt(e))},deep:!0}},computed:{normalizeColor:function(){var e=this.sectorColor,t=Ze(e).split(",");return t[0]=parseInt(t[0]),t[1]=parseInt(t[1]),t[2]=parseInt(t[2]),t}},methods:{init:function(){var e=this;this.initData(),this.getMap().then((function(t){e.map=t,e.layer=e.createLayer(t),e.source=e.layer.getSource(),e.update()}))},initData:function(){this.map=null,this.layer=null,this.source=null,this.circleFeature=null,this.renderEventKey=null,this.curNo=0,this.angleDiff=5,this.parts=360/this.angleDiff},update:function(){this.source.clear(),this.viewProjection=this.map.getView().getProjection(),this.centerAfter=Je(this.center,this.projection,this.viewProjection),this.radiusAfter=ot(this.viewProjection,this.radius,this.centerAfter),this.createCircle(),this.listenRender()},createLayer:function(e){var t=new X["a"]({source:new ee["a"],zIndex:this.zIndex});return t.set("radar",!0),e.addLayer(t),t},createCircle:function(){var e=new ge["a"](this.centerAfter,this.radiusAfter),t=this.circleFeature=new te["a"](e);t.setStyle(rt(this.circleStyle)),e.set("altitudeMode","clampToGround"),this.source.addFeature(t)},createSector:function(e,t){for(var n=this.angleDiff/180*Math.PI,r=Math.max(e-this.parts-1,0),i=e;i>=r;i--){var o=n*i,a=it(this.centerAfter,this.radiusAfter,o,o+n);a.push(this.centerAfter),a.push(a[0]);var s=new he["a"]([a]),l=new te["a"](s),c=this.normalizeColor;c[3]=.6*Math.pow(.95,e-i);var u=new ne["c"]({fill:new re["a"]({color:this.normalizeColor})});t.drawFeature(l,u)}},moveFeature:function(e){var t=e.vectorContext;this.createSector(parseInt(this.curNo),t),this.curNo+="normal"==this.speed?1:.5,this.map.render()},listenRender:function(){this.renderEventKey&&Object(Vn["b"])(this.renderEventKey),this.renderEventKey=this.map.on("postcompose",this.moveFeature),this.map.render()}},mounted:function(){this.init()},beforeDestroy:function(){var e=this;e.getMap().then((function(t){e.source.clear(),t.removeLayer(e.layer)})),Object(Vn["b"])(this.renderEventKey)}},Ea=Ca,Sa=Object(j["a"])(Ea,ja,_a,!1,null,null,null),La=Sa.exports;function Ia(e){Ia.installed||(Ia.installed=!0,e.component(oa.name,oa),e.component(ha.name,ha),e.component(ga.name,ga),e.component(ka.name,ka),e.component(La.name,La))}var Ma=Ia,xa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-path",staticStyle:{display:"none"}})},Ta=[],Aa={name:"ol-path",inject:["getMap"],props:{options:{type:Object,default:function(){return{id:"default",type:"Circle",coords:[120,30],radius:500,style:{fill:{color:"rgba(255,0,0,0.2)"},stroke:{color:"blue",width:4}}}}},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"}},data:function(){return{layer:null,source:null,feature:null}},watch:{options:{handler:function(){var e=this;e.getMap().then((function(t){e.update(t)}))},deep:!0}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.getMap().then((function(t){e.createLayer(t),e.update(t)}))},createLayer:function(e){this.source=new ee["a"],this.layer=new X["a"]({source:this.source,zIndex:this.zIndex}),this.layer.set("pathLayer",!0),e.addLayer(this.layer)},calcRadius:function(e){if(this.options.radius){if("pixel"!=this.projection){var t=dt(e,this.options.coords,[this.options.coords[0]+1,this.options.coords[1]]),n=this.options.radius/t;return n}return this.options.radius}return 0},update:function(e){var t=e.getView().getProjection().getCode(),n=On.getDefaults(),r=n.styles.feature;if(this.feature){if("Circle"==this.options.type){var i=Ue(this.options);"pixel"!=this.projection&&(i.coords=Je(i.coords,this.projection,t),i.radius=ot(t,i.radius,i.coords)),this.feature.getGeometry().setCenterAndRadius(i.coords,i.radius)}else if("Sector"==this.options.type){var o=Ue(this.options);"pixel"!=this.projection&&(o.coords=Je(o.coords,this.projection,t),o.radius=ot(t,o.radius,o.coords));var a=it(o.coords,o.radius,o.startAngle,o.endAngle);a.push(o.coords,a[0]),this.feature.getGeometry().setCoordinates([a])}else this.feature.getGeometry().setCoordinates(this.options.coords),"pixel"!=this.projection&&this.feature.getGeometry().transform(this.projection,t);var s=Ue(this.options.style)||r;if(Ve(s)){if(s instanceof Array)for(var l=s.length,c=0;c<l;c++)s[c]=rt(s[c]);else s=rt(s);this.feature.setStyle(s)}}else{var u=Ue(this.options);u.style=u.style||r,u.projection=this.projection,this.options.radius&&"pixel"!=this.projection&&(u.coords=Je(u.coords,this.projection,t),u.radius=ot(t,u.radius,u.coords),u.projection=t),this.feature=at(u,t),this.source.addFeature(this.feature),this.$emit("create-end",this.feature)}}},beforeDestroy:function(){var e=this;e.getMap().then((function(t){var n=e.source;n.getFeatures().forEach((function(e){e.getStyle();e=null})),n.clear(),n=null,t.removeLayer(e.layer)}))}},Ra=Aa,Fa=Object(j["a"])(Ra,xa,Ta,!1,null,null,null),Da=Fa.exports,Na=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-mulpath",staticStyle:{display:"none"}})},Ga=[],Va={name:"ol-mul-path",inject:["getMap"],props:{grids:{type:Array,required:!0},isFit:{type:Boolean,default:!1},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"}},data:function(){return{}},watch:{grids:{handler:function(){var e=this;e.getMap().then((function(t){e.update(t)}))},deep:!0}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.initData(),this.getMap().then((function(t){e.createLayer(t),e.update(t)}))},initData:function(){this.layer=null,this.source=null},createLayer:function(e){this.source=new ee["a"],this.layer=new X["a"]({source:this.source,zIndex:this.zIndex}),this.layer.set("mulPathLayer",!0),e.addLayer(this.layer)},update:function(e){var t=this,n=e.getView().getProjection().getCode(),r=On.getDefaults(),i=r.styles.feature,o=this.grids,a=new Array;o.forEach((function(e){var r=Ue(e);r.style=r.style||i,r.projection=t.projection,e.radius&&"pixel"!=t.projection&&(r.coords=Je(r.coords,t.projection,n),r.radius=ot(n,r.radius,r.coords),r.projection=n);var o=at(r,n);a.push(o)})),t.source.clear(!0),t.source.addFeatures(a),t.$emit("loadFinished",{source:t.source}),t.isFit&&e.getView().fit(t.source.getExtent())}},beforeDestroy:function(){var e=this;e.getMap().then((function(t){var n=e.source;n.getFeatures().forEach((function(e){e.getStyle();e=null})),n.clear(),n=null,t.removeLayer(e.layer)}))}},$a=Va,za=Object(j["a"])($a,Na,Ga,!1,null,null,null),Ha=za.exports,Ba=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-collection",staticStyle:{display:"none"}},[e._t("default",null,{selectPoint:e.selectPoint})],2)},Ua=[];function Wa(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Ka(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function Ka(e,t){if(e){if("string"===typeof e)return Ya(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ya(e,t):void 0}}function Ya(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var qa={name:"ol-point-collection",inject:["getMap"],props:{points:{type:Array,default:function(){return[{id:"default",coords:[120,30],style:{fill:{color:"rgba(255,0,0,0.2)"},stroke:{color:"blue",width:4}}}]}},layerStyle:{type:Object},onlyVisible:{type:Boolean,default:!1},selectPointId:[String,Number],blankClear:{type:Boolean,default:!0},renderMode:{type:String,default:"vector"},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"}},data:function(){return{layer:null,source:null,feature:null,moveLabel:null,selectPoint:null,storeObject:{}}},watch:{points:{handler:function(){var e=this;e.getMap().then((function(t){e.update(t)}))},deep:!0},selectPointId:{handler:function(e){var t=this;if(!e)return t.selectPoint=null,!1;var n=t.storeObject[e];t.selectPoint=n?Ue(n):null}},selectPoint:function(e){e?this.$emit("update:selectPointId",e.id):this.$emit("update:selectPointId","")}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.getMap().then((function(t){if(e.map=t,e.createLayer(t),e.storeObject={},e.update(t),e.listenEvent(t),e.selectPointId){var n=e.storeObject[e.selectPointId];e.selectPoint=n?Ue(n):null}}))},getStyle:function(e){var t=null;if(Ve(e))if(e instanceof Array){var n=e.length;t=[];for(var r=0;r<n;r++)t[r]=rt(e[r])}else t=rt(e);return t},createLayer:function(e){if(this.source=new ee["a"]({strategy:Vt["b"]}),this.layer=new X["a"]({source:this.source,renderMode:this.renderMode,zIndex:this.zIndex}),this.layer.set("collectionLayer",!0),e.addLayer(this.layer),this.layerStyle){var t=this.getStyle(this.layerStyle);this.layer.setStyle(t)}},isRepeatId:function(e){var t,n=[],r=Wa(e);try{var i=function(){var r=t.value;if(!r.id)return console.log("id缺失："+JSON.stringify(r)),{v:!0};if(-1!=n.indexOf(r.id)){var i=e.filter((function(e){return e.id==r.id}));return console.log("id重复："+JSON.stringify(i)),{v:!0}}n.push(r.id)};for(r.s();!(t=r.n()).done;){var o=i();if("object"===Object(J["a"])(o))return o.v}}catch(a){r.e(a)}finally{r.f()}return!1},addFeature:function(e,t){if("EPSG:4326"==this.projection&&!Ke(e.coords[0],e.coords[1]))return console.error("海量点位 经纬度不规范！",e),null;var n=new ve["a"](e.coords);n=n.transform(this.projection,t);var r=new te["a"]({id:e.id,geometry:n});return r.setId(e.id),e.style&&r.setStyle(this.getStyle(e.style)),r.set("collectionInfo",e),this.storeObject[e.id]=e,r},updateFeature:function(e,t){if("EPSG:4326"==this.projection&&!Ke(e.coords[0],e.coords[1]))return console.error("海量点位 经纬度不规范！",e),!1;var n=this.source.getFeatureById(e.id);n&&(n.getGeometry().setCoordinates(Je(e.coords,this.projection,t)),e.style?n.setStyle(this.getStyle(e.style)):n.setStyle(null),this.storeObject[e.id]=e)},deleteFeature:function(e){var t=this.source.getFeatureById(e);t&&(this.source.removeFeature(t),delete this.storeObject[e])},update:function(e){var t=this,n=e.getView().getProjection().getCode();if(t.isRepeatId(t.points))return console.error("海量点位必须有唯一的id值"),!1;var r=new Array,i=new Array,o=e.getView().calculateExtent(e.getSize());for(var a in t.points.forEach((function(e){var a=!0;if(t.onlyVisible&&(a=Object(Ht["f"])(o,Je(e.coords,t.projection,n))),a){if(t.storeObject[e.id])t.updateFeature(e,n);else{var s=t.addFeature(e,n);s&&r.push(s)}i.push(e.id)}})),t.source.addFeatures(r),t.storeObject)-1==i.indexOf(a)&&t.deleteFeature(a)},showNameOverlay:function(e,t,n){ut(e,null,"overLabel");var r={lat:n.lat,lon:n.lon,projection:n.projection,label:{classNm:"featureOver",message:n.name,stopEvent:!1}},i=ht(t,e,r);return i&&i.set("overLabel","true"),i},listenerMove:function(e){var t=this,n=e.feature.get("collectionInfo"),r=n.name,i=n.coords;r&&(t.moveLabel=t.showNameOverlay(t.map,e.feature,{lat:i[1],lon:i[0],projection:"EPSG:4326",name:r})),t.$emit("pointermove",n)},listenerMove_blank:function(){var e=this;e.moveLabel&&e.map.removeOverlay(e.moveLabel)},listenerClick:function(e){var t=this,n=e.feature.get("collectionInfo");t.selectPoint=Ue(n),t.$emit("singleclick",t.selectPoint)},listenerClick_blank:function(){var e=this;e.blankClear&&(e.selectPoint=null)},listenEvent:function(e){var t=this,n=e.getTarget().id||"default";Wt.$on(n+".collection.pointermove",t.listenerMove),Wt.$on(n+".pointermove.blank",t.listenerMove_blank),Wt.$on(n+".collection.singleclick",t.listenerClick),Wt.$on(n+".singleclick.blank",t.listenerClick_blank)}},beforeDestroy:function(){var e=this;e.getMap().then((function(t){var n=e.source;n.getFeatures().forEach((function(e){e.getStyle();e=null})),n.clear(),n=null,t.removeLayer(e.layer);var r=t.getTarget().id||"default";Wt.$off(r+".collection.pointermove",e.listenerMove),Wt.$off(r+".pointermove.blank",e.listenerMove_blank),Wt.$off(r+".collection.singleclick",e.listenerClick),Wt.$off(r+".singleclick.blank",e.listenerClick_blank)}))}},Za=qa,Ja=Object(j["a"])(Za,Ba,Ua,!1,null,null,null),Qa=Ja.exports,Xa=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-heat",staticStyle:{display:"none"}})},es=[];function ts(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ns(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(n),!0).forEach((function(t){Object(tn["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ts(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var rs={name:"ol-heat-map",inject:["getMap"],props:{layerConfig:{type:Object,default:{blur:15,radius:8}},points:{type:Array,required:!0,default:function(){return[]}},zIndex:{type:Number,default:2},projection:{type:String,default:"EPSG:4326"}},watch:{points:{handler:function(e){var t=this;t.getMap().then((function(e){t.update(e)}))},deep:!0}},data:function(){return{source:null,layer:null}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.getMap().then((function(t){e.createLayer(t),e.update(t)}))},createLayer:function(e){this.source=new ee["a"],this.layer=new _t["a"](ns({source:this.source},this.layerConfig,{zIndex:this.zIndex})),this.layer.set("heatLayer",!0),e.addLayer(this.layer)},update:function(e){for(var t=this,n=e.getView().getProjection().getCode(),r=this.points.length,i=new Array,o=0;o<r;o++){var a=this.points[o];if(a.lon&&a.lat){var s=at({projection:t.projection,lat:parseFloat(a.lat),lon:parseFloat(a.lon),id:a.id},n);a.weight&&s.set("weight",a.weight),i.push(s),s.set("featureInfo",{type:"heatFeature",data:{}})}}this.source.clear(!0),this.source.addFeatures(i)}},beforeDestroy:function(){var e=this;e.getMap().then((function(t){var n=e.source;n.getFeatures().forEach((function(e){e.getStyle();e=null})),n.clear(),n=null,t.removeLayer(e.layer)}))}},is=rs,os=Object(j["a"])(is,Xa,es,!1,null,null,null),as=os.exports,ss=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"vueol-nearby"},[n("div",{staticClass:"nearby-control-point"},[n("a"),n("label",{on:{click:function(t){return e.editDis(t)}}},[e.edit?n("input",{directives:[{name:"model",rawName:"v-model",value:e.initialRadius,expression:"initialRadius"}],staticClass:"nearby-control-input",attrs:{type:"number"},domProps:{value:e.initialRadius},on:{input:function(t){t.target.composing||(e.initialRadius=t.target.value)}}}):n("span",[e._v(e._s(e.initialRadius))]),e._v("m\n        ")])])])},ls=[],cs={name:"ol-nearby",inject:["getMap"],props:{center:{type:Array,required:!0,default:function(){return[120,30]}},radius:{type:Number,default:0},circleStyle:{type:Object,default:function(){return{fill:{color:[110,162,228,.3]},stroke:{width:1,color:[110,162,228]}}}},zIndex:{type:Number,default:0},projection:{type:String,default:"EPSG:4326"}},data:function(){return{initialRadius:this.radius,layer:null,source:null,feature:null,label:null,edit:!1,isDrag:!1,mapCoord:[]}},watch:{center:{handler:function(){var e=this;this.getMap().then((function(t){e.update(t)}))},deep:!0},radius:function(){var e=this;this.getMap().then((function(t){e.update(t)}))},circleStyle:{handler:function(){var e;if(this.circleStyle instanceof Array)for(var t=this.circleStyle.length,n=0;n<t;n++)e[n]=rt(this.circleStyle[n]);else e=rt(this.circleStyle);this.feature.setStyle(e)},deep:!0}},mounted:function(){this.init()},methods:{init:function(){var e=this;this.getMap().then((function(t){"pixel"!=e.projection?e.mapCoord=Je(e.center,e.projection,t.getView().getProjection().getCode()):e.mapCoord=e.center,e.createLayer(t),e.createCircle(t),e.createOverlay(t),e.listenEvent(t)}))},update:function(e){var t=e.getView().getProjection().getCode();this.initialRadius=this.radius,"pixel"!=this.projection?this.mapCoord=Je(this.center,this.projection,t):this.mapCoord=this.center;var n=this.feature.getGeometry(),r=ot(t,this.initialRadius,this.mapCoord);n.setCenterAndRadius(this.mapCoord,r),this.label.setPosition([this.mapCoord[0]+r,this.mapCoord[1]]),this.fitView(e)},createLayer:function(e){this.source=new ee["a"],this.layer=new X["a"]({source:this.source,zIndex:this.zIndex}),this.layer.set("nearLayer",!0),e.addLayer(this.layer)},fitView:function(e){var t=this.source.getExtent();e.getView().fit(t,{size:e.getSize(),padding:[15,15,15,15],duration:1e3})},createCircle:function(e){var t=e.getView().getProjection().getCode(),n={type:"Circle",coords:this.mapCoord,radius:ot(t,this.initialRadius,this.mapCoord),projection:t,style:this.circleStyle};this.feature=at(n,t),this.source.addFeature(this.feature),this.fitView(e)},createOverlay:function(e){var t=e.getView().getProjection().getCode(),n=ot(t,this.initialRadius,this.mapCoord),r=[this.mapCoord[0]+n,this.mapCoord[1]];this.label=ct(this.$el,r),e.addOverlay(this.label)},windowToCanvas:function(e,t,n){var r=e.getBoundingClientRect();return[t-r.left-(r.width-e.clientWidth)/2,n-r.top-(r.height-e.clientHeight)/2]},listenEvent:function(e){var t=this,n=e.getViewport(),r=document.getElementsByClassName("nearby-control-point")[0].children[0];r.addEventListener("mousedown",(function(r){var i=t.feature.getGeometry().getRadius(),o=t.label.getPosition(),a=e.getCoordinateFromPixel(t.windowToCanvas(n,r.clientX,r.clientY));function s(r){t.isDrag=!0;var s=e.getCoordinateFromPixel(t.windowToCanvas(n,r.clientX,r.clientY));t.label.setPosition([o[0]+s[0]-a[0],t.mapCoord[1]]);var l=Math.abs(s[0]-a[0]+i);t.feature.getGeometry().setRadius(l);var c=e.getView().getProjection().getCode(),u=dt(c,t.mapCoord,[t.mapCoord[0]+l,t.mapCoord[1]]);return t.initialRadius=parseInt(u),!1}function l(){return t.fitView(e),t.label.setPosition([t.mapCoord[0]+t.feature.getGeometry().getRadius(),t.mapCoord[1]]),t.$emit("refresh",{radius:parseInt(t.initialRadius)}),t.isDrag=!1,n.removeEventListener("pointermove",s),n.removeEventListener("pointerup",l),!1}n.addEventListener("pointermove",s),n.addEventListener("pointerup",l)}))},editDis:function(e){var t=this;this.isDrag||(this.edit=!0,this.$nextTick((function(){var e=document.getElementsByClassName("nearby-control-input")[0];e.focus()})),e.stopPropagation(),this.getMap().then((function(e){t.listenBlank(e)})))},listenBlank:function(e){var t=this,n=e.getViewport(),r=e.getView().getProjection().getCode();function i(o){if(t.edit&&"input"!=o.target.tagName.toLowerCase()){t.edit=!1;var a=dt(r,t.mapCoord,[t.mapCoord[0]+1,t.mapCoord[1]]),s=t.initialRadius/a;t.feature.getGeometry().setRadius(s),t.label.setPosition([t.mapCoord[0]+s,t.mapCoord[1]]),t.fitView(e),n.removeEventListener("pointerdown",i),t.$emit("refresh",{radius:parseInt(t.initialRadius)})}}n.addEventListener("pointerdown",i)}},beforeDestroy:function(){var e=this;e.getMap().then((function(t){e.feature.getStyle();e.feature.setStyle(null),e.feature=null,e.source.clear(),t.removeLayer(e.layer),t.removeOverlay(e.label)}))}},us=cs,hs=Object(j["a"])(us,ss,ls,!1,null,null,null),ds=hs.exports;function fs(e){fs.installed||(fs.installed=!0,e.component(Da.name,Da),e.component(Ha.name,Ha),e.component(Qa.name,Qa),e.component(as.name,as),e.component(ds.name,ds))}var ps=fs;r("5bc0"),r("c737");function vs(e){vs.installed||(vs.installed=!0,e.use(s),e.use(l),e.use(c),e.use(u),e.use(h),e.use(p),e.use(v),e.use(m),e.prototype.$mapUtils=a)}var ms=vs,gs=r("a4e1"),ys=r("5c96"),bs=r.n(ys),Ps=(r("0fae"),r("dcad"),r("b20f"),r("fb98"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.$props.tagname,{tag:"section",staticClass:"ps-container",on:{"~mouseover":function(t){return e.update(t)},"ps-scroll-y":e.scrollHanle,"ps-scroll-x":e.scrollHanle,"ps-scroll-up":e.scrollHanle,"ps-scroll-down":e.scrollHanle,"ps-scroll-left":e.scrollHanle,"ps-scroll-right":e.scrollHanle,"ps-y-reach-start":e.scrollHanle,"ps-y-reach-end":e.scrollHanle,"ps-x-reach-start":e.scrollHanle,"ps-x-reach-end":e.scrollHanle}},[e._t("default")],2)}),ws=[],Os=r("b7f5"),ks=(r("7da8"),null),js={name:"vue-perfect-scrollbar",props:{settings:{default:void 0},swicher:{type:Boolean,default:!0},tagname:{type:String,default:"section"},isBodyScroll:{type:Boolean,default:!1}},methods:{scrollHanle:function(e){this.$emit(e.type,e)},update:function(){ks.update(this.$el)},__init:function(){this.swicher&&(this._ps_inited?this.update(this.$el):(this._ps_inited=!0,ks=new Os["a"](this.$el,this.settings)))},__uninit:function(){ks.destroy(this.$el),this._ps_inited=!1}},watch:{swicher:function(e){e&&!this._ps_inited&&this.__init(),!e&&this._ps_inited&&this.__uninit()},$route:function(){this.update(),this.isBodyScroll&&(this.$el.scrollTop=0)}},mounted:function(){this.__init()},updated:function(){this.$nextTick(this.update)},activated:function(){this.__init()},deactivated:function(){this.__uninit()},beforeDestroy:function(){}},_s=js,Cs=(r("af38"),Object(j["a"])(_s,Ps,ws,!1,null,null,null)),Es=Cs.exports;"undefined"!==typeof window&&window.Vue&&Vue.component("vue-perfect-scrollbar",Es);var Ss={install:function(e){e.component("vue-perfect-scrollbar",Es)}};b["default"].use(ms),b["default"].use(gs["a"]),b["default"].use(bs.a),b["default"].use(Ss),b["default"].config.productionTip=!1,b["default"].prototype.$Modal=y["a"],I.beforeEach((function(e,t,n){g["a"].start(),n()})),I.afterEach((function(){g["a"].finish()})),new b["default"]({router:I,store:U,render:function(e){return e(C)}}).$mount("#app")},de24:function(e,t,n){"use strict";var r=n("5670"),i=n.n(r);i.a},e8d5:function(e,t,n){"use strict";var r=n("83e5"),i=n.n(r);i.a},eaae:function(e,t,n){"use strict";var r=n("f353"),i=n.n(r);i.a},f353:function(e,t,n){},fb98:function(e,t,n){}});
//# sourceMappingURL=app.7e908f2e.js.map